var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(p){var I=0;return function(){return I<p.length?{done:!1,value:p[I++]}:{done:!0}}};$jscomp.arrayIterator=function(p){return{next:$jscomp.arrayIteratorImpl(p)}};$jscomp.makeIterator=function(p){var I="undefined"!=typeof Symbol&&Symbol.iterator&&p[Symbol.iterator];return I?I.call(p):$jscomp.arrayIterator(p)};$jscomp.arrayFromIterator=function(p){for(var I,Y=[];!(I=p.next()).done;)Y.push(I.value);return Y};
$jscomp.arrayFromIterable=function(p){return p instanceof Array?p:$jscomp.arrayFromIterator($jscomp.makeIterator(p))};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(p){var I=function(){};I.prototype=p;return new I};
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(p,I,Y){if(p==Array.prototype||p==Object.prototype)return p;p[I]=Y.value;return p};$jscomp.getGlobal=function(p){p=["object"==typeof globalThis&&globalThis,p,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var I=0;I<p.length;++I){var Y=p[I];if(Y&&Y.Math==Math)return Y}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(p,I){var Y=$jscomp.propertyToPolyfillSymbol[I];if(null==Y)return p[I];Y=p[Y];return void 0!==Y?Y:p[I]};
$jscomp.polyfill=function(p,I,Y,oa){I&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(p,I,Y,oa):$jscomp.polyfillUnisolated(p,I,Y,oa))};$jscomp.polyfillUnisolated=function(p,I,Y,oa){Y=$jscomp.global;p=p.split(".");for(oa=0;oa<p.length-1;oa++){var U=p[oa];if(!(U in Y))return;Y=Y[U]}p=p[p.length-1];oa=Y[p];I=I(oa);I!=oa&&null!=I&&$jscomp.defineProperty(Y,p,{configurable:!0,writable:!0,value:I})};
$jscomp.polyfillIsolated=function(p,I,Y,oa){var U=p.split(".");p=1===U.length;oa=U[0];oa=!p&&oa in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var Aa=0;Aa<U.length-1;Aa++){var ea=U[Aa];if(!(ea in oa))return;oa=oa[ea]}U=U[U.length-1];Y=$jscomp.IS_SYMBOL_NATIVE&&"es6"===Y?oa[U]:null;I=I(Y);null!=I&&(p?$jscomp.defineProperty($jscomp.polyfills,U,{configurable:!0,writable:!0,value:I}):I!==Y&&($jscomp.propertyToPolyfillSymbol[U]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(U):$jscomp.POLYFILL_PREFIX+
U,U=$jscomp.propertyToPolyfillSymbol[U],$jscomp.defineProperty(oa,U,{configurable:!0,writable:!0,value:I})))};
$jscomp.getConstructImplementation=function(){function p(){function Y(){}new Y;Reflect.construct(Y,[],function(){});return new Y instanceof Y}if($jscomp.TRUST_ES6_POLYFILLS&&"undefined"!=typeof Reflect&&Reflect.construct){if(p())return Reflect.construct;var I=Reflect.construct;return function(Y,oa,U){Y=I(Y,oa);U&&Reflect.setPrototypeOf(Y,U.prototype);return Y}}return function(Y,oa,U){void 0===U&&(U=Y);U=$jscomp.objectCreate(U.prototype||Object.prototype);return Function.prototype.apply.call(Y,U,oa)||
U}};$jscomp.construct={valueOf:$jscomp.getConstructImplementation}.valueOf();$jscomp.underscoreProtoCanBeSet=function(){var p={a:!0},I={};try{return I.__proto__=p,I.a}catch(Y){}return!1};$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(p,I){p.__proto__=I;if(p.__proto__!==I)throw new TypeError(p+" is not extensible");return p}:null;
$jscomp.inherits=function(p,I){p.prototype=$jscomp.objectCreate(I.prototype);p.prototype.constructor=p;if($jscomp.setPrototypeOf){var Y=$jscomp.setPrototypeOf;Y(p,I)}else for(Y in I)if("prototype"!=Y)if(Object.defineProperties){var oa=Object.getOwnPropertyDescriptor(I,Y);oa&&Object.defineProperty(p,Y,oa)}else p[Y]=I[Y];p.superClass_=I.prototype};$jscomp.generator={};
$jscomp.generator.ensureIteratorResultIsObject_=function(p){if(!(p instanceof Object))throw new TypeError("Iterator result "+p+" is not an object");};$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};
$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(p){this.yieldResult=p};
$jscomp.generator.Context.prototype.throw_=function(p){this.abruptCompletion_={exception:p,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(p){this.abruptCompletion_={return:p};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(p){this.abruptCompletion_={jumpTo:p};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(p,I){this.nextAddress=I;return{value:p}};
$jscomp.generator.Context.prototype.yieldAll=function(p,I){p=$jscomp.makeIterator(p);var Y=p.next();$jscomp.generator.ensureIteratorResultIsObject_(Y);if(Y.done)this.yieldResult=Y.value,this.nextAddress=I;else return this.yieldAllIterator_=p,this.yield(Y.value,I)};$jscomp.generator.Context.prototype.jumpTo=function(p){this.nextAddress=p};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};
$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(p,I){this.catchAddress_=p;void 0!=I&&(this.finallyAddress_=I)};$jscomp.generator.Context.prototype.setFinallyBlock=function(p){this.catchAddress_=0;this.finallyAddress_=p||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(p,I){this.nextAddress=p;this.catchAddress_=I||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(p){this.catchAddress_=p||0;p=this.abruptCompletion_.exception;this.abruptCompletion_=null;return p};$jscomp.generator.Context.prototype.enterFinallyBlock=function(p,I,Y){Y?this.finallyContexts_[Y]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=p||0;this.finallyAddress_=I||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(p,I){I=this.finallyContexts_.splice(I||0)[0];if(I=this.abruptCompletion_=this.abruptCompletion_||I){if(I.isException)return this.jumpToErrorHandler_();void 0!=I.jumpTo&&this.finallyAddress_<I.jumpTo?(this.nextAddress=I.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=p};$jscomp.generator.Context.prototype.forIn=function(p){return new $jscomp.generator.Context.PropertyIterator(p)};
$jscomp.generator.Context.PropertyIterator=function(p){this.object_=p;this.properties_=[];for(var I in p)this.properties_.push(I);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var p=this.properties_.pop();if(p in this.object_)return p}return null};$jscomp.generator.Engine_=function(p){this.context_=new $jscomp.generator.Context;this.program_=p};
$jscomp.generator.Engine_.prototype.next_=function(p){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,p,this.context_.next_);this.context_.next_(p);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(p){this.context_.start_();var I=this.context_.yieldAllIterator_;if(I)return this.yieldAllStep_("return"in I?I["return"]:function(Y){return{value:Y,done:!0}},p,this.context_.return);this.context_.return(p);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(p){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],p,this.context_.next_);this.context_.throw_(p);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(p,I,Y){try{var oa=p.call(this.context_.yieldAllIterator_,I);$jscomp.generator.ensureIteratorResultIsObject_(oa);if(!oa.done)return this.context_.stop_(),oa;var U=oa.value}catch(Aa){return this.context_.yieldAllIterator_=null,this.context_.throw_(Aa),this.nextStep_()}this.context_.yieldAllIterator_=null;Y.call(this.context_,U);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var p=this.program_(this.context_);if(p)return this.context_.stop_(),{value:p.value,done:!1}}catch(I){this.context_.yieldResult=void 0,this.context_.throw_(I)}this.context_.stop_();if(this.context_.abruptCompletion_){p=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(p.isException)throw p.exception;return{value:p.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(p){this.next=function(I){return p.next_(I)};this.throw=function(I){return p.throw_(I)};this.return=function(I){return p.return_(I)};this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(p,I){I=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(I));$jscomp.setPrototypeOf&&p.prototype&&$jscomp.setPrototypeOf(I,p.prototype);return I};
$jscomp.asyncExecutePromiseGenerator=function(p){function I(oa){return p.next(oa)}function Y(oa){return p.throw(oa)}return new Promise(function(oa,U){function Aa(ea){ea.done?oa(ea.value):Promise.resolve(ea.value).then(I,Y).then(Aa,U)}Aa(p.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(p){return $jscomp.asyncExecutePromiseGenerator(p())};$jscomp.asyncExecutePromiseGeneratorProgram=function(p){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(p)))};
$jscomp.polyfill("Reflect",function(p){return p?p:{}},"es6","es3");$jscomp.polyfill("Reflect.construct",function(p){return $jscomp.construct},"es6","es3");$jscomp.polyfill("Reflect.setPrototypeOf",function(p){if(p)return p;if($jscomp.setPrototypeOf){var I=$jscomp.setPrototypeOf;return function(Y,oa){try{return I(Y,oa),!0}catch(U){return!1}}}return null},"es6","es5");$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(p){if(p)return p;var I=function(U,Aa){this.$jscomp$symbol$id_=U;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:Aa})};I.prototype.toString=function(){return this.$jscomp$symbol$id_};var Y=0,oa=function(U){if(this instanceof oa)throw new TypeError("Symbol is not a constructor");return new I("jscomp_symbol_"+(U||"")+"_"+Y++,U)};return oa},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(p){if(p)return p;p=Symbol("Symbol.iterator");for(var I="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),Y=0;Y<I.length;Y++){var oa=$jscomp.global[I[Y]];"function"===typeof oa&&"function"!=typeof oa.prototype[p]&&$jscomp.defineProperty(oa.prototype,p,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return p},"es6",
"es3");$jscomp.iteratorPrototype=function(p){p={next:p};p[Symbol.iterator]=function(){return this};return p};
$jscomp.polyfill("Promise",function(p){function I(){this.batch_=null}function Y(ea){return ea instanceof U?ea:new U(function(xa,ha){xa(ea)})}if(p&&(!($jscomp.FORCE_POLYFILL_PROMISE||$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION&&"undefined"===typeof $jscomp.global.PromiseRejectionEvent)||!$jscomp.global.Promise||-1===$jscomp.global.Promise.toString().indexOf("[native code]")))return p;I.prototype.asyncExecute=function(ea){if(null==this.batch_){this.batch_=[];var xa=this;this.asyncExecuteFunction(function(){xa.executeBatch_()})}this.batch_.push(ea)};
var oa=$jscomp.global.setTimeout;I.prototype.asyncExecuteFunction=function(ea){oa(ea,0)};I.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var ea=this.batch_;this.batch_=[];for(var xa=0;xa<ea.length;++xa){var ha=ea[xa];ea[xa]=null;try{ha()}catch(ma){this.asyncThrow_(ma)}}}this.batch_=null};I.prototype.asyncThrow_=function(ea){this.asyncExecuteFunction(function(){throw ea;})};var U=function(ea){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];this.isRejectionHandled_=
!1;var xa=this.createResolveAndReject_();try{ea(xa.resolve,xa.reject)}catch(ha){xa.reject(ha)}};U.prototype.createResolveAndReject_=function(){function ea(ma){return function(sa){ha||(ha=!0,ma.call(xa,sa))}}var xa=this,ha=!1;return{resolve:ea(this.resolveTo_),reject:ea(this.reject_)}};U.prototype.resolveTo_=function(ea){if(ea===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(ea instanceof U)this.settleSameAsPromise_(ea);else{a:switch(typeof ea){case "object":var xa=
null!=ea;break a;case "function":xa=!0;break a;default:xa=!1}xa?this.resolveToNonPromiseObj_(ea):this.fulfill_(ea)}};U.prototype.resolveToNonPromiseObj_=function(ea){var xa=void 0;try{xa=ea.then}catch(ha){this.reject_(ha);return}"function"==typeof xa?this.settleSameAsThenable_(xa,ea):this.fulfill_(ea)};U.prototype.reject_=function(ea){this.settle_(2,ea)};U.prototype.fulfill_=function(ea){this.settle_(1,ea)};U.prototype.settle_=function(ea,xa){if(0!=this.state_)throw Error("Cannot settle("+ea+", "+
xa+"): Promise already settled in state"+this.state_);this.state_=ea;this.result_=xa;2===this.state_&&this.scheduleUnhandledRejectionCheck_();this.executeOnSettledCallbacks_()};U.prototype.scheduleUnhandledRejectionCheck_=function(){var ea=this;oa(function(){if(ea.notifyUnhandledRejection_()){var xa=$jscomp.global.console;"undefined"!==typeof xa&&xa.error(ea.result_)}},1)};U.prototype.notifyUnhandledRejection_=function(){if(this.isRejectionHandled_)return!1;var ea=$jscomp.global.CustomEvent,xa=$jscomp.global.Event,
ha=$jscomp.global.dispatchEvent;if("undefined"===typeof ha)return!0;"function"===typeof ea?ea=new ea("unhandledrejection",{cancelable:!0}):"function"===typeof xa?ea=new xa("unhandledrejection",{cancelable:!0}):(ea=$jscomp.global.document.createEvent("CustomEvent"),ea.initCustomEvent("unhandledrejection",!1,!0,ea));ea.promise=this;ea.reason=this.result_;return ha(ea)};U.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var ea=0;ea<this.onSettledCallbacks_.length;++ea)Aa.asyncExecute(this.onSettledCallbacks_[ea]);
this.onSettledCallbacks_=null}};var Aa=new I;U.prototype.settleSameAsPromise_=function(ea){var xa=this.createResolveAndReject_();ea.callWhenSettled_(xa.resolve,xa.reject)};U.prototype.settleSameAsThenable_=function(ea,xa){var ha=this.createResolveAndReject_();try{ea.call(xa,ha.resolve,ha.reject)}catch(ma){ha.reject(ma)}};U.prototype.then=function(ea,xa){function ha(Ra,ya){return"function"==typeof Ra?function(wb){try{ma(Ra(wb))}catch(sb){sa(sb)}}:ya}var ma,sa,Fa=new U(function(Ra,ya){ma=Ra;sa=ya});
this.callWhenSettled_(ha(ea,ma),ha(xa,sa));return Fa};U.prototype.catch=function(ea){return this.then(void 0,ea)};U.prototype.callWhenSettled_=function(ea,xa){function ha(){switch(ma.state_){case 1:ea(ma.result_);break;case 2:xa(ma.result_);break;default:throw Error("Unexpected state: "+ma.state_);}}var ma=this;null==this.onSettledCallbacks_?Aa.asyncExecute(ha):this.onSettledCallbacks_.push(ha);this.isRejectionHandled_=!0};U.resolve=Y;U.reject=function(ea){return new U(function(xa,ha){ha(ea)})};U.race=
function(ea){return new U(function(xa,ha){for(var ma=$jscomp.makeIterator(ea),sa=ma.next();!sa.done;sa=ma.next())Y(sa.value).callWhenSettled_(xa,ha)})};U.all=function(ea){var xa=$jscomp.makeIterator(ea),ha=xa.next();return ha.done?Y([]):new U(function(ma,sa){function Fa(wb){return function(sb){Ra[wb]=sb;ya--;0==ya&&ma(Ra)}}var Ra=[],ya=0;do Ra.push(void 0),ya++,Y(ha.value).callWhenSettled_(Fa(Ra.length-1),sa),ha=xa.next();while(!ha.done)})};return U},"es6","es3");
$jscomp.checkStringArgs=function(p,I,Y){if(null==p)throw new TypeError("The 'this' value for String.prototype."+Y+" must not be null or undefined");if(I instanceof RegExp)throw new TypeError("First argument to String.prototype."+Y+" must not be a regular expression");return p+""};
$jscomp.polyfill("String.prototype.startsWith",function(p){return p?p:function(I,Y){var oa=$jscomp.checkStringArgs(this,I,"startsWith");I+="";var U=oa.length,Aa=I.length;Y=Math.max(0,Math.min(Y|0,oa.length));for(var ea=0;ea<Aa&&Y<U;)if(oa[Y++]!=I[ea++])return!1;return ea>=Aa}},"es6","es3");
$jscomp.iteratorFromArray=function(p,I){p instanceof String&&(p+="");var Y=0,oa=!1,U={next:function(){if(!oa&&Y<p.length){var Aa=Y++;return{value:I(Aa,p[Aa]),done:!1}}oa=!0;return{done:!0,value:void 0}}};U[Symbol.iterator]=function(){return U};return U};$jscomp.polyfill("Array.prototype.keys",function(p){return p?p:function(){return $jscomp.iteratorFromArray(this,function(I){return I})}},"es6","es3");
$jscomp.polyfill("Array.from",function(p){return p?p:function(I,Y,oa){Y=null!=Y?Y:function(xa){return xa};var U=[],Aa="undefined"!=typeof Symbol&&Symbol.iterator&&I[Symbol.iterator];if("function"==typeof Aa){I=Aa.call(I);for(var ea=0;!(Aa=I.next()).done;)U.push(Y.call(oa,Aa.value,ea++))}else for(Aa=I.length,ea=0;ea<Aa;ea++)U.push(Y.call(oa,I[ea],ea));return U}},"es6","es3");
$jscomp.checkEs6ConformanceViaProxy=function(){try{var p={},I=Object.create(new $jscomp.global.Proxy(p,{get:function(Y,oa,U){return Y==p&&"q"==oa&&U==I}}));return!0===I.q}catch(Y){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.owns=function(p,I){return Object.prototype.hasOwnProperty.call(p,I)};
$jscomp.polyfill("WeakMap",function(p){function I(){if(!p||!Object.seal)return!1;try{var ma=Object.seal({}),sa=Object.seal({}),Fa=new p([[ma,2],[sa,3]]);if(2!=Fa.get(ma)||3!=Fa.get(sa))return!1;Fa.delete(ma);Fa.set(sa,4);return!Fa.has(ma)&&4==Fa.get(sa)}catch(Ra){return!1}}function Y(){}function oa(ma){var sa=typeof ma;return"object"===sa&&null!==ma||"function"===sa}function U(ma){if(!$jscomp.owns(ma,ea)){var sa=new Y;$jscomp.defineProperty(ma,ea,{value:sa})}}function Aa(ma){if(!$jscomp.ISOLATE_POLYFILLS){var sa=
Object[ma];sa&&(Object[ma]=function(Fa){if(Fa instanceof Y)return Fa;Object.isExtensible(Fa)&&U(Fa);return sa(Fa)})}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(p&&$jscomp.ES6_CONFORMANCE)return p}else if(I())return p;var ea="$jscomp_hidden_"+Math.random();Aa("freeze");Aa("preventExtensions");Aa("seal");var xa=0,ha=function(ma){this.id_=(xa+=Math.random()+1).toString();if(ma){ma=$jscomp.makeIterator(ma);for(var sa;!(sa=ma.next()).done;)sa=sa.value,this.set(sa[0],sa[1])}};ha.prototype.set=
function(ma,sa){if(!oa(ma))throw Error("Invalid WeakMap key");U(ma);if(!$jscomp.owns(ma,ea))throw Error("WeakMap key fail: "+ma);ma[ea][this.id_]=sa;return this};ha.prototype.get=function(ma){return oa(ma)&&$jscomp.owns(ma,ea)?ma[ea][this.id_]:void 0};ha.prototype.has=function(ma){return oa(ma)&&$jscomp.owns(ma,ea)&&$jscomp.owns(ma[ea],this.id_)};ha.prototype.delete=function(ma){return oa(ma)&&$jscomp.owns(ma,ea)&&$jscomp.owns(ma[ea],this.id_)?delete ma[ea][this.id_]:!1};return ha},"es6","es3");
$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(p){function I(){if($jscomp.ASSUME_NO_NATIVE_MAP||!p||"function"!=typeof p||!p.prototype.entries||"function"!=typeof Object.seal)return!1;try{var ha=Object.seal({x:4}),ma=new p($jscomp.makeIterator([[ha,"s"]]));if("s"!=ma.get(ha)||1!=ma.size||ma.get({x:4})||ma.set({x:4},"t")!=ma||2!=ma.size)return!1;var sa=ma.entries(),Fa=sa.next();if(Fa.done||Fa.value[0]!=ha||"s"!=Fa.value[1])return!1;Fa=sa.next();return Fa.done||4!=Fa.value[0].x||"t"!=Fa.value[1]||!sa.next().done?
!1:!0}catch(Ra){return!1}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(p&&$jscomp.ES6_CONFORMANCE)return p}else if(I())return p;var Y=new WeakMap,oa=function(ha){this.data_={};this.head_=ea();this.size=0;if(ha){ha=$jscomp.makeIterator(ha);for(var ma;!(ma=ha.next()).done;)ma=ma.value,this.set(ma[0],ma[1])}};oa.prototype.set=function(ha,ma){ha=0===ha?0:ha;var sa=U(this,ha);sa.list||(sa.list=this.data_[sa.id]=[]);sa.entry?sa.entry.value=ma:(sa.entry={next:this.head_,previous:this.head_.previous,
head:this.head_,key:ha,value:ma},sa.list.push(sa.entry),this.head_.previous.next=sa.entry,this.head_.previous=sa.entry,this.size++);return this};oa.prototype.delete=function(ha){ha=U(this,ha);return ha.entry&&ha.list?(ha.list.splice(ha.index,1),ha.list.length||delete this.data_[ha.id],ha.entry.previous.next=ha.entry.next,ha.entry.next.previous=ha.entry.previous,ha.entry.head=null,this.size--,!0):!1};oa.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=ea();this.size=0};oa.prototype.has=
function(ha){return!!U(this,ha).entry};oa.prototype.get=function(ha){return(ha=U(this,ha).entry)&&ha.value};oa.prototype.entries=function(){return Aa(this,function(ha){return[ha.key,ha.value]})};oa.prototype.keys=function(){return Aa(this,function(ha){return ha.key})};oa.prototype.values=function(){return Aa(this,function(ha){return ha.value})};oa.prototype.forEach=function(ha,ma){for(var sa=this.entries(),Fa;!(Fa=sa.next()).done;)Fa=Fa.value,ha.call(ma,Fa[1],Fa[0],this)};oa.prototype[Symbol.iterator]=
oa.prototype.entries;var U=function(ha,ma){var sa=ma&&typeof ma;"object"==sa||"function"==sa?Y.has(ma)?sa=Y.get(ma):(sa=""+ ++xa,Y.set(ma,sa)):sa="p_"+ma;var Fa=ha.data_[sa];if(Fa&&$jscomp.owns(ha.data_,sa))for(ha=0;ha<Fa.length;ha++){var Ra=Fa[ha];if(ma!==ma&&Ra.key!==Ra.key||ma===Ra.key)return{id:sa,list:Fa,index:ha,entry:Ra}}return{id:sa,list:Fa,index:-1,entry:void 0}},Aa=function(ha,ma){var sa=ha.head_;return $jscomp.iteratorPrototype(function(){if(sa){for(;sa.head!=ha.head_;)sa=sa.previous;for(;sa.next!=
sa.head;)return sa=sa.next,{done:!1,value:ma(sa)};sa=null}return{done:!0,value:void 0}})},ea=function(){var ha={};return ha.previous=ha.next=ha.head=ha},xa=0;return oa},"es6","es3");$jscomp.findInternal=function(p,I,Y){p instanceof String&&(p=String(p));for(var oa=p.length,U=0;U<oa;U++){var Aa=p[U];if(I.call(Y,Aa,U,p))return{i:U,v:Aa}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.findIndex",function(p){return p?p:function(I,Y){return $jscomp.findInternal(this,I,Y).i}},"es6","es3");
var svManager={getInstance:function(){var p=window.$rdp;return p&&p.running&&p.running()?p:null}};svGlobal.getInstance=svManager.getInstance;
function connvertServer(p){var I={};I.id=p.id;I.server=p.id;I.displayName=p.displayName||p.id;if(p=p.rdp){for(var Y in p)I[Y]=p[Y];I.user=p.username||"";I.pwd=p.password||"";I.useConsole=p.console||!1;I.legacyMode=p.leagacyMode||p.legacyMode||!1;I.server_bpp=p.color||16;I.exe=p.remoteProgram||"";I.args=p.remoteArgs||"";I.startProgram=0<I.exe.length?"app":I.command&&0<I.command.length?"shell":"noapp"}return I}
function Rdp2(p){p=svGlobal.util.getServerArgs(p);if(!p||!p.gateway)return hi5.notifications.notify({msg:__svi18n.noauth}),null;var I=p.gateway||"",Y=0,oa=0,U=16,Aa=1==p.useSSL||"true"==p.useSSL||"on"==p.useSSL||null;p.width&&(Y=parseInt(p.width,10));p.height&&(oa=parseInt(p.height,10));p.color&&(U=parseInt(p.color,10));p.server_bpp&&(U=parseInt(p.server_bpp,10));p=hi5.browser.obj2url(p);null===Aa&&(Aa="https:"==location.protocol);return new Rdp((Aa?"wss://":"ws://")+I+"/RDP?"+p,Y,oa,U)}
svGlobal.Rdp2||(svGlobal.Rdp2=Rdp2);
function Rdp(p,I,Y,oa){function U(a){return"on"==a||"true"==a||1==a}function Aa(){var a=m.gateway;m.ongetgatewayaddress&&(a=m.ongetgatewayaddress(a));return a}function ea(){var a=hi5.storage.get("SV_CONN_SHARE_ID");a||(a=hi5.tool.uuid(),hi5.storage.set("SV_CONN_SHARE_ID",a));return a}function xa(a,b){a=ja[a]||b;a.startsWith("/")||a.toLowerCase().startsWith("http")||(a=hi5.libPath+a);return a}function ha(){return J.displayName||J.server||J.symlink||J.id||"undefined"}function ma(a){m.loadbalanceToken||
(m.loadbalanceToken=ja.loadbalanceTokenName?ja.loadbalanceTokenName+"="+a:"")}function sa(a,b,d){m.ontitlechange&&(a=m.ontitlechange(a,d));m.setTitle&&a&&(b=b||window,b.document.title=a)}function Fa(a,b){switch(a){case 16:case 8:case 24:case 32:break;case 15:return J.invitation||m.showMessage("15 bit color is not supported anymore."),!1;default:return!1}jb=a;b&&(Oa?Oa.postMessage({type:0,cmd:1,data:a}):Ga&&Ga.setColor(a));return!0}function Ra(a,b,d,g){Ma=a;Na=b;bc=cc=0;dc=Ma-1;ec=Na-1;Za&&(Ma=(J.waWidth||
hi5.browser.getScreenWidth())|0,Na=(J.waHeight||hi5.browser.getScreenHeight())|0);J.minWidth&&Ma<J.minWidth&&(Ma=J.minWidth|0);J.minHeight&&Na<J.minHeight&&(Na=J.minHeight|0);Ma&=-4;Na&=-4;svGlobal.logger.warn("resolution changed, w:"+Ma+" h:"+Na);var c=Ma,e=Na;va?va.resize(c,e):va=new Ec(c,e);ia.setSize(Ma,Na,Za?"hidden":null);if(d||Ma!=a||Na!=b)Oa?Oa.postMessage({type:0,cmd:2,data:{w:Ma,h:Na}}):Ga&&Ga.setResolution(Ma,Na);if(m.onresolutionchange&&!g)m.onresolutionchange(a,b)}function ya(a){!gb&&
La&&(Oa?(fc.data=a,"string"!=typeof a?Oa.postMessage(fc,[a]):Oa.postMessage(fc)):Ga.writeRawInput(a))}function wb(a){switch(a){case "\r":break;case "\n":m.writeScancode(28);break;case "\t":m.writeScancode(15);break;default:ya("86"+a)}}function sb(a){var b=this;a||(a=143);this.send=function(d){var g=!!d.buffer,c=g?d:d.getData(),e=64==a;d=g?c.length:d.getEnd()||c.length;d<c.length&&(c=g?c.subarray(0,d):c.slice(0,d));g=e?5:9;d=new Uint8Array(g+d);d[0]=a;if(e)d[1]=b.id,d[2]=b.id>>8,d[3]=b.id>>16,d[4]=
b.id>>24;else{e=b.name;for(var f=Math.min(e.length,8),y=0;y<f;y++)d[1+y]=e.charCodeAt(y)}d.set(c,g);ya(d.buffer)};this.name="";this.count=this.id=this.flags=0}function Ib(a){if(m){var b=__svi18n.errorCode[a]||"Error: "+a;a={name:a,message:b,msg:b};m.displayMsg&&m.showMessage(a);0<svGlobal.log&&console.error&&console.error(a);if(m.onerror)m.onerror(a)}}function Fc(a){if(m){var b=__svi18n.info[a];b||(b="info "+a);m.displayMsg&&m.showMessage(b);svGlobal.logger.info(b)}}function gc(){var a=La;tb=La=!1;
Oa?Oa.postMessage({type:0,cmd:3}):Ga&&Ga.resetStatus();a&&(La=a)}function hc(a){Pa||(Pa=new hi5.file.UploadManager(new hi5.file.WsFileService(ya)),Pa.addEvent("beforeupload",function(b,d,g){if(m.beforeupload)return m.beforeupload(b,d,g)}),Pa.addEvent("fileuploaded",function(b,d,g){if(m.onfileuploaded)m.onfileuploaded(b,d,g)}),Pa.addEvent("uploaded",function(b,d){if(m.onuploaded)m.onuploaded(b,d)}),Pa.addEvent("uploadingCancelled",function(){if(m.onuploadingCancelled)m.onuploadingCancelled()}));a.setFileHandler(Pa)}
function Gc(a,b,d){var g=!1;this.exe=a;this.args=b||"";this._dir=d||"";var c=this;this.close=function(){!g&&La&&(g=!0,ya("8C5"+c.exe+"\t"+c.args+"\t"+m.sessionInfo.appInfo.session))}}function Cd(){var a=window.opener;if(a)try{if(a.__sparkUser&&a.__sparkUser.session)return a.__sparkUser;if(a.opener&&a.opener.__sparkUser.session)return a.opener.__sparkUser}catch(b){}return null}function Hc(){var a;return void 0!==(null==(a=window)?void 0:a.PublicKeyCredential)&&"function"===typeof window.PublicKeyCredential}
function Jb(a){a=(new Uint8Array(a)).buffer;return CBOR.decode(a)}function Dd(a,b,d){var g={};if(b&&b.attachment)switch(b.attachment){case 1:var c="platform";break;case 2:c="cross-platform"}c&&(g.authenticatorAttachment=c);c={};b&&(b.requireResident?b.requireResident&&(c.requireResidentKey=!0,c.residentKey="required"):b.preferResident&&b.preferResident&&(c.requireResidentKey=!0,c.residentKey="preferred"));d&&d.rk&&(d.rk?(c.requireResidentKey=!0,c.residentKey="required"):(c.requireResidentKey=!1,c.residentKey=
void 0));c&&(c.requireResidentKey&&(g.requireResidentKey=c.requireResidentKey),c.residentKey&&(g.residentKey=c.residentKey));if(a=Ic(a,b,d))g.userVerification=a;if(Object.keys(g).length)return g}function Jc(a){var b=[];if(a){a=$jscomp.makeIterator(a);for(var d=a.next();!d.done;d=a.next()){var g=d.value;d={};g.id&&(d.id=g.id);g.type&&(d.type=g.type);if(g.transports){var c=d;g=g.transports;var e=[];g&1?e.push("usb"):g&2?e.push("nfc"):g&4?e.push("ble"):g&16?e.push("internal"):g&32&&e.push("hybrid");
c.transports=e}b.push(d)}}return b}function Ic(a,b,d){var g;a&&(a&4194304?g="required":a&8388608?g="preferred":a&16777216&&(g="discouraged"));if(b&&b.userVerification)switch(b.userVerification){case 1:g="required";break;case 2:g="preferred";break;case 3:g="discouraged"}d&&d.uv&&("FALSE"==d.uv.toUpperCase()?g="discouraged":"TRUE"==d.uv.toUpperCase()&&(g="required"));return g}function Ed(a){var b={};if(a&&a.attestationPreference)switch(a.attestationPreference){case 0:b.attestation="direct";break;case 1:b.attestation=
"direct";break;case 2:b.attestation="indirect";break;case 3:b.attestation="direct"}if(a&&a.enterpriseAttestation)switch(a.enterpriseAttestation){case 1:b.attestation="enterprise";break;case 2:b.attestation="enterprise"}b.attestationFormats=["packed"];return b}function Fd(a,b){var d,g,c,e,f,y,w,t,K,B,A,E,x,O,v,ba,P,L,N;return $jscomp.asyncExecutePromiseGeneratorProgram(function(na){if(1==na.nextAddress){a.getPublicKeyAlgorithm();if((d=a.getTransports())&&0<d.length)for(var ta=$jscomp.makeIterator(d),
T=ta.next();!T.done;T=ta.next())T=T.value,"USB"==T.toUpperCase()||"NFC"==T.toUpperCase()||"BLE"==T.toUpperCase()||"INTERNAL"==T.toUpperCase()||T.toUpperCase();if(g=a.attestationObject)e=Jb(g),c=e.attStmt;if(f=a.clientDataJSON)y=window.origin,w=(new TextDecoder).decode(f),t=JSON.parse(w),t.origin&&(t.origin=y);K=a.getAuthenticatorData();if(!K)return na.jumpTo(0);B=new Uint8Array(K);return b?(A=b.id)?na.yield(Gd(A),5):na.jumpTo(0):na.jumpTo(0)}E=na.yieldResult;x=new Uint8Array(E);O=new hi5.DataBuffer(new Uint8Array(B.byteLength));
O.setBytes(x);v=B.slice?B.slice(32,B.length):B.subarray(32,B.length);O.setBytes(v);O.markEnd();ba=O.getData();P={1:"packed",2:ba,3:c};L=CBOR.encode(P);N=new hi5.DataBuffer(new Uint8Array(L.byteLength+1));N.setByte(0);N.setBytes(L);N.markEnd();return na.return(N.getData())})}function Gd(a){var b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){b=(new TextEncoder).encode(a);return d.return(Hd(b))})}function Hd(a){var b;return $jscomp.asyncExecutePromiseGeneratorProgram(function(d){if(1==
d.nextAddress)return d.yield(crypto.subtle.digest("SHA-256",a),2);b=d.yieldResult;return d.return(b)})}function Id(a){return Array.from(a,function(b){return("0"+(b&255).toString(16)).slice(-2)}).join(", ")}function Jd(a,b,d,g,c){ic.set(a,b);jc.set(a,g);b="<b>User:&nbsp;</b>"+d+"&nbsp;("+g+")&nbsp;&nbsp;&nbsp;&nbsp;<b>Expire Date:</b> "+c;d=document.createElement("div");g=document.createElement("input");g.type="radio";g.name="scard_name";g.value=a;0==a&&(g.defaultChecked=!0);d.appendChild(g);d.innerHTML+=
b;d.innerHTML+="<br>";return d}function Kd(a,b){var d=document.createElement("div"),g=document.createElement("input");g.type="radio";g.name="ds_name";g.value=a;0==a&&(g.defaultChecked=!0);d.appendChild(g);d.innerHTML+=b;d.innerHTML+="<br>";return d}function Kc(){var a="";J&&U(J.connectif)&&J.symlink&&"sessionStorage"in window&&(a="SV_"+J.symlink,J.domain&&(a+=J.domain),J.user&&(a+=J.user));return a}function Ld(){var a=window.localStorage.getItem(void 0)||"";a&&(a="&certHash="+a);var b=hi5.appcfg.persistentId?
window.localStorage:window.sessionStorage;if(!b)return a;var d=b.getItem("appInfo.session");if(!d)return a;a+="&_session="+d;(b=b.getItem("appInfo.numericId"))&&(a+="&_numericId="+b);return a}function Kb(){if(!La){tb=!1;var a="";gb?Ka.init(!1,!0,!1,1,!1,!1):a=m.getRuntimeURL();void 0==ja.wsPost&&(ja.wsPost=!1);m.oncreatewebsocket&&(Oa=null);Oa?(gb&&(gb.onopen=kc,gb.onclose=Bb,gb.onmessage=function(d){lc.data=d.data;Oa.postMessage(lc,[lc.data])}),Oa.postMessage({type:0,cmd:0,data:{addr:a,width:Ma,
height:Na,server_bpp:jb,libPath:hi5.libPath,libMin:hi5.libMin,wsPost:ja.wsPost}})):(Ga=new RdpGeneral(gb||a,Ma,Na,jb,va,!1,ja.wsPost),Ga.oncreatewebsocket=m.oncreatewebsocket,Ga.run());Oa?Oa.addEventListener("message",Lc,!1):(Ga.onopen=kc,Ga.onmessage=Mc,Ga.onclose=Bb,Ga.onerror=Ib,Ga.oninfo=Fc,Ga.onloggedin=mc,Ga.onresolutionchange=function(d,g){Ra(d,g,!1,J.monitorDef&&0<=J.monitor?!0:!1)},Ga.onAltSecWindows=Nc,Ga.onMoveCursor=nc,Ga.onCloseSurface=Oc,Ga.onColorChange=Fa,Ga.onHistoryReceived=function(){oc()},
Ga.onLockKeyState=function(d){if(m.onLockKeyState)m.onLockKeyState(d)});if(a=ia.getSurface(ia.size()-1))Za?a&&(a.remoteApp=new Gc(J.exe,J.args,"")):sa(ha(),a.getWindow());if(J.invitation&&!U(J.shadow)){var b=null;a&&(b=a.initChat(J.expert));Cb=new m.GatewayChannel;Cb.name="C_H_A_T";Cb.process=function(d){d=d.getUnicodeString(d.getEnd()-d.getPosition(),!0);b&&b.add(d,J.novice)};b&&(b.onchat=function(d){if(La){var g=Array(2*d.length);g=new hi5.DataBuffer(g,0,g.length);g.setUnicodeString(d);g.markEnd();
Cb.send(g)}});m.addGatewayChannel(Cb)}}}function Lc(a){a=a.data;switch(a.type){case 1:switch(a.event){case 0:kc();break;case 1:Bb(a.expected);break;case 2:Ib(a.code);break;case 3:Fc(a.code);break;case 4:mc();break;case 5:Ra(a.w,a.h,!1,J.monitorDef&&0<=J.monitor?!0:!1);break;case 6:nc(a.x,a.y,!0);break;case 7:Oc();break;case 8:0==a.id&&oc();Sa&&Sa.check(1<a.id?15555:0);break;case 9:Fa(a.color);break;case 10:if(m.onLockKeyState)m.onLockKeyState(a.state);break;default:svGlobal.logger.warn("Invalid worker event "+
a.type)}break;case 2:va.setRGBs(a.x,a.y,a.w,a.h,a.pixel,a.offset,a.scansize);break;case 3:va.moveArea(a.srcx,a.srcy,a.cx,a.cy,a.dx,a.dy);break;case 5:va.fillRect(a.l,a.t,a.w,a.h,a.color);break;case 6:va.drawLine(a.x1,a.y1,a.x2,a.y2,a.color);break;case 7:va.bitBlt(a.opcode,a.dstwidth,a.x,a.y,a.cx,a.cy,a.src,a.srcwidth,a.srcx,a.srcy);break;case 8:va.drawLineExt(a.x1,a.y1,a.x2,a.y2,a.color,a.opcode);break;case 9:Pc(a);break;case 10:Mc(a);break;case 11:Ya.attach(a.data,0,a.data.length);Nc(Ya,a.size);
break;case 12:va.drawText(a.font,a.flags,a.mixmode,a.foregroundColor,a.backgroundColor,a.clipLeft,a.clipTop,a.clipcx,a.clipcy,a.boxLeft,a.boxTop,a.boxcx,a.boxcy,a.x,a.y,a.length,a.text,a._left,a._top,a._right,a._bottom);break;case 13:va.drawBitmap(a.cacheID,a.cacheIDX,a.x,a.y,a.cx,a.cy,a.srcx,a.srcy,a.opcode);break;case 14:va.saveDesktop(a.x,a.y,a.cx,a.cy,a.offset);break;case 15:va.restoreDesktop(a.x,a.y,a.cx,a.cy,a.offset);break;case 16:va.putFont(a.font,a.character,a.glyph);break;case 17:va.putCursor(a.idx,
a.cursor);break;case 18:va.setCursor(a.idx);break;case 19:va.getHistory(a.cmd,ya,function(b){Oa.postMessage({type:0,cmd:7})});Sa&&Sa.check(15555);break;case 20:Ya.attach(a.data,a.off,a.data.length-a.off);va.setHistory(a.order,Ya);break;case 21:va.putBitmap(a.id,a.idx,a.bitmap);break;default:svGlobal.logger.warn("Invalid worker msg "+a.type)}}function Qc(a){Sa&&Sa.check(a)}function kc(){La=!0;var a="87"+navigator.userAgent+"\t";Lb=hi5.tool.uuid();document.cookie=Lb+"=sv";ya(a+Lb);if(m.onopen)m.onopen();
ja.joinCloseMode&&m.setJoinCloseMode(ja.joinCloseMode)}function Oc(){ia&&ia.close()}function Mc(a){var b=a.data;if("string"!=typeof b){a=new Uint8Array(b);Ya.attach(a,0,b.byteLength);var d=Ya.getLittleEndian16();switch(d){case 28:a=Ya;b=a.getAscllString(8);d=mb[b];null!=d?d.process(a):svGlobal.logger.warn("Channel "+b+" not found");break;case 55:a=Ya;switch(a.getByte()){case 0:Ea.tag=a.getLittleEndian16();Ea.channels=a.getLittleEndian16();Ea.samplePerSec=a.getLittleEndian32();a.skipPosition(6);Ea.bitsPerSample=
a.getLittleEndian16();svGlobal.logger.info("Audio Format, tag="+Ea.tag+" channels="+Ea.channels+" bitsPerSample="+Ea.bitsPerSample+" samplePerSec="+Ea.samplePerSec);Oa&&Oa.postMessage({type:0,cmd:5,data:{tag:Ea.tag,channels:Ea.channels,samplePerSec:Ea.samplePerSec,bitsPerSample:Ea.bitsPerSample}});41222==Ea.tag&&(Ea.sampleRate=Ea.samplePerSec,Va.initMediaPlayer(Va,Ea,!1));break;case 1:b=a.getByte(),d=a.getLittleEndian16(),a.skipPosition(8),pc(a,b,d,0),nb||ya("8A"+b+","+d)}Sa&&Sa.check();break;case 56:Rc(Ya.getUnicodeString(Ya.getEnd()-
Ya.getPosition(),!1));break;case 60:Sc(Ya);break;case 62:Tc(Ya.getUnicodeString(Ya.getEnd()-Ya.getPosition(),!1));break;case 63:Uc(Ya);Sa&&Sa.check();break;case 64:b=Ya;d=b.getByte();a=b.getLittleEndian32();switch(d){case 1:b=b.getAscllString();if(Ka[b]){if(svGlobal.logger.info("DVC create, name:"+b+" id:"+a),Ka[b].newInstance?(Ka[a]=Ka[b].newInstance(),Ka[a].id=a):(Ka[b].id=a,Ka[a]=Ka[b]),Ka[a].onopen)Ka[a].onopen()}else svGlobal.logger.info("DVC create, name not found:"+b+" id:"+a);break;case 3:Ka[a]&&
Ka[a].process(b);break;case 4:if(Ka[a]&&Ka[a].onclose)Ka[a].onclose();svGlobal.logger.info("close DVC, id:"+a)}Sa&&Sa.check();break;case 146:Md(Ya);break;default:if(m.onunknownmessage)m.onunknownmessage(d,Ya);else svGlobal.logger.warn("@TODO:"+d+"\n")}}else switch(d=parseInt(b.substring(0,2),16),a=b.substring(2),d){case 0:ya("87"+navigator.userAgent);break;case 15:if(m){Mb=!1;xb=m.reconnectTimes;(m&&0==m.mode||U(J.connectif))&&oc();b="";for(b in ob)if((d=ob[b])&&d.onopen)d.onopen();for(b in mb)if((d=
mb[b])&&d.onopen)d.onopen();a&&(a=JSON.parse(a),a.capability&&m&&(m.sessionInfo.suppressOutput=!!a.capability.suppressOutput))}break;case 26:b=JSON.parse(a);if(b.name){isNaN(b.name)||(b.name="S"+b.name);b.message||(b.message=b.msg);if(m.onnotify)m.onnotify(b);svGlobal.logger.info("msg="+a);if(2==b.type&&m.onerror)m.onerror(b);if(a=__svi18n.errorCode[b.name])b.msg=a+" "+b.msg;m.showMessage(b)}else 0<svGlobal.log&&console.erro("No error code for message:"+a);break;case 27:ia.drawLicense(a);break;case 50:if(La)switch(b=
parseInt(a.substring(0,1),10),a=a.substring(1),b){case 1:Nd(a);break;case 2:Db?(Db.type==a?m.writeRawInput("881"+a+"\t"+Db.text):m.writeRawInput("881ERROR\t"),Db=null):!(b=ia.getFocused())||b.processClipReq(a)||!ja.clipWarnAlways&&Vc||!J||J.leagacyMode||(m.showMessage(__svi18n.info.menucopy,null,5E3),Vc=!0);break;case 5:(b=ia.getFocused())&&"0"!=a&&b.setIgnorePaste(!0)}break;case 51:ia.setReadOnly("1"==a);break;case 54:b=a.split("\t");a=Aa()+b[0];a=m.modifyURL(a);svGlobal.logger.info("Downloading file:"+
a+" name:"+b[1]+" driver:"+b[2]);m.onprintingready&&m.onprintingready({link:a,printerName:b[1],pinterDriver:b[2]})||(b=ia.getFocused())&&b.showPDF(a);break;case 56:Rc(a);break;case 57:b=a.split("\t");svGlobal.logger.debug(a);if(a=ia.getWinById(parseInt(b[0]))){if(!ia.hasApp(b[1])){(d=ia.getOwnerSurface(a))&&d.railWin&&(d.railWin.appId=b[1],d.railWin.addApp(b[1]));if(m.onremoteappstart)m.onremoteappstart({id:b[1]});if(a.isVisible()&&a.titleInfo&&m.ontitlechange)m.ontitlechange(d.railWin.getFullTitle(a.id),
b[1])}a.appId=b[1]}break;case 58:Od(a);break;case 59:a=hi5.Base64.dec(a,0);hb=(new RdpBuffer(a,0,a.length)).getLittleEndian32();nb||!(hb&16||hb&65536)?(Nb=!1,Pa=null):(hb&16&&(Nb=!0),Pa||(a=ia.getFocused())&&hc(a));hb&64&&m.showMessage(__svi18n.info.recording);Pa&&(Pa.setUpload(!(hb&128)),Pa.setDownload(!(hb&131072)),Pa.canCopyFile=0!=(hb&65536));ia.execute("setFeature",[hb]);break;case 60:Sc(b64ToBuffer(a));break;case 61:a=JSON.parse(a);switch(a.type){case 0:Ra(a.width,a.height,!0,!1);Fa(a.color);
(b=a.server)&&m&&(m.server=a.server);Wc=a.length;d=ia.getFocused();Za=1==a.isRail;d&&(1!=m.mode&&d.setAutoScale(!Za),b&&sa(ha(),d.getWindow()),b=a.keyboard,"undefined"!=typeof b&&0==b&&d.setUnicode(!0),b=a.mapDisk)&&(Nb=!0,hc(d));if(m.onopened)m.onopened(a);break;case 1:a=a.duration;if(m.onprogress)m.onprogress(a,Wc);break;case 2:2==a.status?(gc(),La=!0):(b=0==a.status,b==va.isPaused()||m.onsessionpause&&m.onsessionpause(b,a)||(va&&va.pause(b,void 0),b||ia.repaint(0,0,va.width-1,va.height-1),a.warn&&
m.showMessage(b?__svi18n.info.sessionPaused:__svi18n.info.sessionResumed)))}break;case 62:Tc(a);break;case 63:Uc(b64ToBuffer(a));break;default:if(m.onunknownmessage)m.onunknownmessage(d,a);else svGlobal.logger.warn("@TODO:"+b+"\n")}}function oc(){if(!nb&&!$a&&($a=!0,m&&(ja.pingInterval&&m.startPing(ja.pingInterval),m.onready)))m.onready()}function Md(a){var b=a.getByte();switch(b){case 0:a=new Uint8Array(2);a[0]=146;a[1]=1;ya(a.buffer);break;case 1:break;case 5:b=a.getByte();a=a.getLittleEndian32();
0!=b||a&4||(hb^=65536,ia.execute("setFeature",[hb]));break;case 6:Ta.remoteLockFlags=a.getLittleEndian32();Ta.checkLockFlags=!0;if(m.onLockKeyState)m.onLockKeyState({capsLock:0!=(Ta.remoteLockFlags&4),numLock:0!=(Ta.remoteLockFlags&2),scrollLock:0!=(Ta.remoteLockFlags&1)},{capsLock:0!=(Ta.localLockFlags&4),numLock:0!=(Ta.localLockFlags&2),scrollLock:0!=(Ta.localLockFlags&1)});svGlobal.logger.info("remoteLockFlags: "+Ta.remoteLockFlags);break;case 7:b=a.getByte();m.sessionInfo.appInfo.twoFAEnabled=
0<b;switch(b){case 0:b=a.getByte();var d=a.getLittleEndian32();a=a.getBytes(d);m.sessionInfo.appInfo.twoFAQR=a;m.ontwofaqr&&m.ontwofaqr(a)||2==b&&ia.execute("showTwoFAQR");break;case 1:va&&va.pause(!0,!0);if(m.ontwofacode&&m.ontwofacode())return;(a=ia.getFocused())&&a.showTwoFACode();break;case 2:if(b=a.getByte(),a=1==a.getByte(),(!m.ontwofaresult||!m.ontwofaresult(b,a))&&Ta.onauthcoderesult)Ta.onauthcoderesult(b,a)}break;case 8:b=a.getByte();if(a=ia.getFocused()){d="image/png";switch(b){case 1:d=
"image/jpeg";break;case 2:d="image/webp"}a.getSnapshot(function(g){g.bytes().then(function(c){var e=new Uint8Array(2+c.length);e[0]=146;e[1]=8;e.set(c,2);ya(e.buffer)})},d)}break;default:svGlobal.logger.warn("Invalid Client Control: "+b)}}function Pd(a,b){var d=0,g=!1;this.width=a;this.interval=b;var c=0;this.start=function(){g||(g=!0,d=setInterval(function(){var e=ia.getFocused();e&&La&&(e=e.getThumbnail(a))&&e.length!=c&&(ya("8E7"+e),c=e.length)},b))};this.stop=function(){clearInterval(d)}}function Qd(a,
b){!cb||cb.width==a&&cb.interval==b||(cb.stop(),cb=null);cb||(cb=new Pd(a,b));cb.start()}function Uc(a){var b=a.getAscllString(8);(b=ob[b])&&b.process&&b.process(a)}function Tc(a){var b=parseInt(a.substring(0,1),16),d=a.substring(1);a=!1;var g=m.sessionInfo.appInfo;switch(b){case 0:var c=JSON.parse(d);gc();La=!0;a=c.width;g=c.height;if(a==Ma&&g==Na)break;Ra(a,g,!1,!1);break;case 1:c=JSON.parse(d);m.sessionInfo.joinedSessions.push(c.numericId);m.sessionInfo.joiners.push(c);g.sessions[c.numericId]=
c.name||c.__ip;if(!g.joined||ja.alertJoin)m.onsessionjoin&&(a=m.onsessionjoin(c)),!a&&__svi18n.info.joinsession&&m.showMessage(__svi18n.info.joinsession.applyArgs([c.numericId,c.__ip,c.name]));break;case 2:c=JSON.parse(d);m.sessionInfo.joinedSessions.removeElm(c.numericId);delete g.sessions[c.numericId];b=m.sessionInfo.joiners;d=0;for(var e=b.length;d<e;d++)if(b[d].numericId==c.numericId){b.splice(d,1);break}if(!g.joined||ja.alertJoin)m.onsessionexit&&(a=m.onsessionexit(c)),!a&&__svi18n.info.exitsession&&
m.showMessage(__svi18n.info.exitsession.applyArgs([c.numericId,c.__ip,c.name]));break;case 3:c=JSON.parse(d);g.joinMode!=c.mode&&(g.joinMode=c.mode,b=hi5.$("joinSelect"))&&(b.value=c.mode);if(g.hasControl)break;g.hasControl=!0;ia.setReadOnly(!1,2==c.mode);if(g=hi5.$("requestControl"))g.disabled=!0;m.ongivecontrol&&(a=m.ongivecontrol());if(a)break;m.showMessage(__svi18n.info.givecontrol,null,5E3);break;case 4:c=JSON.parse(d);ia.setReadOnly(!0,2==c.mode);g.hasControl=!1;if(g=hi5.$("requestControl"))g.disabled=
!1;m.ontakebackcontrol&&(a=m.ontakebackcontrol());if(a)break;m.showMessage(__svi18n.info.nocontrol,null,5E3);break;case 5:c=JSON.parse(d);m.onrequirecontrol&&(a=m.onrequirecontrol(c));if(a)break;a=__svi18n.info.title.applyArgs([c.name,c.numericId,c.__ip]);g=__svi18n.info.recontrol;va.isPaused&&(g+="<br><br>"+(__svi18n.info.autoresume||""));m.showMessage({title:a,msg:g,cbYes:function(){m.giveControl(c.numericId);this.destroy();va.isPaused()&&m.pauseSession(m.sessionInfo.appInfo.numericId,!1)},cbNo:function(){m.refuseControl(c.numericId);
this.destroy()},html:!0});break;case 6:ia.execute("setTouchRemoting",[!0]);break;case 7:c=JSON.parse(d);c.width&&c.height&&Ra(c.width,c.height,!0,J.monitorDef&&0<=J.monitor?!0:!1);c.color&&(Fa(c.color,!0),svGlobal.logger.warn("Color depth changed to:"+c.color));c.version&&(m.sessionInfo.protocolVersion=c.version);break;case 8:c=JSON.parse(d);Mb=!0;if(m.onrequestcredential&&m.onrequestcredential(c,Ta.reconnect))break;if(m.onautherror&&m.onautherror(c,Ta.reconnect))break;ia.getFocused().requestCredential(c,
Ta.reconnect);break;case 9:c=JSON.parse(d);0<c.interval&&0<c.width?Qd(c.width,c.interval):cb&&(cb.stop(),cb=null);break;case 11:c=JSON.parse(d);m.onrequirejoin&&(a=m.onrequirejoin(c));if(a)break;a=__svi18n.info.title.applyArgs([c.name,c.numericId,c.__ip]);m.showMessage({title:a,msg:__svi18n.info.reqjoin,cbYes:function(){m.allowJoin(c.numericId,!0);this.destroy()},cbNo:function(){m.allowJoin(c.numericId,!1);this.destroy()}});break;case 13:c=JSON.parse(d);"login"==c.type&&mc();break;case 14:c=JSON.parse(d);
if(m.oncontrolchange)m.oncontrolchange(c);break;case 15:c=JSON.parse(d),Rd(c)}}function Rd(a){if("cert"==a.type){Mb=!0;var b=__svi18n.info.cert||"The certificate of remote connection could not be verified. Do you want to continue?<br>Target: %1,<br>Hash: %2";b=b.applyArgs([a.target,a.hash]);hi5.notifications.notify({msg:b,cbYes:function(){this.destroy();window.localStorage.setItem(void 0,a.hash);Kb()},cbNo:function(){this.destroy()},html:!0})}}function Sc(a){switch(a.getByte()){case 32:if(!va.isPaused()){var b=
a.getLittleEndian16(),d=a.getLittleEndian16(),g=a.getLittleEndian16(),c=void 0,e=void 0;ja.noCursorName||(c=a.getLittleEndian32(),m.sessionInfo.appInfo&&(e=m.sessionInfo.appInfo.sessions[c]));nc(d,g,!0,e,c,b)}}}function nc(a,b,d,g,c,e){va.isPaused()||ia.getFocused().moveCursor(a,b,d,g,c,e)}function Pc(a){ia.setCursor(a)}function Sd(a){var b=ja.page&&ja.page.join||"";if(b.startsWith("http://")||b.startsWith("https://"))return b;if(b.startsWith("/"))return location.origin+b;var d=location.href,g=d.lastIndexOf("/");
if(b)return d.substring(0,g+1)+b;b=Aa();d.toLowerCase().startsWith(b.toLowerCase())&&(b=d.substring(0,g));return b+"/"+a}function Rc(a){a=JSON.parse(a);qc=a.session;var b=a.numericId,d=hi5.appcfg.persistentId?window.localStorage:window.sessionStorage;d&&(d.setItem("appInfo.session",qc),d.setItem("appInfo.numericId",b));ma(a.appId);a.server||(a.server=ha());if(b=hi5.$("joinSelect"))b.value=a.joinMode;if(b=hi5.$("requestControl"))b.disabled=a.hasControl;a.joined?1!=m.mode&&ia.execute("setAutoScale",
[!0]):(m.mode=0,U(J.connectif)&&ia.setSize(Ma,Na),ja.disableJoinedAppResize&&(m.windowState=0));var g=Aa();b=Sd("join.html")+"?id="+(a.joined||a.numericId);(d=a.webAddress)&&0<d.length&&d.toLowerCase()!=g.toLowerCase()&&(g=d.indexOf("://"),m.protocol="http"==d.substring(0,g)?"ws":"wss",m.gateway=d,b+="&gateway="+encodeURIComponent(d));b=m.modifyURL(b);a.joinLink=b;m.sessionInfo.appInfo=a;"isApp"in a&&Za!==a.isApp&&(Za=a.isApp,Ra(Ma,Na,!0,!0),tb||1==m.mode||ia.execute("setAutoScale",[!0]));a.ver&&
a.ver!=svGlobal.version&&svGlobal.logger.warn("Client:"+svGlobal.version+" server:"+a.ver);ja.cursorNameOnly=a.isAssistance;if(m.onsessionstart)m.onsessionstart(m.sessionInfo)}function Od(a){if(Pa){var b=parseInt(a.charAt(0),10);a=a.substring(1);if(5==b)Pa.notifyFiles(JSON.parse(a));else{var d=a.split("\t");switch(b){case 1:Pa.confirmId(d[0],d[1],d[2]);break;case 2:Pa.read(d[0],parseInt(d[1],10),parseInt(d[2],10));break;case 4:Pa.close(d[0]);break;case 9:a='<a href="'+m.modifyURL(Aa()+d[0])+'" download="'+
d[1]+'" target="_blank">'+__svi18n.info.fileReady+": "+d[1]+"</a>",__svi18n.info.download&&ia.getFocused().showMessage({msg:a,html:!0,title:__svi18n.info.download,cbNo:function(){Pa.removeFile(d[0],!0);this.destroy()},onclick:function(g){"A"==g.target.tagName&&this.destroy()}})}}}}function pc(a,b,d,g){if(!Xc||va.isPaused())return 0;var c=a.getPosition();b=a.getData();g||(g=a.getEnd()-c);if(41222==Ea.tag)return Va.onaudioframe(b.slice(c)),0;if(a=1!=Ea.tag)rc||(rc=new MSGSM),b=rc.decode(b,c,g),c=0,
g=b.length;var e=Ea.bitsPerSample;var f=Math.floor(g/(e>>3));var y=d=g=0;a||(g=Math.pow(2,e-1)-1,d=-g-1,y=Math.pow(2,e));e=Ea.channels;var w=Math.floor(f/e),t=Va.getBuffer(w),K=t.getChannelData(0),B=t.getChannelData(1);f=0;if(a)for(;f<w;)1==e?B[f]=K[f]=b[c++]:(K[f]=b[c++],B[f]=b[c++]),f++;else for(;f<w;)a=b[c++]|b[c++]<<8,a>g?(a-=y,a/=-d):a/=g,1==e?K[f]=a:(K[f]=a,a=b[c++]|b[c++]<<8,a>g?(a-=y,a/=-d):a/=g),B[f]=a,f++;return Va.playBuffer(t)}function Yc(a){if(!m.openLink||2E3<a.length)return!1;var b=
a.indexOf(";");0<b&&(a=a.substring(b+1));b=a;a=a.toLowerCase();var d=0==a.indexOf("http://")||0==a.indexOf("https://")||0==a.indexOf("ftp://")||0==a.indexOf("mailto:")||0==a.indexOf("tel:")||0==a.indexOf("callto:");d||(0==a.indexOf("www.")?(d=!0,a="http://"+a):0==a.indexOf("ftp.")&&(d=!0,a="ftp://"+a));return d?0<a.indexOf("\r")||0<a.indexOf("\n")?!1:m.onurlredirection&&m.onurlredirection(b)?!0:(a=ia.getFocused())?a.processLink(b):!1:!1}function Td(a){if(a.startsWith("text/html;<img data-sv-img")){var b=
a.indexOf('src="');if(0<b){b+=5;var d=a.indexOf('"',b),g=a.substring(b,d);g=m.modifyURL(g);a=a.substring(0,b)+g+a.substring(d)}}return a}function Nd(a){if("text/plain;"!=a){if(1666<Date.now()-Ta.reqCopyTime&&!(m.onservercopy&&m.onservercopy(a)||Yc(a))){var b=ia.getFocused();b&&b.copyToClip(Td(a))}setTimeout(function(){ya("883")},999)}}function mc(a){if(!tb&&(setTimeout(function(){La&&ya("884")},333),m.onloggedin))m.onloggedin();sc=tb=!0;a&&a.sessionId&&(m.sessionInfo.sessionId=a.sessionId);Za&&1!=
m.mode&&ia.execute("setAutoScale",[!1]);Pa&&(Pa.enabled=!0);Ob&&!Za&&(va.setContext(ia.getFocused().context),ia.repaint(0,0,va.width-1,va.height-1))}function Bb(a){if(m){hi5.browser.cookie.delete(Lb);svGlobal.logger.warn("closed "+(m.sessionInfo.appInfo?m.sessionInfo.appInfo.numericId:0));m.onagentmessage&&(m.onagentmessage=null);if(m.onagentclose)m.onagentclose();var b=Kc();b&&m.sessionInfo.appInfo&&0==m.mode&&(sessionStorage[b]=m.sessionInfo.appInfo.session);if(m&&(b=1!=m.mode,!La&&b&&Ib("connection"),
b=b&&(La||xb<m.reconnectTimes)&&0<xb&&!a,$a=La=!1,b)){xb--;__svi18n.info.reconnecting&&m.showMessage(__svi18n.info.reconnecting+" "+(m.reconnectTimes-xb)+"/"+m.reconnectTimes,null,3E3);setTimeout(Kb,ja.reconnectInterval||5E3);svGlobal.logger.info("Reconnecting..."+xb);return}if(Mb)svGlobal.logger.info("No release");else{Sa&&(m.stopPing(),Sa=null);Oa&&(Oa.removeEventListener("message",Lc,!1),Oa.postMessage({type:0,cmd:4}),Oa.terminate(),Oa=null);Pa&&(Pa.release(),Pa=null);Qa=p=null;Ka&&(Ka.close(),
Ka=null);ob&&hi5.Arrays.release(ob);mb&&hi5.Arrays.release(mb);cb&&(cb.stop(),cb=null);Va&&(Va.close(),Va=null);m.player&&(m.player=null);Eb=null;try{if(m.onclose)m.onclose(a);else if(svGlobal.logger.info("onclose: null"),hi5.appcfg&&hi5.appcfg.returnUrl){window.location.href=hi5.appcfg.returnUrl;return}ia&&(ia.close(),ia=null)}catch(d){svGlobal.logger.warn(d)}Ya=null;Ga&&(Ga.onopen=null,Ga.onmessage=null,Ga.onclose=null,Ga.onerror=null,Ga.close(),Ga=null);ia=Ta=null;va&&(va.release(),va=null);hi5.browser.isChromeApp?
chrome.runtime.onSuspend.removeListener(m.close):window.removeEventListener("unload",m.close,!1);window&&window.$rdp==m&&(window.$rdp=null);m=null}}}function Zc(a){Ga&&La?Ga.close(hi5.appcfg.returnUrl)||(hi5.appcfg.returnUrl=""):Bb(!0)}function Nc(a,b){var d=a.getLittleEndian32();if(0!=(d&16777216))if(b=a.getLittleEndian32(),0!=(d&1073741824)){a.getLittleEndian16();a.getByte();d=a.getByte();var g=a.getLittleEndian16(),c=a.getLittleEndian16(),e=0;16>d&&(e=a.getLittleEndian16());var f=a.getLittleEndian16(),
y=a.getLittleEndian16();a.getBytes(f);e&&a.getBytes(e);if(8<=d&&(e=ia.getFocused())&&e.onremoteappicon){f=new hi5.graphic.Bitmap(g,c,32);a.getPosition();g=new Uint8Array(g*c*4);c=a.getPosition();y=c+y;var w;a=a.getData();for(var t=0,K,B;c<y;)switch(d){case 16:(w=a[c++]|a[c++]<<8)?(B=w>>7&248,K=w>>2&248,w=w<<3&248,B|=B>>5,K|=K>>5,w|=w>>5,g[t++]=w,g[t++]=K,g[t++]=B,g[t++]=255):t+=4;break;case 32:g[t++]=a[c++],g[t++]=a[c++],g[t++]=a[c++],g[t++]=a[c++]}f.putPixels(g,0,g.length);a=ia.getWinById(b);e.onremoteappicon(a,
f)}}else 0!=(d&2147483648)?svGlobal.logger.info("XXX rail cache icon, winId="+b):0!=(d&536870912)?(svGlobal.logger.info("***** delete winId="+b),ia.delWin(b)):Ud(a,d,b);else if(0!=(d&33554432))svGlobal.logger.info("XXX Alt Sec window Notify="+d);else if(0!=(d&67108864))if(svGlobal.logger.info("*** -- Alt Sec window Desktop, flags:"+d),0!=(d&1))svGlobal.logger.info("Desktop non monitored flags="+d);else{if(0!=(d&32)&&(b=a.getLittleEndian32(),svGlobal.logger.info("Desktop monitored flags="+d+" winId="+
b),0<b&&((e=ia.getOwnerSurfaceById(b))&&e.railWin&&e.railWin.setActiveWinId(b,3==ja.windowState),ia.setTitle(b),va.getContext()||(b=ia.getFocused())&&va.setContext(b.context))),0!=(d&16)&&(b=a.getByte(),0<b))for(d=ia.zOrders,d.length=b,e=0;e<b;e++)d[e]=a.getLittleEndian32(),svGlobal.logger.info("---zorders:"+d[e])}else svGlobal.logger.info("XXX Alt Sec window order flgas="+d)}function $c(a){var b=ia.getFocused();if(b&&b.railWin){var d=a||b.railWin.mainWin;if(d&&2<d.showState){var g=b.getFreeSpace();
a=Math.max(Math.abs(d.winHeight-g.height),Math.abs(d.winWidth-g.width));svGlobal.logger.info("--- fitMainWin offset:"+a+" _hOffset:"+d._hOffset+" appId:"+d.appId+" spaceH:"+g.height);0<a?(b=a==d._hOffset,d._hOffset&&b||(d._hOffset=a,setTimeout(function(){d.resize(0,0,g.width,g.height)},333))):d._hOffset=0}}}function Ud(a,b,d){Za||(Za=!0);var g=0==(b&268435456),c=ia.getWinById(d);c?g=!0:c=new ia.LocalWin(d);svGlobal.logger.info("\n\n=========== winId="+d+" existed="+g);if(c){0!=(b&2)&&(c.ownerWinid=
a.getLittleEndian32(),svGlobal.logger.info("***** ownerWinid="+c.ownerWinid));0!=(b&8)&&(c.style=a.getLittleEndian32(),c.extStyle=a.getLittleEndian32(),svGlobal.logger.info("***** winId="+d+" style="+c.style+" extStyle="+c.extStyle),svGlobal.logger.info("*****--- WS_POPUP="+(0!=(c.style&2147483648))),svGlobal.logger.info("*****--- WS_DLGFRAME="+(0!=(c.style&4194304))),svGlobal.logger.info("*****--- DS_MODALFRAME="+(0!=(c.style&128))),svGlobal.logger.info("*****--- WS_EX_DLGMODALFRAME="+(0!=(c.extStyle&
1))),svGlobal.logger.info("*****--- WS_EX_TOOLWINDOW="+(0!=(c.extStyle&128))),svGlobal.logger.info("*****--- WS_BORDER="+(0!=(c.style&8388608))),svGlobal.logger.info("*****--- WS_CAPTION="+(0!=(c.style&12582912))),svGlobal.logger.info("*****--- WS_OVERLAPPED="+(0!=(c.style&0))),svGlobal.logger.info("*****--- WS_OVERLAPPEDWINDOW="+(0!=(c.style&13565952))),svGlobal.logger.info("*****--- WS_POPUPWINDOW="+(0!=(c.style&2156396544))),svGlobal.logger.info("*****--- WS_SIZEBOX="+(0!=(c.style&262144))),svGlobal.logger.info("*****--- WS_CHILD="+
(0!=(c.style&1073741824))),svGlobal.logger.info("*****--- WS_SIZEBOX="+(0!=(c.style&262144))),svGlobal.logger.info("*****--- WS_EX_MDICHILD="+(0!=(c.extStyle&64))),svGlobal.logger.info("*****--- WS_EX_LAYERED="+(0!=(c.extStyle&524288))));if(0!=(b&16)){c.setShowState(a.getByte());svGlobal.logger.info("***** winId="+d+" showState="+c.showState);var e=c.showState;(2==e&&0!=ja.noMinimize||!g&&3==e&&5==ja.windowState)&&setTimeout(function(){c.exeCommand(61728)},50)}if(e=0!=(b&4)){var f=a.getLittleEndian16();
c.titleInfo=a.getUnicodeString(f,!1);svGlobal.logger.info("***** winId="+d+" title="+c.titleInfo)}0!=(b&16384)&&(c.clientOffsetX=a.getLittleEndian32(),c.clientOffsetY=a.getLittleEndian32(),svGlobal.logger.info("***** winId="+d+" coffX"+c.clientOffsetX+" coffY="+c.clientOffsetY));0!=(b&65536)&&(c.clientAreaWidth=a.getLittleEndian32(),c.clientAreaHeight=a.getLittleEndian32(),svGlobal.logger.info("***** winId="+d+" cw"+c.clientAreaWidth+" ch="+c.clientAreaHeight));0!=(b&131072)&&(c.rpContent=a.getLittleEndian32());
0!=(b&262144)&&(c.rootParentHandle=a.getLittleEndian32());if(0!=(b&2048)){f=a.getLittleEndian32();var y=a.getLittleEndian32();c.winOffsetX=f;c.winOffsetY=y;svGlobal.logger.info("***** winId="+d+" offX"+c.winOffsetX+" offY="+c.winOffsetY)}0!=(b&32768)&&(c.winClientDeltaX=a.getLittleEndian32(),c.winClientDeltaY=a.getLittleEndian32(),svGlobal.logger.info("***** winId="+d+" dX"+c.winClientDeltaX+" dY="+c.winClientDeltaY));0!=(b&1024)&&(c.winWidth=a.getLittleEndian32(),c.winHeight=a.getLittleEndian32(),
svGlobal.logger.info("***** winId="+d+" w"+c.winWidth+" h="+c.winHeight));if(!g)if(c.isMainWin())3==m.windowState?$c(c):setTimeout(function(){c.activate(1)},666);else if(2<c.showState&&(f=ia.getFocused())){f=f.getFreeSpace();var w=c.winWidth,t=c.winHeight;if(c.winOffsetX>f.width||c.winOffsetY>f.height||0>w+c.winOffsetX||0>t+c.winOffsetY){var K=(f.width-c.winWidth)/2|0,B=(f.height-c.winHeight)/2|0;0>K&&(K=0);0>B&&(B=0);setTimeout(function(){c.resize(K,B,w,t)},50)}}0!=(b&256)&&(f=a.getLittleEndian16(),
0<f&&a.skipPosition(8*f));0!=(b&4096)&&(c.visibleOffsetX=a.getLittleEndian32(),c.visibleOffsetY=a.getLittleEndian32());0!=(b&512)&&(b=a.getLittleEndian16(),c.numVisibilityRects=b,0<b&&a.skipPosition(8*b));if(g)ia.onWinChange(c);else ia.addWin(c);e&&ia.setTitle(d);d==ia.zOrders[0]?svGlobal.logger.info("zzz zorders win: "+d):svGlobal.logger.info("zzz win: "+d,ia.zOrders)}else svGlobal.logger.warn("XXX, No win with id:"+d)}function Ec(a,b){function d(h,l,n,r,u){0<u.width?u.union(h,l,n,r):(u.x=h,u.y=
l,u.width=n,u.height=r)}function g(h,l,n,r){for(M=0;M<fa;M++){var u=Z[M];if(h>=u[0]&&l>=u[1]&&n<=u[2]&&r<=u[3])return W[M]}return null}function c(h,l,n,r){if(fa){var u=g(h,l,h+n-1,l+r-1);u&&d(h,l,n,r,u)}else d(h,l,n,r,ba)}function e(h,l,n,r,u,C,H){for(var G=u*n+r,D=h.setRGB,k=h.getRGB,q=0;q<H;q++){for(var F=0;F<C;F++){if(h){var Q=k(r+F,u+q);D(r+F,u+q,~Q&16777215)}else l[G]=~l[G]&16777215;G++}G+=n-C}}function f(h,l,n,r,u,C,H,G,D,k){l=k*G+D;null==H&&(H=h);for(h=0;h<C;h++){for(D=0;D<u;D++)O[r+h][n+D]=
O[r+h][n+D]&H[l]&16777215|4278190080,l++;l+=G-u}}function y(h,l,n,r,u,C,H,G,D,k){l=k*G+D;D=h.setRGB;k=h.getRGB;null==H&&(H=h);for(h=0;h<C;h++){for(var q=0;q<u;q++){var F=k(n+q,r+h);D(n+q,r+h,F|H[l]&16777215);l++}l+=G-u}}function w(h,l,n,r){var u=R;if(u){var C=u.getRGB(l,n);switch(h){case 0:u.setRGB(l,n,0);break;case 1:u.setRGB(l,n,~(C|r)&16777215);break;case 2:u.setRGB(l,n,C&~r&16777215);break;case 3:u.setRGB(l,n,~r&16777215);break;case 4:u.setRGB(l,n,16777215*(~C&r));break;case 5:u.setRGB(l,n,~C&
16777215);break;case 6:u.setRGB(l,n,C^r&16777215);break;case 7:u.setRGB(l,n,~C&r&16777215);break;case 8:u.setRGB(l,n,C&r&16777215);break;case 9:u.setRGB(l,n,C^~r&16777215);break;case 10:break;case 11:u.setRGB(l,n,C|~r&16777215);break;case 12:u.setRGB(l,n,r);break;case 13:u.setRGB(l,n,(~C|r)&16777215);break;case 14:u.setRGB(l,n,C|r&16777215);break;case 15:u.setRGB(l,n,16777215);break;default:svGlobal.logger.warn("unsupported pixel opcode: "+h),u.setRGB(l,n,r)}}}function t(h,l,n,r,u,C,H,G,D){h>G||l>
D||(n=h+n-1,n>G&&(n=G),h<C&&(h=C),n=n-h+1,r=l+r-1,r>D&&(r=D),l<H&&(l=H),r=r-l+1,1>n||1>r||R.fillRect(h,l,n,r,u))}function K(h,l,n,r,u,C,H,G,D,k,q,F){if(!(l>q||n>F)){var Q=l+r-1;Q>q&&(Q=q);D=l<D?D:l;Q=Q-l+1;q=n+u-1;q>F&&(q=F);k=n<k?k:n;F=q-n+1;if(!(1>Q||1>F)){q=128;var V=0;H|=4278190080;G|=4278190080;if(D==l&&k==n&&Q==r&&F==u)if(0==h)for(var da=0;da<u;da++){h=n+da;for(var pa=0;pa<r;pa++)0==q&&(V++,q=128),0!=(C[V]&q)&&(O[h][l+pa]=G),q>>=1;V++;q=128;V==C.length&&(V=0)}else for(da=0;da<u;da++){h=n+da;
for(pa=0;pa<r;pa++)0==q&&(V++,q=128),O[h][l+pa]=0!=(C[V]&q)?G:H,q>>=1;V++;q=128;V==C.length&&(V=0)}else if(0==h)for(da=0;da<F;da++){h=n+da;for(pa=0;pa<Q;pa++)0==q&&(V++,q=128),l+pa>=D&&h>=k&&0!=(C[V]&q)&&(O[h][l+pa]=G),q>>=1;V++;q=128;V==C.length&&(V=0)}else for(da=0;da<F;da++){h=n+da;for(pa=0;pa<Q;pa++)0==q&&(V++,q=128),l+pa>=D&&n+da>=k&&(O[h][l+pa]=0!=(C[V]&q)?G:H),q>>=1;V++;q=128;V==C.length&&(V=0)}}}}function B(){$a&&(R.onGetGfxHistory&&Qa&&Qa.enabled?(Qa.applyResolution(a,b),svGlobal.logger.info("...reset graphic for gfx")):
(m.sessionInfo.suppressOutput&&J.monitorDef&&524292==m.sessionInfo.appInfo.protocolVersion?(m.suppressOutput(!0),m.suppressOutput(!1)):m.refreshOutput(0,0,Ma-1,Na-1),svGlobal.logger.info("...reset graphic for gdi")));ca=S=0}function A(){var h=ja.historyTimeout||1700,l=ja.historyTimeoutMax||9E3;0<S&&Date.now()-S>l?(B(),svGlobal.logger.info("...reset graphic due to "+l)):ca=setTimeout(B,h)}function E(h,l,n,r,u){this.offset=h;this.baseLine=l;this.width=n;this.height=r;this.fontData=u}function x(h,l,
n,r,u,C,H,G,D){this.cache_idx=h;this.rawData=l;this.none=!l;this.hotX=n;this.hotY=r;this.width=u;this.height=C;this.xorSize=G;this.andSize=D;this.result="";this.distance=0;this.bpp=H;this.system="";if(l){if(!this.distance){h=0;if(l){H=0;for(var k=l.length;H<k;H++)0!=l[H]&&(h+=H%u+(H/u|0))}this.distance=h}if(!this.system){a:switch(this.distance){case 507:h="text";break a;case 2046:case 4359:h="default";break a;default:h=""}this.system=h}}h="";if(!this.system&&l){H=u*C*4;h=62+H+G+D;k=new Uint8Array(h);
h=new hi5.DataBuffer(k,0,h);h.setLittleEndian16(0);h.setLittleEndian16(2);h.setLittleEndian16(1);h.setByte(u);h.setByte(C);h.setByte(0);h.setByte(0);h.setLittleEndian16(n);h.setLittleEndian16(r);h.setLittleEndian32(40+H+G+D);h.setLittleEndian32(22);h.setLittleEndian32(40);h.setLittleEndian32(u);h.setLittleEndian32(2*C);h.setLittleEndian16(1);h.setLittleEndian16(32);h.setLittleEndian32(0);h.setLittleEndian32(G+D);h.setLittleEndian32(0);h.setLittleEndian32(0);h.setLittleEndian32(0);h.setLittleEndian32(0);
for(n=C-1;0<=n;n--)for(r=0;r<u;r++)C=l[u*n+r],h.setByte(C&255),h.setByte(C>>8&255),h.setByte(C>>16&255),h.setByte(C>>24&255);h="data:image/x-icon;base64,"+hi5.Base64.enc(h.getData())}this.url=h}var O=[],v=null,ba=new hi5.graphic.Rectangle(0,0,0,0),P="Uint8ClampedArray"in window,L=null,N=0,na=0,ta=0,T=0,z=null,Z,W,M=0,fa=0;this.width=a;this.height=b;var X=!1,R=this,la={imgData:null,left:0,top:0,width:0,height:0};this.setProfiler=function(h){L=h};this.getDirtyArea=function(){return ba};this.setImgRect=
function(h,l,n,r){N=h;na=l;ta=n;T=r};this.parseMonitorDef=function(h){var l=h.split(","),n=l.length,r=[];if(1<n){for(var u=!1,C=0;C<n;C++){var H=l[C].split(":");if(4==H.length)r[C]=Array(5),r[C][0]=parseInt(H[0]),r[C][1]=parseInt(H[1]),r[C][2]=parseInt(H[2]),r[C][3]=parseInt(H[3]),r[C][4]=0==r[C][0]&&0==r[C][1]?1:0;else{u=!0;break}}u&&(svGlobal.logger.warn("invaiid monitorDef:"+h),r.length=0)}return r};this.setMonitorLayout=function(h){var l=h.length,n=0;Z=h;for(W=Array(l);n<l;n++)W[n]=new hi5.graphic.Rectangle(0,
0,0,0);fa=l};this.setMonitorCount=function(h){fa=h};this.addImg=function(h){ta&&(z&&URL.revokeObjectURL(z.src),z=h)};this.flushImgs=function(){z&&(URL.revokeObjectURL(z.src),z=null,ta=0)};this.getData=function(){return O};this.pause=function(h,l){X=h;l&&v&&v.fillRect(0,0,a,b)};this.release=function(){ba=null;hi5.Arrays.release(W);R.flushImgs();O=v=R=null;la=la.imgData=null};this.isPaused=function(){return X};this.setContext=function(h){h!=v&&(v||!h||h.createImageData(1,1).data.buffer||(P=!1),v=h,
null!=v&&(la.imgData=v.createImageData(a,b)))};this.getContext=function(){return v};this.resize=function(h,l){if(O.length!=l||O[0].length!=h){for(var n=0;n<l;n++)O[n]=new Uint32Array(h);O.length=l;R.width=a=h;R.height=b=l;null!=v&&(la.imgData=v.createImageData(a,b))}};R.resize(a,b);this.getBuffer=function(){return O};this.setRGB=function(h,l,n){O[l][h]=n|4278190080};this.getRGB=function(h,l){return O[l][h]};this.setRGBs=function(h,l,n,r,u,C,H){var G=h+n,D=l+r;D>b&&(D=b);if(!(h>=a)){G>a&&(n-=G-a);
for(G=l;G<D;G++,C+=H)O[G].set(u.subarray(C,C+n),h);c(h,l,n,r)}};this.moveArea=function(h,l,n,r,u,C){if(0<C){var H=h+u,G=l+C,D;for(D=r-1;0<=D;D--)O[G+D].set(O[l+D].subarray(h,h+n),H)}else if(0>C)for(H=h+u,G=l+C,D=0;D<r;D++)O[G+D].set(O[l+D].subarray(h,h+n),H);else if(0<u){H=h+u;G=l+C;var k;for(D=n-1;0<=D;D--){var q=H+D;var F=h+D;for(k=0;k<r;k++)O[G+k][q]=O[l+k][F]}}else for(H=h+u,G=l+C,D=0;D<n;D++)for(q=H+D,F=h+D,k=0;k<r;k++)O[G+k][q]=O[l+k][F];c(h+u,l+C,n,r)};this.getRGBs=function(h,l,n,r,u){var C=
new Uint32Array(n*r),H=h+n;r=l+r;for(var G=0;l<r;l++)C.set(O[l].subarray(h,H),G),G+=n;return u?(u(C),null):C};this.repaint=function(h,l,n,r){var u=la.imgData.data,C=0,H,G;L&&L.begin("paint");0>h&&(n+=h,h=0);0>l&&(r+=l,l=0);h+n>a&&(n=a-h);l+r>b&&(r=b-l);var D=h+n;var k=l+r;if(P)for(u=new Uint32Array(u.buffer),G=l;G<k;G++)u.set(O[G].subarray(h,D),C),C+=a;else{var q=4*(a-n)|0;for(G=l;G<k;G++){for(H=h;H<D;H++){var F=O[G][H];u[C++]=F&255;u[C++]=F>>8&255;u[C++]=F>>16&255;u[C++]=255}C+=q}}la.left=h;la.top=
l;la.width=n;la.height=r;L&&L.end("paint");return la};this.postPaint=c;this.draw=function(h,l,n,r){if(!X&&v)if(z&&z.complete&&(v.drawImage(z,N,na,ta,T),URL.revokeObjectURL(z.src),z=null),fa){if(h=g(h,l,n,r),h.width)return R.repaint(h.x,h.y,h.width,h.height),h.width=0,la}else if(ba.width)return R.repaint(ba.x,ba.y,ba.width,ba.height),ba.width=0,la;return null};this.fillRect=function(h,l,n,r,u){var C=h+n,H=l+r;if(O[0].fill)for(var G,D=l;D<H;D++)O[D].fill(u,h,C);else for(D=l;D<H;D++)for(G=h;G<C;G++)O[D][G]=
u;c(h,l,n,r)};this.drawLine=function(h,l,n,r,u){if(l==r){if(h>n){var C=h;h=n;n=C}var H=O[l];n++;if(H.fill)H.fill(u,h,n);else for(C=h;C<n;C++)H[C]=u}else if(h==n)for(l>r&&(C=l,l=r,r=C),r++,C=l;C<r;C++)O[C][h]=u;else{var G=Math.abs(n-h),D=Math.abs(r-l);C=h;H=l;n=n>=h?h=1:h=-1;l=r>=l?r=1:r=-1;if(G>=D){l=h=0;var k=G;var q=G/2|0;var F=D}else r=n=0,k=D,q=D/2|0,F=G,G=D;if(!(1>G))for(G++,D=0;D<G;D++)O[H][C]=u,q+=F,q>=k&&(q-=k,C+=h,H+=r),C+=n,H+=l}};this.bitBlt=function(h,l,n,r,u,C,H,G,D,k){var q=R;switch(h){case 0:G=
q.setRGB;for(q=n;q<n+u;q++)for(D=r;D<r+C;D++)G(q,D,0);break;case 1:h=H;D=k*G+D;k=q.setRGB;l=q.getRGB;null==h&&(h=q);for(q=0;q<C;q++){for(H=0;H<u;H++)k(n+u,r+C,~(l(n+u,r+C)|h[D])&16777215);D+=G-u}break;case 2:h=H;D=k*G+D;k=q.setRGB;l=q.getRGB;null==h&&(h=q);for(q=0;q<C;q++){for(H=0;H<u;H++){var F=l(n+u,r+C);k(n+u,r+C,F&~h[D]&16777215);D++}D+=G-u}break;case 3:e(q,H,G,D,k,u,C);H?q.setRGBs(n,r,u,C,H,k*G+D,G):q.moveArea(D,k,u,C,n-D,r-k);break;case 4:e(q,null,l,n,r,u,C);f(q,l,n,r,u,C,H,G,D,k);break;case 5:e(q,
null,l,n,r,u,C);break;case 6:h=H;D=k*G+D;null==h&&(h=q);for(q=0;q<C;q++){for(k=0;k<u;k++)O[r+q][n+k]=O[r+q][n+k]^h[D]&16777215|4278190080,D++;D+=G-u}break;case 7:h=H;D=k*G+D;k=q.setRGB;l=q.getRGB;null==h&&(h=q);for(q=0;q<C;q++){for(H=0;H<u;H++)F=l(n+H,r+q),k(n+H,r+q,~(F&h[D])&16777215),D++;D+=G-u}break;case 8:f(q,l,n,r,u,C,H,G,D,k);break;case 9:h=H;D=k*G+D;k=q.setRGB;l=q.getRGB;null==h&&(h=q);for(q=0;q<C;q++){for(H=0;H<u;H++)F=l(n+H,r+q),k(n+H,r+q,F^~h[D]&16777215),D++;D+=G-u}break;case 10:break;
case 11:h=H;D=k*G+D;k=q.setRGB;l=q.getRGB;null==h&&(h=q);for(q=0;q<C;q++){for(H=0;H<u;H++)F=l(n+H,r+q),k(n+H,r+q,F|~h[D]&16777215),D++;D+=G-u}break;case 12:H?q.setRGBs(n,r,u,C,H,k*G+D,G):q.moveArea(D,k,u,C,n-D,r-k);break;case 13:e(q,null,l,n,r,u,C);y(q,l,n,r,u,C,H,G,D,k);break;case 14:y(q,l,n,r,u,C,H,G,D,k);break;case 15:G=q.setRGB;for(q=n;q<n+u;q++)for(D=r;D<r+C;D++)G(q,D,16777215);break;default:svGlobal.logger.warn("unsupported opcode: "+h)}c(n,r,u,C)};this.drawLineExt=function(h,l,n,r,u,C){if(h==
n||l==r){var H;if(l==r)if(n>h){var G=n-h;if(!(1>G))for(H=0;H<G;H++)w(C,h+H,l,u)}else{if(G=h-n,!(1>G))for(H=0;H<G;H++)w(C,n+H,l,u)}else if(r>l){if(G=r-l,!(1>G))for(H=0;H<G;H++)w(C,h,l+H,u)}else if(G=l-r,!(1>G))for(H=0;H<G;H++)w(C,h,r+H,u)}else{var D=Math.abs(n-h),k=Math.abs(r-l);H=h;G=l;var q,F;var Q=n>=h?q=1:q=-1;var V=r>=l?F=1:F=-1;if(D>=k){V=q=0;var da=D;var pa=D/2>>0;var ua=k}else F=Q=0,da=k,pa=k/2>>0,ua=D,D=k;if(1>D)return;for(k=0;k<=D;k++)w(C,H,G,u),pa+=ua,pa>=da&&(pa-=da,H+=q,G+=F),H+=Q,G+=
V}u=Math.min(h,n);h=Math.max(h,n);n=Math.min(l,r);l=Math.max(l,r);0>h-u||0>l-n||c(u,n,h-u+1,l-n+1)};this.drawText=function(h,l,n,r,u,C,H,G,D,k,q,F,Q,V,da,pa,ua,Ia,Ba,Ha,Wa){var Ja=0;1<F?t(k,q,F,Q,u,Ia,Ba,Ha,Wa):1==n&&t(C,H,G,D,u,Ia,Ba,Ha,Wa);for(var Ua=pa,Ca=0;Ca<pa;)switch(ua[Ja+Ca]){case 255:var Da=ua[Ja+Ca+2];if(Da>Ua-Ja){Ca=pa=0;break}Da=ua.slice?ua.slice(Ja,Ja+Da):ua.subarray(Ja,Ja+Da);za[ua[Ja+Ca+1]]=Da;Ca+=3;pa-=Ca;Ja=Ca;Ca=0;break;case 254:var bb=(Da=za[ua[Ja+Ca+1]])?Da:null;bb&&0==bb[1]&&
0==(l&32)&&(0!=(l&4)?da+=ua[Ja+Ca+2]:V+=ua[Ja+Ca+2]);Ca=Ca+2<pa?Ca+3:Ca+2;pa-=Ca;Ja=Ca;Ca=0;if(!bb)break;for(var pb=bb.length,ab=0;ab<pb;ab++){Da=qa.getFont(h,bb[ab]);if(0==(l&32)){var Xa=bb[++ab];0!=(Xa&128)?(0!=(l&4)?da+=bb[ab+1]|bb[ab+2]<<8:V+=bb[ab+1]|bb[ab+2]<<8,ab+=2):0!=(l&4)?da+=Xa:V+=Xa}Da&&(K(n,V+Da.offset&65535,da+Da.baseLine&65535,Da.width,Da.height,Da.fontData,u,r,Ia,Ba,Ha,Wa),0!=(l&32)&&(V+=Da.width))}break;default:Da=qa.getFont(h,ua[Ja+Ca]),0==(l&32)&&(Xa=ua[Ja+ ++Ca],0!=(Xa&128)?(0!=
(l&4)?da+=ua[Ja+Ca+1]|ua[Ja+Ca+2]<<8:V+=ua[Ja+Ca+1]|ua[Ja+Ca+2]<<8,Ca+=2):0!=(l&4)?da+=Xa:V+=Xa),Da&&(K(n,V+Da.offset&65535,da+Da.baseLine&65535,Da.width,Da.height,Da.fontData,u,r,Ia,Ba,Ha,Wa),0!=(l&32)&&(V+=Da.width)),Ca++}1<F?0<Q&&c(k,q,F,Q):0<G&&0<D&&c(C,H,G,D)};this.drawBitmap=function(h,l,n,r,u,C,H,G,D){var k=aa.getBitmap(h,l);k?(h=k.width,l=k.height,u>h&&(u=h),C>l&&(C=l),12==D?R.setRGBs(n,r,u,C,k.data,G*h+H,h):R.bitBlt(D,a,n,r,u,C,k.data,h,H,G)):svGlobal.logger.warn("Failed to get bitmap from cache, id:"+
h+" idx="+l)};this.saveDesktop=function(h,l,n,r,u){R.getRGBs(h,l,n,r,function(C){wa.save(h,l,n,r,u,C)})};this.restoreDesktop=function(h,l,n,r,u){(u=wa.restore(h,l,n,r,u))?R.setRGBs(h,l,n,r,u,0,n):svGlobal.logger.warn("XXX no matched desktop save.")};this.putFont=function(h,l,n){qa.putFont(h,l,n)};this.putBitmap=function(h,l,n){aa.putBitmap(h,l,n)};this.putCursor=function(h,l){ra.set(h,l)};this.setCursor=function(h){if(!X&&-1!=h){var l=ra.get(h);if(l)R.onSetCursor(l);else svGlobal.logger.warn("invalid cursor"+
h)}};var ka=0,ca=0,S=0;this.isSendingHistory=function(){return 2E3>Date.now()-ka};this.getHistory=function(h,l,n){0<ca?(clearTimeout(ca),ca=0,svGlobal.logger.info("...clear reset graphic timeout")):(S=Date.now(),svGlobal.logger.info("...start reset graphic timeout"));var r=ra.toPDU(h);r&&l(r.buffer);if(R.onGetGfxHistory)R.onGetGfxHistory(h,l,n);else{L&&L.begin("his_bitmap");aa.forEach(function(D,k,q){if(D){var F=0,Q=0;q=0;for(var V=D.length;q<V;q++)D[q]&&D[q].data&&(F++,Q+=D[q].raw?D[q].raw.length:
4*D[q].data.length);if(F&&Q){r=new Uint8Array(Q+20*F+8);r[0]=h;r[2]=1;r[3]=4;Q=new hi5.DataBuffer(r,4,r.length);Q.setLittleEndian32(F);for(q=0;q<V;q++)(F=D[q])&&F.data&&(Q.setLittleEndian16(k),Q.setLittleEndian16(q),Q.setLittleEndian16(F.left),Q.setLittleEndian16(F.top),Q.setLittleEndian16(F.width),Q.setLittleEndian16(F.height),Q.setLittleEndian16(F.bitsperpixel),Q.setLittleEndian16(F.codec),Q.setLittleEndian32(F.raw?F.raw.length:4*F.data.length),Q.setBytes(F.raw||new Uint8Array(F.data.buffer)));
l(r.buffer)}}});L&&L.end("his_bitmap");L&&L.begin("his_font");(r=qa.toPDU(h))&&l(r.buffer);L&&L.end("his_font");for(var u=4,C=0,H=za.length;C<H;C++)za[C]&&(u+=za[C].length+6);if(4<u){r=new Uint8Array(u);r[0]=h;r[2]=1;r[3]=7;var G=4;C=0;for(H=za.length;C<H;C++)za[C]&&za[C].length&&(r[G++]=C,r[G++]=C>>8,u=za[C].length,r[G++]=u,r[G++]=u>>8,r[G++]=u>>16,r[G++]=u>>24,r.set(za[C],G),G+=u);l(r.buffer)}(r=wa.toPDU(h))&&l(r.buffer);n(h);ka=Date.now()}A()};this.onHistoryDone=function(){};this.setHistory=function(h,
l){svGlobal.logger.info("setHistory type:"+h);switch(h){case 4:L&&L.begin("his_bitmap_dec");var n=l.getLittleEndian32();for(h=0;h<n;h++){var r=l.getLittleEndian16(),u=l.getLittleEndian16(),C=l.getLittleEndian16(),H=l.getLittleEndian16(),G=l.getLittleEndian16(),D=l.getLittleEndian16(),k=l.getLittleEndian16(),q=l.getLittleEndian16(),F=l.getLittleEndian32(),Q=new Uint8Array(l.getData().buffer,l.getPosition(),F),V=new Uint8Array(F);V.set(Q);Q=rdpcodecs.bitmap;switch(q){case 0:var da=new Uint32Array(V.buffer);
l.skipPosition(F);break;case 1:switch(k){case 16:da=Q.decompressInt16(G,D,F,V,0);break;case 24:da=Q.decompressInt24(G,D,F,V,0);break;case 32:da=Q.decompressInt32(G,D,F,V,0)}l.skipPosition(F);break;case 2:da=new rdpcodecs.NSCodec,da.process(l,k,G,D),F=da.getData(),da=da.getDataSize(),da=new Uint32Array(da),rdpcodecs.flipimage(F,0,da,G,D,1)}aa.putBitmap(r,u,new rdpcodecs.Bitmap(da,G,D,C,H,k,0==q?null:V,q))}L&&L.end("his_bitmap_dec");break;case 5:qa.fromStream(l);break;case 6:ra.fromStream(l);break;
case 7:for(;l.has(6);)if(h=l.getLittleEndian16(),F=l.getLittleEndian32())n=l.getData().subarray(l.getPosition(),l.getPosition()+F),za[h]=n,l.skipPosition(F);break;case 9:wa.fromStream(l);break;default:if(R.onSetGfxHistory)R.onSetGfxHistory(h,l)}};var ra=new function(){var h=[],l=!1;this.useRemoteCursor=function(n){l=n};this.set=function(n,r){l&&(r.system="");h[n]=r};this.get=function(n){return h[n]};this.total=function(){return h.length};this.toPDU=function(n){for(var r=2,u=2,C=0,H=0,G=h.length,D;H<
G;H++)if(D=h[H])C++,u=u+7+(D.rawData?D.rawData.length:0);if(!C)return null;u=new Uint32Array(u);u[0]=30==n?100728862:100728861;u[1]=C;for(H=0;H<G;H++)if(D=h[H])if(n=D.rawData?D.rawData.length:0,u[r++]=D.cache_idx|D.bpp<<16,u[r++]=D.hotX|D.hotY<<16,u[r++]=D.width|D.height<<16,u[r++]=D.xorSize,u[r++]=D.andSize,u[r++]=D.distance,u[r++]=n)u.set(D.rawData,r),r+=n;return u};this.fromStream=function(n){var r=n.getPosition();n=new Uint32Array(n.getData().buffer,r);var u=n[0],C=0;for(r=1;C<u;C++){var H=n[r]&
65535;var G=n[r++]>>16;var D=n[r]&65535;var k=n[r++]>>16;var q=n[r]&65535;var F=n[r++]>>16;var Q=n[r++];var V=n[r++];var da=n[r++];var pa=n[r++];var ua=null;pa&&(ua=new Uint32Array(pa),ua.set(n.subarray(r,r+pa)),r+=pa);G=new x(H,ua,D,k,q,F,G,Q,V);da&&(G.distance=da);l&&(G.system="");h[H]=G}}};ra.useRemoteCursor(!!ja.remoteCursor);var wa=new function(){function h(n,r,u,C,H,G){this.x=n;this.y=r;this.cx=u;this.cy=C;this.offset=H;this.data=G}var l=[];this.save=function(n,r,u,C,H,G){n=new h(n,r,u,C,H,
G);r=0;for(u=l.length;r<u;r++)if(!l[r]){l[r]=n;return}l.push(n)};this.restore=function(n,r,u,C,H){for(var G,D=0,k=l.length;D<k;D++)if((G=l[D])&&G.x==n&&G.y==r&&G.cx==u&&G.cy==C){if(G.offset==H)return n=G.data,l[D]=null,n;svGlobal.logger.warn("TODO: offset")}return null};this.toPDU=function(n){for(var r=0,u=2,C=0,H=l.length;C<H;C++)l[C]&&(r++,u+=l[C].data.length+6);if(!r||!u)return null;u=new Uint32Array(u);var G=2;u[0]=30==n?151060510:151060509;u[1]=r;for(C=0;C<H;C++)if(n=l[C])u[G++]=n.x,u[G++]=n.y,
u[G++]=n.cx,u[G++]=n.cy,u[G++]=n.offset,u[G++]=n.data.length,u.set(n.data,G),G+=n.data.length;return u};this.fromStream=function(n){n=new Uint32Array(n.getData().buffer,n.getPosition());for(var r=1,u=n[0],C,H,G,D,k,q,F,Q=0;Q<u;Q++)C=n[r++],H=n[r++],G=n[r++],D=n[r++],k=n[r++],q=n[r++],F=new Uint32Array(q),q=r+q,F.set(n.subarray(r,q)),r=q,this.save(C,H,G,D,k,F)}},za=[],qa=new function(){var h=[];this.putFont=function(l,n,r){h[l]||(h[l]=[]);h[l][n]=r};this.getFont=function(l,n){return h[l]?h[l][n]:null};
this.toPDU=function(l){var n=0,r,u,C;var H=4;for(var G,D=h.length;n<D;n++)if((C=h[n])&&C.length)for(G=C.length,r=0;r<G;r++)(u=C[r])&&(H+=15+u.fontData.length);if(5>H)return null;var k=new Uint8Array(H);H=new hi5.DataBuffer(k,0,H);k[0]=l;k[2]=1;k[3]=5;H.skipPosition(4);n=0;for(D=h.length;n<D;n++)if((C=h[n])&&C.length)for(G=C.length,r=0;r<G;r++)if(u=C[r])H.setByte(n),H.setLittleEndian16(r),H.setLittleEndian16(u.offset),H.setLittleEndian16(u.baseLine),H.setLittleEndian16(u.width),H.setLittleEndian16(u.height),
H.setLittleEndian32(u.fontData.length),H.setBytes(u.fontData);return k};this.fromStream=function(l){for(;l.has(15);){var n=l.getByte(),r=l.getLittleEndian16(),u=l.getLittleEndian16(),C=l.getLittleEndian16(),H=l.getLittleEndian16(),G=l.getLittleEndian16(),D=l.getLittleEndian32();D=l.getBytes(D);this.putFont(n,r,new E(u,C,H,G,D))}}},aa=new function(){var h=[],l=[];this.putBitmap=function(n,r,u){if(32767==r)l[n]&&(l[n].data=null,l[n]=null),l[n]=u;else{var C=h[n];C?C[r]&&(C[r].data=null,C[r]=null):h[n]=
C=[];C[r]=u}};this.getBitmap=function(n,r){return 32767==r?l[n]:h[n]?h[n][r]:null};this.forEach=function(n){for(var r=h.length,u=0;u<r;u++)n(h[u],u,h)}}}function Pb(a){function b(k,q,F){q[F]=k>>24;q[F+1]=k>>16;q[F+2]=k>>8;q[F+3]=k}function d(k,q){var F=k.length;q=new Uint8Array(q?F+1:F);for(var Q=0;Q<F;Q++)q[Q]=k.charCodeAt(Q);return q}var g=new Uint8Array([0,0,0,0]),c=new Uint8Array([255,255,255,255]),e={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],
minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],mehd:[]},f=this,y=1,w=a?48E3:9E4,t=1,K=!1,B=null;this.initTypes=function(){for(var k in e)e[k]=[k.charCodeAt(0),k.charCodeAt(1),k.charCodeAt(2),k.charCodeAt(3)];e.url=[117,114,108,32]};f.initTypes();this.reset=function(){K=!1;t=y=1};this.close=function(){f&&(f.reset(),f=null)};this.remux=function(k){k.id=y;k.isAudio=a;k.timeScale=
a?k.audioHeader.sampleRate:w;if(!K){var q=new E(a),F=new x(k);B=new Uint8Array(q.data.length+F.data.length);B.set(q.data,0);B.set(F.data,q.data.length);K=!0}k.sequenceNumber=t++;q=new h(k);F=new D(k);k=new Uint8Array(q.data.length+F.data.length);k.set(q.data,0);k.set(F.data,q.data.length);B&&(q=new Uint8Array(B.length+k.length),q.set(B,0),q.set(k,B.length),k=q,B=null);if(f.ondata)f.ondata(k)};var A=function(k){this.type=k;this.data=null};A.prototype.setData=function(){var k=Array.prototype.slice.call(arguments,
0),q=k.length,F=8,Q;for(Q=0;Q<q;Q++)F+=k[Q].byteLength;this.data=new Uint8Array(F);b(F,this.data,0);this.data.set(this.type,4);F=8;for(Q=0;Q<q;Q++)this.data.set(k[Q],F),F+=k[Q].byteLength};var E=function(k){var q=A.call(this,e.ftyp)||this;var F=d("mp42"),Q=d("mp41"),V=d("isom"),da=d("avc1"),pa=d("iso5"),ua=new Uint8Array([0,0,2,0]);k?q.setData(F,ua,F,Q,V,pa):q.setData(V,ua,V,Q,pa,da);return q};$jscomp.inherits(E,A);var x=function(k){var q=A.call(this,e.moov)||this;var F=new O(k),Q=new v(k);k=new qa(k);
q.setData(F.data,Q.data,k.data);return q};$jscomp.inherits(x,A);var O=function(k){k=A.call(this,e.mvhd)||this;var q=new Uint8Array([0]),F=new Uint8Array([0,0,0]),Q=new Uint8Array([0,0,0,0]),V=new Uint8Array([0,0,0,0]),da=new Uint8Array(4);b(1E3,da,0);var pa=new Uint8Array([0,1,0,0]),ua=new Uint8Array([1,0]),Ia=new Uint8Array(10),Ba=new Uint8Array(36);Ba[1]=1;Ba[17]=1;Ba[32]=64;var Ha=new Uint8Array(24),Wa=new Uint8Array([255,255,255,255]);k.setData(q,F,Q,V,da,g,pa,ua,Ia,Ba,Ha,Wa);return k};$jscomp.inherits(O,
A);var v=function(k){var q=A.call(this,e.trak)||this;var F=new ba(k);k=new P(k);q.setData(F.data,k.data);return q};$jscomp.inherits(v,A);var ba=function(k){var q=A.call(this,e.tkhd)||this;var F=new Uint8Array([0]),Q=new Uint8Array([0,0,7]),V=new Uint8Array([0,0,0,0]),da=new Uint8Array([0,0,0,0]),pa=new Uint8Array(4);b(k.id,pa,0);var ua=new Uint8Array(4),Ia=new Uint8Array(8),Ba=new Uint8Array([0,0]),Ha=new Uint8Array([0,0]),Wa=k.isAudio?new Uint8Array([1,0]):new Uint8Array([0,0]),Ja=new Uint8Array(2),
Ua=new Uint8Array(36);Ua[1]=1;Ua[17]=1;Ua[32]=64;var Ca=new Uint8Array(4);Ca[0]=k.width>>8&255;Ca[1]=k.width&255;Ca[2]=0;Ca[3]=0;var Da=new Uint8Array(4);Da[0]=k.height>>8&255;Da[1]=k.height&255;Da[2]=0;Da[3]=0;q.setData(F,Q,V,da,pa,ua,g,Ia,Ba,Ha,Wa,Ja,Ua,Ca,Da);return q};$jscomp.inherits(ba,A);var P=function(k){var q=A.call(this,e.mdia)||this;var F=new L(k),Q=new N(k);k=new na(k);q.setData(F.data,Q.data,k.data);return q};$jscomp.inherits(P,A);var L=function(k){var q=A.call(this,e.mdhd)||this;var F=
new Uint8Array([0]),Q=new Uint8Array([0,0,0]),V=new Uint8Array([0,0,0,0]),da=new Uint8Array([0,0,0,0]),pa=new Uint8Array(4);b(k.timeScale,pa,0);k=new Uint8Array([85,196]);var ua=new Uint8Array(2);q.setData(F,Q,V,da,pa,g,k,ua);return q};$jscomp.inherits(L,A);var N=function(k){var q=A.call(this,e.hdlr)||this;var F=new Uint8Array([0]),Q=new Uint8Array([0,0,0]),V=new Uint8Array(4);k=k.isAudio?d("soun"):d("vide");var da=new Uint8Array(12),pa=d("Remote Spark Handler",!0);q.setData(F,Q,V,k,da,pa);return q};
$jscomp.inherits(N,A);var na=function(k){var q=A.call(this,e.minf)||this;var F=new z,Q=new M(k);k.isAudio?(k=new T,q.setData(k.data,F.data,Q.data)):(k=new ta,q.setData(k.data,F.data,Q.data));return q};$jscomp.inherits(na,A);var ta=function(){var k=A.call(this,e.vmhd)||this;var q=new Uint8Array([0]),F=new Uint8Array([0,0,1]),Q=new Uint8Array([0,0]),V=new Uint8Array(6);k.setData(q,F,Q,V);return k};$jscomp.inherits(ta,A);var T=function(){var k=A.call(this,e.smhd)||this;var q=new Uint8Array([0]),F=new Uint8Array([0,
0,0]),Q=new Uint8Array([0,0]),V=new Uint8Array(2);k.setData(q,F,Q,V);return k};$jscomp.inherits(T,A);var z=function(){var k=A.call(this,e.dinf)||this;var q=new Z;k.setData(q.data);return k};$jscomp.inherits(z,A);var Z=function(){var k=A.call(this,e.dref)||this;var q=new Uint8Array([0]),F=new Uint8Array([0,0,0]),Q=new Uint8Array([0,0,0,1]),V=new W;k.setData(q,F,Q,V.data);return k};$jscomp.inherits(Z,A);var W=function(){var k=A.call(this,e.url)||this;var q=new Uint8Array([0]),F=new Uint8Array([0,0,
1]);k.setData(q,F);return k};$jscomp.inherits(W,A);var M=function(k){var q=A.call(this,e.stbl)||this;k=new fa(k);var F=new S,Q=new ra,V=new wa,da=new za;q.setData(k.data,F.data,Q.data,V.data,da.data);return q};$jscomp.inherits(M,A);var fa=function(k){var q=A.call(this,e.stsd)||this;var F=new Uint8Array([0]),Q=new Uint8Array([0,0,0]),V=new Uint8Array([0,0,0,1]);k.isAudio?(k=new X(k),q.setData(F,Q,V,k.data)):(k=new la(k),q.setData(F,Q,V,k.data));return q};$jscomp.inherits(fa,A);var X=function(k){var q=
A.call(this,e.mp4a)||this;var F=new Uint8Array(6),Q=new Uint8Array([0,1]),V=new Uint8Array(8),da=new Uint8Array([0,2]),pa=new Uint8Array([0,16]),ua=new Uint8Array([0,0]),Ia=new Uint8Array(2),Ba=k.audioHeader.sampleRate,Ha=new Uint8Array(4);Ha[0]=Ba>>8&255;Ha[1]=Ba&255;Ha[2]=0;Ha[3]=0;k=new R(k);q.setData(F,Q,V,da,pa,ua,Ia,Ha,k.data);return q};$jscomp.inherits(X,A);var R=function(k){var q=A.call(this,e.esds)||this;var F=new Uint8Array([0]),Q=new Uint8Array([0,0,0]),V=new Uint8Array([3]),da=new Uint8Array([25]),
pa=new Uint8Array([0,0]),ua=new Uint8Array([0]),Ia=new Uint8Array([4]),Ba=new Uint8Array([17]),Ha=new Uint8Array([64]),Wa=new Uint8Array([21]),Ja=new Uint8Array(3),Ua=k.bufferSizeDB;Ja[0]=Ua>>16;Ja[1]=Ua>>8;Ja[2]=Ua;var Ca=k.audioHeader.avgBitRate|96E3,Da=k.audioHeader.maxBitRate|1.2*Ca|0;Ua=new Uint8Array(4);b(Da,Ua,0);Da=new Uint8Array(4);b(Ca,Da,0);Ca=new Uint8Array([5]);var bb=new Uint8Array([2]),pb=k.audioHeader.audioType||2,ab=k.audioHeader.frequencyIdx,Xa=k.audioHeader.channelConfig;k=new Uint8Array(2);
k[0]=pb<<3|ab>>1&7;k[1]=(ab&1)<<7|Xa<<3;pb=new Uint8Array([6]);ab=new Uint8Array([1]);Xa=new Uint8Array([2]);q.setData(F,Q,V,da,pa,ua,Ia,Ba,Ha,Wa,Ja,Ua,Da,Ca,bb,k,pb,ab,Xa);return q};$jscomp.inherits(R,A);var la=function(k){var q=A.call(this,e.avc1)||this;var F=new Uint8Array(6),Q=new Uint8Array([0,1]),V=new Uint8Array([0,0]),da=new Uint8Array(2),pa=new Uint8Array(12),ua=new Uint8Array(2);ua[0]=k.width>>8&255;ua[1]=k.width&255;var Ia=new Uint8Array(2);Ia[0]=k.height>>8&255;Ia[1]=k.height&255;var Ba=
new Uint8Array([0,72,0,0]),Ha=new Uint8Array([0,72,0,0]),Wa=new Uint8Array(4),Ja=new Uint8Array([0,1]),Ua=d("SparkStreamPlayer"),Ca=new Uint8Array(32);Ca[0]=Ua.length;Ca.set(Ua,1);Ua=new Uint8Array([0,24]);var Da=new Uint8Array([255,255]);k=new ka(k);q.setData(F,Q,V,da,pa,ua,Ia,Ba,Ha,Wa,Ja,Ca,Ua,Da,k.data);return q};$jscomp.inherits(la,A);var ka=function(k){var q=A.call(this,e.avcC)||this;var F=new Uint8Array([1]),Q=new Uint8Array([k.sps[1]]),V=new Uint8Array([k.sps[2]]),da=new Uint8Array([k.sps[3]]),
pa=new Uint8Array([255]),ua=new Uint8Array([225]),Ia=new Uint8Array(2),Ba=k.sps.byteLength;Ia[0]=Ba>>8;Ia[1]=Ba;Ba=new Uint8Array(k.sps);var Ha=new Uint8Array([1]),Wa=new Uint8Array(2),Ja=k.pps.byteLength;Wa[0]=Ja>>8;Wa[1]=Ja;k=new Uint8Array(k.pps);q.setData(F,Q,V,da,pa,ua,Ia,Ba,Ha,Wa,k);return q};$jscomp.inherits(ka,A);var ca=function(){var k=A.call(this,e.btrt)||this;var q=new Uint8Array([0,28,156,128]),F=new Uint8Array([0,45,198,192]),Q=new Uint8Array([0,45,198,192]);k.setData(q,F,Q);return k};
$jscomp.inherits(ca,A);var S=function(){var k=A.call(this,e.stts)||this;var q=new Uint8Array([0]),F=new Uint8Array([0,0,0]),Q=new Uint8Array([0,0,0,0]);k.setData(q,F,Q);return k};$jscomp.inherits(S,A);var ra=function(){var k=A.call(this,e.stsc)||this;var q=new Uint8Array([0]),F=new Uint8Array([0,0,0]),Q=new Uint8Array([0,0,0,0]);k.setData(q,F,Q);return k};$jscomp.inherits(ra,A);var wa=function(){var k=A.call(this,e.stsz)||this;var q=new Uint8Array([0]),F=new Uint8Array([0,0,0]),Q=new Uint8Array([0,
0,0,0]),V=new Uint8Array([0,0,0,0]);k.setData(q,F,Q,V);return k};$jscomp.inherits(wa,A);var za=function(){var k=A.call(this,e.stco)||this;var q=new Uint8Array([0]),F=new Uint8Array([0,0,0]),Q=new Uint8Array([0,0,0,0]);k.setData(q,F,Q);return k};$jscomp.inherits(za,A);var qa=function(k){var q=A.call(this,e.mvex)||this;k=new aa(k);q.setData(k.data);return q};$jscomp.inherits(qa,A);ca=function(k){k=A.call(this,e.mehd)||this;var q=new Uint8Array([0]),F=new Uint8Array([0,0,0]);k.setData(q,F,c);return k};
$jscomp.inherits(ca,A);var aa=function(k){var q=A.call(this,e.trex)||this;var F=new Uint8Array([0]),Q=new Uint8Array([0,0,0]),V=new Uint8Array(4);b(k.id,V,0);k=new Uint8Array([0,0,0,1]);var da=new Uint8Array([0,0,0,0]),pa=new Uint8Array([0,0,0,0]),ua=new Uint8Array([0,0,0,0]);q.setData(F,Q,V,k,da,pa,ua);return q};$jscomp.inherits(aa,A);var h=function(k){var q=A.call(this,e.moof)||this;l.setSequenceNumber(k.sequenceNumber);k=new n(k);q.setData(l.data,k.data);return q};$jscomp.inherits(h,A);ca=function(k){var q=
A.call(this,e.mfhd)||this;var F=new Uint8Array([0]),Q=new Uint8Array([0,0,0]),V=new Uint8Array(4);b(k,V,0);q.setData(F,Q,V);return q};$jscomp.inherits(ca,A);ca.prototype.setSequenceNumber=function(k){b(k,this.data,12)};var l=new ca(1),n=function(k){var q=A.call(this,e.traf)||this;r.setTrackId(k.id);r.setSampleDuration(k.frameDuration);u.setBaseMediaDecodeTime(k.samples[0].timestamp);var F=32+r.data.length+u.data.length;if(k.isAudio)k=new G(k,null,F);else{for(var Q=[],V=0;V<k.samples.length;V++){var da=
k.samples[V];Q.push({size:da.unitsLength+4*da.units.length,duration:k.frameDuration||3E3,compositionTimeOffset:0,flags:{isLeading:0,dependsOn:da.hasIDR?2:1,isDependedOn:0,hasRedundancy:0,isNonSync:da.hasIDR?0:1,degradationPriority:0}})}k=new G(k,Q,F)}q.setData(r.data,u.data,k.data);return q};$jscomp.inherits(n,A);ca=function(k,q){var F=A.call(this,e.tfhd)||this;F.isAudio=q;var Q=new Uint8Array([0]),V=q?new Uint8Array([2,0,10]):new Uint8Array([2,0,40]),da=new Uint8Array(4);b(k,da,0);q?(k=new Uint8Array([0,
0,0,1]),q=new Uint8Array(4),b(1024,q,0),F.setData(Q,V,da,k,q)):(k=new Uint8Array([0,0,2,0,1,1,0,0]),F.setData(Q,V,da,k));return F};$jscomp.inherits(ca,A);ca.prototype.setTrackId=function(k){b(k,this.data,12)};ca.prototype.setSampleDuration=function(k){this.isAudio||b(k,this.data,16)};var r=new ca(0,a);ca=function(k){var q=A.call(this,e.tfdt)||this;var F=new Uint8Array([0]),Q=new Uint8Array([0,0,0]),V=new Uint8Array(4);b(k,V,0);q.setData(F,Q,V);return q};$jscomp.inherits(ca,A);ca.prototype.setBaseMediaDecodeTime=
function(k){b(k,this.data,12)};var u=new ca(0),C=new Uint8Array([0,0,2,1,0,0,0,0,0,0,0,0]),H=new Uint8Array([0,0,15,1,0,0,0,0,0,0,0,0]),G=function(k,q,F){var Q=A.call(this,e.trun)||this;var V=k.isAudio,da=k.samples,pa=k.isAudio?C:H,ua=V?4:16;k=V?k.samples.length:q.length;F+=ua*k+28;b(k,pa,4);b(F,pa,8);if(V)for(F=new Uint8Array(ua*k),V=0;V<k;V++)b(da[V].aacData.byteLength,F,ua*V);else for(F=new Uint8Array(ua*q.length),V=0;V<k;V++){da=q[V];var Ia=ua*V;b(da.duration,F,Ia);b(da.size,F,Ia+4);var Ba=da.flags,
Ha=new Uint8Array(4);Ha[0]=Ba.isLeading<<2|Ba.dependsOn;Ha[1]=Ba.isDependedOn<<6|Ba.hasRedundancy<<4|0|Ba.isNonSync;Ha[2]=Ba.degradationPriority&61440;Ha[3]=Ba.degradationPriority&15;F.set(Ha,Ia+8);b(da.compositionTimeOffset,F,Ia+12)}Q.setData(pa,F);return Q};$jscomp.inherits(G,A);ca=function(k){var q=A.call(this,e.sdtp)||this;for(var F=new Uint8Array([0]),Q=new Uint8Array([0,0,0]),V=new Uint8Array(k.length),da=0;da<k.length;da++){var pa=k[da].flags;V[da]=pa.isLeading<<6|pa.dependsOn<<4|Q.isDependedOn<<
2|Q.hasRedundancy}q.setData(F,Q,V);return q};$jscomp.inherits(ca,A);var D=function(k){var q=A.call(this,e.mdat)||this;var F=0,Q=k.samples,V=Q.length;if(k.isAudio){var da=new Uint8Array(k.totalByteLength);for(k=0;k<V;k++){var pa=Q[k].aacData;da.set(pa,F);F+=pa.byteLength}q.setData(da)}else{da=new Uint8Array(4*k.unitNum+k.totalByteLength);for(k=F=0;k<V;k++){pa=Q[k].units;for(var ua=0,Ia=pa.length;ua<Ia;ua++){var Ba=pa[ua],Ha=Ba.data.byteLength;b(Ha,da,F);F+=4;da.set(Ba.data,F);F+=Ha}}q.setData(da)}return q};
$jscomp.inherits(D,A)}function tc(a){function b(t,K){this.aacData=t;this.timestamp=K}function d(t,K,B,A,E){this.audioType=t;this.frequencyIdx=K;this.sampleRate=B;this.channelConfig=A;this.avgBitRate=E||0}var g=tc.SAMPLING_FREQUENCY,c=null,e=!0,f=this,y=0;this.reset=function(){y=0;a&&a.reset()};var w=new function(){this.samples=[];this.duration=0;this.audioHeader=null;this.height=this.width=0;this.bufferSizeDB=1536;this.totalByteLength=this.bitRate=0;this.clear=function(){this.samples=[];this.totalByteLength=
this.bitRate=this.duration=0}};this.setMediaFormat=function(t,K){var B=t.frequencyIdx;B||(B=g.indexOf(t.sampleRate));-1==B&&console.error("Invalid AAC sampel rate: "+t.sampleRate);var A=A?t.avgBitRate:t.nAvgBytesPerSec?8*t.nAvgBytesPerSec:0;c=new d(t.audioType||2,B,t.sampleRate,t.channels||t.channelConfig,A);w.audioHeader=c;e=!K;if(f.oncodec)f.oncodec("mp4a.40.2",c)};this.parseAACData=this.parse=function(t){if(e){var K=f.readADTSHeader(t);t=t.subarray(K)}K=new b(t,y);y+=1024;w.samples.push(K);w.totalByteLength+=
t.byteLength;w.duration=1/(c.sampleRate/1024);a&&a.remux(w);w.clear()};this.readADTSHeader=function(t){var K=t[1]&0?9:7,B=(t[2]>>6&3)+1,A=t[2]>>2&15,E=g[A];E||console.error("Invalid Sampling Frequency Index: "+A);var x=((t[2]&1)<<2)+(t[3]>>6&3),O=t[1]>>1&3;0!=O&&console.error("Invalid data format: layer is not 0x00: "+O.toString(16));t.length!=((t[3]&3)<<11)+(t[4]<<3)+(t[5]>>5&7)&&console.error("No enough data in one ADTS frame, length= "+t.length);if(c){if(A!=c.frequencyIdx&&(c.frequencyIdx=A,c.sampleRate=
E,f.oncodec))f.oncodec("mp4a.40.2",c)}else if(c=new d(B,A,E,x),w.audioHeader=c,f.oncodec)f.oncodec("mp4a.40.2",c);return K}}function uc(a){function b(){if(0==c)throw console.error("no more ExpGolomb data"),Error("no more ExpGolomb data");var y=0,w=g-c;for(e=0;w<g;){var t=a[w];3==t&&2<=w&&0==a[w-1]&&0==a[w-2]||(e=e<<8|t,y++);w++;if(4<=y)break}4>y&&(e<<=8*(4-y));f=8*y;c=g-w}function d(){var y;for(y=0;y<f;++y)if(0!==(e&2147483648>>>y))return e<<=y,f-=y,y;b();return y+d()}var g=a.byteLength,c=g,e=0,f=
0;this.data=a;this.availabeBytes=function(){return c};this.skipBits=function(y){if(!(f>y)){y-=f;var w=y>>3;y-=w>>3;c-=w;b()}e<<=y;f-=y};this.readBits=function(y){var w=Math.min(f,y),t=e>>>32-w;32<y&&logger.error("Read more than 32 bits:"+y);f-=w;0<f?e<<=w:0<c&&b();w=y-w;return 0<w?t<<w|this.readBits(w):t};this.skipUEG=function(){this.skipBits(1+d())};this.skipEG=function(){this.skipBits(1+d())};this.readUEG=function(){var y=d();return this.readBits(y+1)-1};this.readEG=function(){var y=this.readUEG();
return 1&y?1+y>>>1:-1*(y>>>1)};this.readBool=function(){return 1===this.readBits(1)};this.readU8=function(){return this.readBits(8)};this.readU16=function(){return this.readBits(16)};this.readU32=function(){return this.readBits(32)};this.readSliceType=function(){this.readU8();this.readUEG();return this.readUEG()}}function Vd(){var a=[],b=0,d=0,g=Number.leadingZeros;this.writeU8=function(c){this.writeBits(c,8)};this.writeBits=function(c,e){if(32<e)throw Error("Write more than 32 bits: "+e);for(;0<
e;){var f=Math.min(e,8-d);b=b<<f|c>>>e-f&(1<<f)-1;d+=f;e-=f;if(8<=d){f=b>>>d-8&255;var y=a.length;4>f&&2<=y&&0==a[y-1]&&0==a[y-2]&&a.push(3);a.push(f);d-=8}}};this.writeBool=function(c){this.writeBits(c?1:0,1)};this.writeU32=function(c){this.writeBits(c,32)};this.writeUEG=function(c){if(0>c)console.error("Cannot write negative value as unsigned: "+c);else{c++;var e=32-g(c);this.writeBits(c,e+e-1)}};this.writeEG=function(c){this.writeUEG(0>=c?-c<<1:(c<<1)-1)};this.finalize=function(){if(0<d){var c=
8-d;this.writeBits(1<<c-1,c)}return a}}function Wd(a){function b(){this.height=this.width=0;this.codec="";this.pps=this.sps=null;this.frameDuration=3E3;this.samples=[];this.sequence=this.unitNum=this.totalByteLength=0;this.clear=function(){this.unitNum=this.totalByteLength=this.samples.length=0}}function d(){this.units=y;this.unitsLength=w;this.timestamp=c;this.hasIDR=e}function g(){var A=!1;if(f&&K.sps){var E=new d;c+=K.frameDuration||3E3;K.samples.push(E);K.totalByteLength+=w;K.unitNum+=y.length;
K.sequence++;A=!0;if(E.hasIDR&&B.onkeyframe)B.onkeyframe(E)}f=e=!1;y=[];w=0;return A}var c=0,e=!1,f=!1,y=[],w=0,t=Pb.searchStartCode,K=null,B=this;K=new b;this.reset=function(){c=0;e=!1;y=[];w=0;K=new b;a&&a.reset()};this.close=function(){B&&(B.reset(),B=null)};this.parseH264Data=this.parse=function(A){for(var E=[],x=0,O,v,ba,P=[0,0];x<A.byteLength;){P[0]=x;t(A,P);var L=P[0];if(-1==L)break;x=P[1];x=L+x;ba=A[x];ba&=31;O&&(O={type:v,data:A.subarray(O,L)},E.push(O));O=x;v=ba}O&&(O={type:v,data:A.subarray(O,
A.byteLength)},E.push(O));for(A=0;A<E.length;A++)switch(P=E[A],x=P.type,x){case 1:case 2:case 3:case 4:y.push(P);w+=P.data.byteLength;f=!0;break;case 5:f=e=!0;y.push(P);w+=P.data.byteLength;break;case 6:break;case 7:x=new uc(P.data);O=null;try{O=Qb.SPS.read(x)}catch(N){svGlobal.logger.info("Error parsing SPS: "+N)}if(O){if(K.width=O.width,K.height=O.height,K.codec=O.codec,K.sps=P.data,O.fps&&(K.frameDuration=9E4/O.fps|0),y.push(P),w+=P.data.byteLength,B.oncodec)B.oncodec(K.codec,O)}else console.log("corrupted sps",
P.data);break;case 8:K.pps=P.data;y.push(P);w+=P.data.byteLength;break;case 9:g();break;default:console.log("Ignore NAL unit with type = "+x)}g()&&K.sps&&(a.remux(K),K.clear())}}function Rb(a,b,d){function g(){for(;w;){if(v.updating){w=!1;break}var L=y.shift();if(!L)break;try{v.appendBuffer(L),t=0}catch(N){y.unshift(L);if("QuotaExceededError"==N.name)if(f(!0))continue;else{if(K.onerror)K.onerror(N);else console.log("QuotaExceededError: not recoverable, isAudio: "+d),K.close();break}t++;console.error("Failed to append buffer, retry "+
t,N);if(2<t){if(K.onerror)K.onerror(N);break}}}}function c(){w=!0;g()}function e(){O.duration=Number.POSITIVE_INFINITY;v=O.addSourceBuffer(B);v.mode="sequence";v.addEventListener("updateend",c);v.addEventListener("error",function(L){console.error(L)});w=!0;K.play(!1);g()}function f(L){var N=Math.min(a.played.end(0),v.buffered.end(0)),na=0,ta=x.length,T=!1,z=0;if(d)z=N-180,0>z&&console.warn("Not possible, time played secs: "+N);else if(1<ta){var Z=ta-2;for(N=9E4*N|0;na<ta;){if(x[na]>N){Z=na-2;break}na++}0<=
Z&&(z=(x[Z]+1E3)/9E4)}if(0<z)try{v.remove(0,z),x.splice(0,Z+1),T=!0,console.info("Buffer removed "+z+" isAudio: "+d)}catch(W){console.warn("Buffer removal "+z+" failed, retry, isAudio: "+d)}L||(E=setTimeout(f,18E4));return T}var y=[],w=!1,t=0,K=this,B="",A=null,E=0,x=[],O=null,v=null,ba=null,P=null;a.autoplay=!0;this.getKeyFrames=function(){return x};ba=new Pb(d);ba.ondata=function(L){y.push(L);g()};P=d?new tc(ba):new Wd(ba);P.onkeyframe=function(L){x.push(L.timestamp)};P.oncodec=function(L,N){var na=
d?"audio/mp4;codecs=":"video/mp4;codecs=";na+=L;if(na!=B||(d?A.sampleRate!=N.sampleRate:A.width!=N.width||A.height!=N.height))if(B=na,A=N,w=!1,v=null,O=new MediaSource,O.addEventListener("sourceopen",e),a.src=URL.createObjectURL(O),K.onsps)K.onsps(N)};b.onvideoframe=function(L){P.parse(L.bitstream)};b.onaudioframe=function(L){P.parse(L)};b.onendofstream=function(){K.reset()};this.play=function(L,N){a.play().then(function(){if(d){var na=v.buffered.end(0);na&&(a.currentTime=na-.01)}w=!0}).catch(function(na){if(!L&&
(console.error(na),K.onplayerror))K.onplayerror(na)})};this.reset=function(){console.log("Reset player");E&&(clearTimeout(E),E=0);x.length=0;w=!1;B="";A=null;P&&P.reset();y.length=0};this.close=function(){K&&(K.reset(),O&&"open"==O.readyState&&(O.endOfStream(),a.src=null),P&&P.close&&P.close(),ba&&ba.close&&ba.close(),K=null)};this.setMediaFormat=function(L,N){P.setMediaFormat&&P.setMediaFormat(L,N)};this.getMediaSource=function(){return O};this.getMediaSourceBuffer=function(){return v};a.addEventListener("ended",
function(L){console.warn(".... ended");E&&(clearTimeout(E),E=0)});a.addEventListener("emptied",function(L){w=!!v});a.addEventListener("pause",function(L){console.warn(".... paused");w=!!v;var N=a.currentTime;a.play().then(function(){console.warn("... played: "+a.currentTime+" t: "+N)}).catch(function(na){console.error(na)})});a.addEventListener("waiting",function(L){w=!!v})}function Xd(a,b,d,g){function c(x,O,v,ba){var P,L,N,na,ta,T,z,Z,W,M,fa,X,R,la,ka,ca,S,ra,wa,za,qa,aa,h,l,n,r,u,C,H,G,D,k,q,F,
Q,V,da,pa,ua;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Ia){if(1==Ia.nextAddress)return P=x.allocationSize(),L=new Uint8Array(P),Ia.yield(x.copyTo(L),2);N=x.codedWidth;na=(N+1)/2|0;ta=x.codedHeight;T=(ta+1)/2|0;z=N*ta;Z=z+na*T;W=2*z;M=O.subarray(z,W);fa=O.subarray(W);S=ca=ka=la=R=X=0;qa=za=wa=ra=null;aa=L.subarray(0,z);h=L.subarray(z,Z);l=L.subarray(Z);n=0;for(r=ba.length;n<r;n++){u=ba[n];C=u.left;H=u.top;G=u.right;D=u.bottom;k=C/2|0;q=H/2|0;F=G/2|0;Q=D/2|0;V=k/2|0;da=F/2|0;for(R=
H;R<D;R++)for(ca=R*N,S=ca+N,ra=aa.subarray(ca,S),za=M.subarray(ca,S),qa=fa.subarray(ca,S),X=k;X<F;X++)ka=2*X+1,za[ka]=ra[X],qa[ka]=ra[X+na];pa=(na+1)/2|0;if(v)for(ua=L.subarray(z),R=q;R<Q;R++)for(ca=R*N,S=ca+na,ra=ua.subarray(ca,S),ca=S,S=ca+na,wa=ua.subarray(ca,S),ca=(2*R+1)*N,S=ca+N,za=M.subarray(ca,S),qa=fa.subarray(ca,S),X=k;X<F;X++)la=2*X,za[la]=ra[X],qa[la]=wa[X];else for(R=q;R<Q;R++)for(ca=R*na,S=ca+na,ra=h.subarray(ca,S),wa=l.subarray(ca,S),ca=(2*R+1)*N,S=ca+N,za=M.subarray(ca,S),qa=fa.subarray(ca,
S),X=V;X<da;X++)la=4*X,za[la]=ra[X],qa[la]=ra[X+pa],la+=2,za[la]=wa[X],qa[la]=wa[X+pa]}Ia.jumpToEnd()})}function e(x,O,v,ba){var P,L,N,na,ta,T,z,Z,W,M,fa,X,R,la,ka,ca,S,ra,wa,za,qa,aa,h,l,n,r,u,C,H,G,D,k,q,F,Q,V,da,pa,ua,Ia,Ba,Ha,Wa,Ja,Ua,Ca;return $jscomp.asyncExecutePromiseGeneratorProgram(function(Da){if(1==Da.nextAddress)return P=new Uint8Array(x.allocationSize()),Da.yield(x.copyTo(P),2);L=x.codedWidth;N=x.codedHeight;na=(L+1)/2|0;ta=(N+1)/2|0;T=L*N;z=T+na*ta;Z=P.subarray(T,z);W=P.subarray(z);
M=2*T;fa=O.subarray(T,M);X=O.subarray(M);wa=ra=S=ca=ka=la=R=0;h=aa=qa=za=null;l=0;for(n=ba.length;l<n;l++){r=ba[l];u=r.left;C=r.top;H=r.right;G=r.bottom;D=H-u;k=G-C;q=C*L+u;F=P.subarray(q,T);Q=O.subarray(q,T);V=fa.subarray(q);da=X.subarray(q);pa=u/2|0;ua=C/2|0;Ia=H/2|0;Ba=G/2|0;Ha=Ia-pa;Wa=Ba-ua;for(la=0;la<k;la++)ca=la*L,S=ca+D,za=F.subarray(ca,S),Q.set(za,ca);if(v)for(q=ua*L+u,Ja=P.subarray(T+q),la=0;la<Wa;la++){ca=la*L;S=ca+D;za=Ja.subarray(ca,S);ca=2*la*L;S=ca+D;aa=V.subarray(ca,S);h=da.subarray(ca,
S);for(R=0;R<Ha;R++)ka=2*R,ra=za[ka],aa[ka]=ra,aa[ka+1]=ra,wa=za[ka+1],h[ka]=wa,h[ka+1]=wa,void 0==wa&&console.log("undefined v: "+ka,R,la,ca,S,D,Ha,Wa);ca+=L;V.set(aa,ca);da.set(h,ca)}else for(q=ua*na+pa,Ua=Z.subarray(q),Ca=W.subarray(q),la=0;la<Wa;la++){ca=la*na;S=ca+Ha;za=Ua.subarray(ca,S);qa=Ca.subarray(ca,S);ca=2*la*L;S=ca+D;aa=V.subarray(ca,S);h=da.subarray(ca,S);for(R=0;R<Ha;R++)ka=2*R,ra=za[R],aa[ka]=ra,aa[ka+1]=ra,wa=qa[R],h[ka]=wa,h[ka+1]=wa;ca+=L;V.set(aa,ca);da.set(h,ca)}}return Da.return(O)})}
function f(x){var O;return $jscomp.asyncExecutePromiseGeneratorProgram(function(v){switch(v.nextAddress){case 1:if(!g){if(1E3==x.duration)t.onframedecoded(x,E.getRects(x.timestamp));v.jumpTo(2);break}O=null;return 1E3==x.duration?v.yield(E.setMainFrame(x),6):v.yield(E.getCombinedFrame(x),5);case 5:O=v.yieldResult;v.jumpTo(4);break;case 6:O=v.yieldResult;case 4:t.onframedecoded(O),O.close();case 2:x.close(),v.jumpToEnd()}})}function y(x){var O=x.codec;if(O!=w||(b?B.sampleRate!=x.sampleRate:B.width!=
x.width||B.height!=x.height))if(console.log("Codec: "+O+" audio: "+b),w=O,B=x,K||(K=new VideoDecoder({output:function(v){f(v)},error:function(v){console.error("VideoDecoder error:",v);if(t.onerror)t.onerror(v)}})),O={codec:w,codedWidth:x.width,codedHeight:x.height,hardwareAcceleration:d||"no-preference"},console.log(O),K.configure(O),t.onsps)t.onsps(x)}var w=null,t=this,K,B=null,A={type:"delta",data:null,timestamp:0,duration:0},E=new function(){function x(L){for(;;){var N=O.shift();if(N){if(N.timestamp==
L)return N.rects;if(N.timestamp>L){console.log("not possible, time: "+L+" option.timestamp: "+N.timestamp);break}}else break}return null}var O=[],v=null,ba=!1,P={timestamp:0,codedWidth:0,codedHeight:9,duration:0,format:"I444"};this.pushRects=function(L){O.push(L)};this.getRects=x;this.setMainFrame=function(L){return $jscomp.asyncExecutePromiseGeneratorProgram(function(N){if(1==N.nextAddress)return v||(v=new Uint8Array(2*L.allocationSize()),ba="NV12"==L.format,P.codedWidth=L.codedWidth,P.codedHeight=
L.codedHeight,console.log("isNV12: "+ba+" supportsI444: "+g)),N.yield(e(L,v,ba,x(L.timestamp)),2);P.duration=L.duration;P.timestamp=L.timestamp;return N.return(new VideoFrame(v,P))})};this.getCombinedFrame=function(L){return $jscomp.asyncExecutePromiseGeneratorProgram(function(N){if(1==N.nextAddress)return N.yield(c(L,v,ba,x(L.timestamp)),2);P.duration=L.duration;P.timestamp=L.timestamp;return N.return(new VideoFrame(v,P))})};this.close=function(){v&&(v=null)}};a.onvideoframe=function(x){var O=x.bitstream;
var v=0,ba=[0,0],P=O.length;var L=!1;var N=null;for(var na=!1,ta=0,T=0,z=0,Z=0;v<P;){ba[0]=v;Pb.searchStartCode(O,ba);var W=ba[0];if(-1==W){T=ba[1];break}z&&!Z&&(Z=W);W+=ba[1];v=W+1;ta=O[W]&31;switch(ta){case 5:L=!0;break;case 7:z=W;W=new uc(O.subarray(W));try{N=Qb.SPS.read(W)}catch(ka){svGlobal.logger.info(ka)}N||(na=!0)}}ba=P-v;W=7>ba;v=null;if(W||N)if(W&&(v=O.subarray(0,P-(ba+(T+1))),7==ta&&(na=!1)),N){W=new uc(O.subarray(z,Z));try{var M=Qb.SPS.read(W);if(M){var fa=M.vui.video_signal;fa.video_signal_type_present_flag=
!0;fa.video_format=5;fa.video_full_range_flag=!0;fa.colour_description_present_flag=!0;fa.colour_description={colour_primaries:1,transfer_characteristics:1,matrix_coefficients:1};var X=new Vd;Qb.SPS.write(M,X);var R=X.finalize();v||(v=O);var la=new Uint8Array(R.length+v.length-(Z-z));la.set(v.subarray(0,z),0);la.set(R,z);la.set(v.subarray(Z),z+R.length);v=la}}catch(ka){svGlobal.logger.info(ka)}}O=v;na&&console.log("corrupted: "+x.timestamp,x.bitstream);N&&y(N);B&&(E.pushRects({timestamp:x.timestamp,
rects:x.regionRects}),O&&(x.bitstream=O),A.type=L?"key":"delta",A.data=x.bitstream,A.timestamp=x.timestamp,A.duration=x.isChroma?77:1E3,x=new EncodedVideoChunk(A),K.decode(x))};this.play=function(x){};this.reset=function(){console.log("Reset MediaDecoder");B=w=null;E.close();K&&K.reset()&&K.close();K=null};this.close=function(){t.reset();K&&(K.close(),K=null)}}this.displayMsg=this.reconnectOnResize=!0;this.appTimeout=1600;this.reconnectTimes=0;this.windowState=3;this.setTitle=this.openLink=!0;this.sessionInfo=
{domain:"",userName:"",sessionId:0,joinedSessions:[],suppressOutput:!1,appInfo:null,joiners:[]};this.mode=0;this.remoteAppLogin=!0;var Ob=!1,ob={},mb={},Cb=null,m=this,Mb=!1,$a=!1,hb=0,Db=null,ad=0;hi5.appcfg||(hi5.appcfg={img:{},toolbar:{fadable:!0},displayMsg:!0});var ja=hi5.appcfg,Lb="";this.setConfig=function(a){ja=a};var gb="object"==typeof p?p:null,J=gb?{}:hi5.tool.queryToObj(p.substring(p.indexOf("?")+1));void 0==J.mapClipboard&&ja.clipboard&&void 0!=ja.clipboard.enabled&&(J.mapClipboard=ja.clipboard.enabled);
J.hardwareAcceleration||(J.hardwareAcceleration=ja.hardwareAcceleration);void 0==J.yuv444&&(J.yuv444=ja.yuv444);var Yd=void 0!=J.playSound?parseInt(J.playSound):1;void 0==ja.enableDVCAudio&&(ja.enableDVCAudio=!0);J.avgBytesPerSec||(J.avgBytesPerSec=ja.avgBytesPerSec);var Zd=void 0!=J.avgBytesPerSec?parseInt(J.avgBytesPerSec):12E3,Ma=0,Na=0,jb=(oa||J.color||J.server_bpp||16)|0,rc=null,bd=null,Sa=null,vc=null,cd="/DOWNLOAD?",dd="/CLIP?";24==jb&&(jb=16);var Za="app"==J.startProgram,Nb=U(J.mapDisk),qb=
0;this.setLinks=function(a){a.download&&(cd=a.download);a.clipboard&&(dd=a.clipboard)};this.protocol=gb?"":p.substring(0,p.indexOf("://")).toLowerCase();this.hasSmartCard=function(){return U(J.smartCard)||U(J.mapSmartCard)||U(J.passwordIsPin)};this.enableWebAuthn=function(){return U(J.enableWebAuthn)||U(J.useWebAuthn)};this.hasScanner=function(){return U(J.scanner)};this.hasUSB=function(){return U(J.mapUSB)&&!!navigator.usb};this.getUSB=function(){return J.usb||hi5.appcfg.usb||{filters:[{classCode:0},
{classCode:2},{classCode:5},{classCode:6},{classCode:10},{classCode:13},{classCode:239},{classCode:220},{classCode:239},{classCode:254},{classCode:255}]}};this.setProfiler=function(a){bd=a};this.getProfiler=function(){return bd};this.gateway=function(){if(gb)return"";var a=p.lastIndexOf("/RDP?");-1==a&&(a=p.lastIndexOf("/JOIN?"));-1==a&&(a=p.lastIndexOf("/PLAY?"));return p.substring(0,a).replace(/wss:\/\//ig,"https://").replace(/ws:\/\//ig,"http://")}();svGlobal.logger.warn("Ver:"+svGlobal.version+
" build:"+svGlobal.build);this.getGatewayAddr=Aa;var nb="object"==typeof p||0<p.indexOf("/PLAY?"),wc=!nb&&0<p.indexOf("invitation=");if(wc){var xc=decodeURIComponent(p),Sb=xc.indexOf(' USERNAME="');if(0<Sb){Sb+=11;var $d=xc.substring(Sb,xc.indexOf('"',Sb));p+="&novice="+$d}p+="&mapClipboard=on";J.mapClipboard="on";this.reconnectOnResize=!1}if(nb)this.mode=1,gb?p="":(Ma=640,Na=480),p+="&touchpad=on",J.touchpad="on",this.reconnectOnResize=!1;else if(0<p.indexOf("/JOIN?")||wc)this.mode=2,this.reconnectOnResize=
!1;var yc=U(J.gfx)||U(J.remotefx)||0<m.mode;yc&&(Za||wc?(yc=!1,J.remotefx=!1):jb=32);I?Ma=parseInt(I):J.width&&(Ma=parseInt(J.width));Y?Na=parseInt(Y):J.height&&(Na=parseInt(J.height));-1==Ma&&(Ma=hi5.browser.getScreenWidth());-1==Na&&(Na=hi5.browser.getScreenHeight());J.symlink&&J.parameters&&hi5.tool.queryToObj(J.parameters,J);J.gateway||(p+="&gateway="+encodeURIComponent(m.gateway));!J.minWidth&&ja.minWidth&&(J.minWidth=ja.minWidth);!J.minHeight&&ja.minHeight&&(J.minHeight=ja.minHeight);J.minWidth&&
(J.minWidth=parseInt(J.minWidth));J.minHeight&&(J.minHeight=parseInt(J.minHeight));J.waWidth=J.waWidth?parseInt(J.waWidth):hi5.browser.isAndroid||hi5.browser.isiOS?Math.max(screen.width,screen.height):screen.width;J.waWidth&=-4;J.waHeight=J.waHeight?parseInt(J.waHeight):hi5.browser.isAndroid||hi5.browser.isiOS?Math.max(screen.width,screen.height):screen.height;J.waHeight&=-4;"useSSL"in J||(p+="&useSSL="+("wss"==m.protocol));hi5.storage.isAvailable&&(U(J.shareClipboard)||J.shareClipboardId)&&(p+="&shareClipboardId="+
(J.shareClipboardId||ea()));ja&&(void 0!=ja.displayMsg?this.displayMsg=ja.displayMsg:ja.displayMsg=this.displayMsg,ja.appTimeout&&(this.appTimeout=ja.appTimeout),void 0!=ja.reconnectOnResize&&(this.reconnectOnResize=ja.reconnectOnResize),ja.reconnectTimes&&(this.reconnectTimes=ja.reconnectTimes),void 0!=ja.windowState&&(this.windowState=ja.windowState),void 0!=ja.openLink&&(this.openLink=ja.openLink),void 0!=ja.setTitle&&(this.setTitle=ja.setTitle),"boolean"==typeof ja.useWSS&&(p=(ja.useWSS?"wss":
"ws")+p.substring(p.indexOf("://"))),"boolean"==typeof ja.remoteAppLogin&&(this.remoteAppLogin=ja.remoteAppLogin,Ob=!ja.remoteAppLogin,svGlobal.logger.warn("remoteAppLogin deprecated, use hideLogin in appcfg.js instead")),"boolean"==typeof ja.hideLogin&&(Ob=ja.hideLogin),void 0!=ja.localPrinter&&void 0==J.localPrinter&&(J.localPrinter=ja.localPrinter));var Pa=null;void 0==ja.useWorker&&(ja.useWorker=!1);ja.useWorker&&(!window.Worker||hi5.browser.isFirefox||Za&&!hi5.browser.isIE||"file:"==location.protocol||
0<navigator.userAgent.indexOf("MSIE 10."))&&(ja.useWorker=!1);void 0==hi5.libMin&&(hi5.libMin=!0);var Oa=ja.useWorker?new Worker(xa("rdpworker",hi5.libMin?"rdpworker_min.js":"rdpworker.js")):null,xb=this.reconnectTimes,fc=Oa?{type:5,data:null}:null;this.getDisplayName=ha;this.server=ha();this.port=parseInt(J.port,10);this.loadbalanceToken="";ja.loadbalanceTokenName&&(J[ja.loadbalanceTokenName]?ma(J[ja.loadbalanceTokenName]):!1!==ja.randomAppId?ma(hi5.tool.uuid()):svGlobal.logger.info("Using app.id as loadbalanceToken"));
this.modifyURL=function(a){m.loadbalanceToken&&(a+=-1==a.indexOf("?")?"?"+m.loadbalanceToken:"&"+m.loadbalanceToken,a+="&loadbalanceTokenName="+ja.loadbalanceTokenName);return a};this.getURL=function(){return p};this.getRuntimeURL=function(){var a=p+"&width="+Ma+"&height="+Na+"&server_bpp="+jb+"&audio="+(Va.available||hi5.browser.isIE),b=Kc(),d="";b&&(d=sessionStorage[b]||"")&&(d="&preSymJoin="+d);a+=d;var g=J.monitorDef,c=J.monitor,e=0;b=ia.size();var f=Array(b);d=Array(b);var y=0,w=0,t=0,K=0,B=
0,A=0,E="";if(g){d=va.parseMonitorDef(g);for(b=d.length;e<b;e++){var x=d[e];x[0]<t&&(t=x[0]);x[1]<K&&(K=x[1]);x[2]>B&&(B=x[2]);x[3]>A&&(A=x[3])}0>t&&(y=-t);0>K&&(w=-K);x=0>c?[t,K,B,A]:d[c];J.width=x[2]-x[0]+1;J.height=x[3]-x[1]+1;e=ia.getSurface(0);e.setMonitor(x[0],x[1],x[2],x[3]);if(y||w)for(x=e.getMousePosition(),x.left+=y,x.right+=y,x.top+=w,x.bottom+=w,e=0;e<b;e++)x=d[e],x[0]+=y,x[1]+=w,x[2]+=y,x[3]+=w;va.setMonitorLayout(d);0>c&&va.setMonitorCount(0);m.reconnectOnResize=!1;b="&monitorDef="+
g+"&width="+J.width+"&height="+J.height}else{if(1<b&&!Za){for(ia.verifyMonitors();e<b;e++)g=ia.getSurface(e),x=g.getMousePosition(),x.left<t&&(t=x.left),x.top<K&&(K=x.top),x.right>B&&(B=x.right),x.bottom>A&&(A=x.bottom),f[e]=x,E&&(E+=","),E+=x.left+":"+x.top+":"+x.right+":"+x.bottom;0>t&&(y=-t);0>K&&(w=-K);for(e=0;e<b;e++){x=ia.getSurface(e).getMousePosition();if(y||w)x.left+=y,x.right+=y,x.top+=w,x.bottom+=w;d[e]=[x.left,x.top,x.right,x.bottom,x.left==y&&x.top==w?1:0]}va.setMonitorLayout(d);m.reconnectOnResize=
!1}E&&(svGlobal.logger.warn("MonitorDef:"+E),J.width=B-t+1,J.height=A-K+1,E="&monitorDef="+E+"&width="+J.width+"&height="+J.height);b=E}a+=b;0>p.indexOf("waWidth")&&(b=(b=ia.getFocused())?b.getWindow():window,a+="&waWidth="+J.waWidth+"&waHeight="+J.waHeight+"&dpWidth="+b.innerWidth+"&dpHeight="+b.innerHeight);b=new Date;J.tzOffset||(a+="&tzOffset="+b.getTimezoneOffset());J.timezone||(d=hi5.timezone.getTimeZone())&&(a+="&timezone="+encodeURIComponent(d.standardName));a+="&time="+b.getTime();J.soundPref=
void 0==J.soundPref?0:parseInt(J.soundPref,10);a+="&soundPref="+J.soundPref;y=d=b="";for(y in ob)w=ob[y],"flags"in w&&(b&&(b+=",",d+=","),b+=w.name,d+=w.flags);b&&(a=a+("&channelName="+b)+("&channelFlags="+d));b="";for(y in mb)w=mb[y],"flags"in w&&(b&&(b+=","),b+=w.name);b&&(a+="&gwChannelName="+b);if(d=Cd())b=d.account,d=d.session,b&&(a+="&account="+b),d&&(a+="&session="+d);b=hi5.browser.isTouch&&(1024<=window.innerWidth||768<=window.innerHeight);J.audioRecord=U(J.audioRecord)&&hi5.audio.recordable;
Ka.init(b,yc,J.audioRecord,J.soundPref,U(J.mapCamera)&&!!navigator.mediaDevices,U(J.mapUSB)&&!!navigator.usb);J.audioRecord&&(a+="&audioRecord=on");J.decompressingRDP61&&(a+="&decompressingRDP61=on");0<Ka.count&&(a+="&dvcChannels="+Ka.names.join(","));a+="&binary=on";ja.existingFile&&(a+="&existingFile="+ja.existingFile);a+="&isTouch="+b+"&gatewayAddr="+encodeURIComponent(Aa());a=m.modifyURL(a);ja.copyTextOnly&&U(J.mapClipboard)&&(a+="&copyTextOnly=on");(b=hi5.browser.cookie.get("__SV_TOKEN_A"))&&
(a+="&__SV_TOKEN_A="+encodeURIComponent(b));(b=svGlobal.Rdp.languageToKeyboard.detect())&&(a+="&_keyboard="+b);U(J.textPrinter)&&(a+="&printerDriver="+encodeURIComponent("Generic / Text Only"));return a+=Ld()};this.getColor=function(){return jb};this.changeTitle=sa;hi5.browser.isTouch&&Math.max(Ma,Na)>Math.max(window.innerWidth,window.innerHeight)&&(this.reconnectOnResize=!1);this.isRemoteApp=function(){return Za};var Ga=null,La=!1,tb=!1,sc=!1,Va=new function(){function a(t){g&&(e&&e.disconnect(),
f&&f.disconnect());hi5.audio.releaseAudioContext();t||(w&&(w.close(),w=null),y&&(y.pause(),y=null))}function b(){w.play(!0)}function d(t){console.error("play error: ",t);m.onuserinteract&&m.onuserinteract(b,"audio")||m.showMessage({msg:"Please click Yes to continue.<br>"+t,cbYes:function(){w.play(!0);this.destroy()},html:!0})}var g=null;this.supportWebAudio=this.available=!1;(0==Yd||1==m.mode)&&(g=hi5.audio.getAudioContext())&&hi5.audio.playable&&(this.supportWebAudio=this.available=!0);this.getContext=
function(){return g};this.getBuffer=function(t){return g.createBuffer(2,t,Ea.samplePerSec)};var c=0,e=null,f=null;this.setVolume=function(t){1==t?e=null:(e||(e=g.createGain()),e.gain.value=t)};this.playBuffer=function(t){f=g.createBufferSource();f.buffer=t;e?(f.connect(e),e.connect(g.destination)):f.connect(g.destination);var K=g.currentTime,B=0<c?c:K;B<K&&(B=K);c=B+t.duration;f.start?f.start(B):f.noteOn(B);return c-K};this.iOSFix=function(){if(g){var t=this.getBuffer(1024),K=g.createBufferSource();
K.buffer=t;K.connect(g.destination);K.start?K.start(0):K.noteOn(0)}};this.close=a;var y=null,w=null;this.onaudioframe=null;this.initMediaPlayer=function(t,K,B){a(!0);y||(y=document.createElement("audio"));w||(w=new Rb(y,t,!0),w.onplayerror=d,w.onerror=function(A){console.error("Not possible audio error",A)},svGlobal.logger.info("MediaPlayer init, headerless: "+B+" sampleRate:"+K.sampleRate));w.setMediaFormat(K,B);w.play(!1)}},Xc=Va.available;Xc||(ja.enableDVCAudio=!1);var db=null,va=new Ec(200,200);
va.onSetCursor=Pc;this.setVolume=function(a){Va&&Va.setVolume(a)};this.setAudioBuffer=function(a){};var cc=0,bc=0,dc=Ma-1,ec=Na-1,qc="";window.$rdp||(window.$rdp=this);Fa(jb);this.setResolution=Ra;this.running=function(){return La};this.setJoinMode=function(a){La&&ya("8E1"+a)};this.setJoinCloseMode=function(a){La&&ya("8EB3\t"+a)};this.refuseControl=function(a){La&&ya("8E3"+a)};this.giveControl=function(a){La&&ya("8E4"+a)};this.pauseSession=function(a,b){La&&ya("8EB"+(b?1:0)+"\t"+a)};this.closeSession=
function(a){La&&ya("8EB2\t"+a)};this.requestControl=function(){La&&ya("8E2")};this.saveSession=function(a){La&&ya("8E9"+(a.save?1:0)+"\t"+(a.timeout||0)+"\t"+(a.id||0))};this.allowJoin=function(a,b){La&&ya("8EA"+a+"\t"+(b?1:0))};var Eb=new function(){function a(){if(d&&0<d.length){var e=d.shift();e.key?Eb.sendSingleKey(e.down,e.key):e.char&&wb(e.char);0<d.length?setTimeout(a,g):(d=null,c&&c())}}var b={" ":57,space:57,pgup:201,pageup:201,pgdn:209,pagedown:209,end:207,home:199,left:203,up:200,right:205,
down:208,printscreen:183,insert:210,del:211,"delete":211,altgr:184,windows:219,windowsright:220,context:221,esc:1,backspace:14,back:14,tab:15,enter:28,meta:29,command:29,ctrl:29,shift:42,alt:56,capslock:58,f1:59,f2:60,f3:61,f4:62,f5:63,f6:64,f7:65,f8:66,f9:67,f10:68,f11:87,f12:88,numlock:69,scrolllock:70,add:78};this.sendSingleKey=function(e,f){var y=b[f.toLowerCase()];y?m.writeScancode(e,y):(y=f.length,0!=y&&(1==y?m.writeKeyCode(e,f.toUpperCase().charCodeAt(0)):e&&m.writeText(f)))};var d=null,g=
0,c=null;this.sendKeyComb=function(e,f,y){if($a){e=e.split("+");var w=e.length,t;if(0!=w){var K=null,B=[];for(t=0;t<w;t++){var A=e[t];""==A&&""==K&&(A="Add");""!=A&&B.push({key:A,down:!0});K=A}w=B.length;for(t=w-1;0<=t;t--)B.push({key:B[t].key,down:!1});if(f)d=B,g=f,c=y,a();else for(t=0,w=B.length;t<w;t++)Eb.sendSingleKey(B[t].down,B[t].key)}}};this.sendText=function(e,f,y){for(var w=[],t=0,K=e.length;t<K;t++)w.push({"char":e.charAt(t)});d=w;g=f;c=y;a()}};this.writeKeyComb=function(a,b,d){$a&&Eb.sendKeyComb(a,
b,d)};this.writeText=function(a,b,d){if($a)if(b)Eb.sendText(a,b,d);else for(b=0,d=a.length;b<d;b++)wb(a.charAt(b))};this.writeClipboard=function(a,b){a&&(b||(b="text/plain"),m.writeRawInput("880"+b+"\t"+a.hashCode()),Db={type:b,text:a})};var ia=new function(a,b){function d(){function c(B){for(;0<B.ownerWinid;){var A=t.getWinById(B.ownerWinid);if(A&&A.isVisible())B=A;else break}return B}function e(B){for(var A="";B;)B.titleInfo&&(A=B.titleInfo),B=t.getWinById(B.ownerWinid);return A}var f=[],y=[],w=
0,t=this;this.mainWin=null;this.appId="";var K=0;this.getActiveWinId=function(){return K};this.setActiveWinId=function(B,A){svGlobal.logger.info("setActiveWinId: "+B+" old: "+K+" max: "+A);if(K!=B){var E=0==K;K=B;(B=t.getMainByWinId(B))&&B.isMainWin()&&t.mainWin!=B&&(t.mainWin=B);E&&A&&(A=ia.getFocused())&&(A=A.getFreeSpace(),B=A.width,m.resetSize(B,A.height))}};this.onchange=function(B){B.isVisible()||B!=t.mainWin?B.isVisible()&&!t.mainWin&&B.isMainWin()&&(t.mainWin=B,3==a.windowState&&B.exeCommand(61488)):
t.mainWin=null};this.addWin=function(B){for(var A=f.length,E=!1,x=0;x<A;x++)if(B.id==f[x].id){f[x]=B;E=!0;break}E||f.push(B);1==f.length&&(w=Date.now());A=B.isMainWin();svGlobal.logger.info("is mainwin:"+A+" id:"+B.id);A&&!t.mainWin&&(t.mainWin=B)};this.popWins=function(B){B=t.getWinById(B);var A=[];if(B){B=0<B.ownerWinid?B.ownerWinid:B.id;for(var E=f.length-1;0<=E;E--)if(f[E].ownerWinid==B||f[E].id==B)A.push(f[E]),f.splice(E,1)}return A};this.hasApp=function(B){return-1!=y.indexOf(B)};this.addApp=
function(B){return-1==y.indexOf(B)?(y.push(B),!0):!1};this.isNew=function(){return 3E4>Date.now()-w};this.getAll=function(){return f};this.hasWin=function(B){return 0<=f.indexOf(B)};this.close=function(){for(var B=0,A=f.length;B<A;B++)f[B].close()};this.clear=function(){f.length=0};this.delWin=function(B){for(var A=0,E=f.length;A<E;A++)if(f[A].id==B)return f.splice(A,1),A;return-1};this.isRunning=function(){var B=f.length;if(1>B)return!1;var A=0;for(B=f.length;A<B;A++){var E=f[A];if(E.showState)return!0}return!1};
this.getWinById=function(B){var A=f.length;if(1>A)return null;for(var E=0;E<A;E++){var x=f[E];if(x.id==B)return x}return null};this.getMainWinByAppId=function(B){var A=null,E=0;for(len=f.length;E<len;){A=f[E];if(A.appId==B&&A.isVisible()&&1>A.ownerWinid)break;E++}return A};this.getTopWin=function(B){var A=null,E,x=B.length;for(E=0;E<x&&(!(A=t.getWinById(B[E]))||!A.isVisible());E++)A=null;if(!A)for(svGlobal.logger.warn("No win found"),x=f.length,E=x-1;0<=E&&(A=f[E],!A.isVisible());E--)A=null;return A};
this.getMain=function(B){return(B=t.getTopWin(B))?c(B):null};this.getMainByWinId=function(B){return(B=t.getWinById(B))?c(B):null};this.getOtherApps=function(B,A,E){var x=f.length;if(0!=x&&f[x-1])if(x=f[x-1].appId,E||!x)setTimeout(function(){t.getOtherApps(B,A)},E||3E3);else{E=[];if(x=t.getTopWin(B)){var O=0<x.ownerWinid?x.ownerWinid:x.id,v=[],ba=0;for(x=f.length;ba<x;ba++)f[ba].ownerWinid!=O&&f[ba].id!=O&&f[ba].isVisible()&&v.push(f[ba]);ba=0;for(x=v.length;ba<x;ba++)v[ba].ownerWinid!=O&&v[ba].id!=
O&&(E.push({title:e(v[ba]),win:c(v[ba])}),O=0<v[ba].ownerWinid?v[ba].ownerWinid:v[ba].id)}A(E)}};this.getFullTitle=function(B){for(var A,E="";;){A=t.getWinById(B);if(!A)break;A.titleInfo&&A.isVisible()&&(E&&(E=" > "+E),E=A.titleInfo+E);if(1>B)break;B=A.ownerWinid}return E}}var g=[];this.tryCloseRemoteApps=function(){if(a&&a.isRemoteApp())for(var c=g.length,e=0;e<c;e++)g[e].railWin&&g[e].railWin.close()};this.verifyMonitors=function(){for(var c=g.length,e=Array(c),f=0;f<c;f++)g[f].configMonitor(),
e[f]=g[f].getMousePosition();e.sort(function(t,K){var B=t.left-K.left;return 0!=B?B:t.top-K.top});var y=e.findIndex(function(t){return 0==t.left&&0==t.top});svGlobal.logger.info("monitor layout",e,y);-1==y&&(m.showMessage("* Primary monitor not found. Please make your browser window full screen."),svGlobal.logger.warn("Primary monitor not found (left=top=0)",e));for(f=y-1;0<=f;){if(e[f].right<e[f+1].left){var w=e[f+1].left-e[f].right-1;0<w&&(e[f].right+=w,e[f].left+=w)}e[f].bottom<e[f+1].top&&(w=
e[f+1].top-e[f].bottom-1,0<w&&(e[f].top+=w,e[f].bottom+=w));f--}for(f=y+1;f<c;)e[f-1].right<e[f].left&&(w=e[f].left-e[f-1].right-1,0<w&&(e[f].right-=w,e[f].left-=w)),e[f-1].bottom<e[f].top&&(w=e[f].top-e[f-1].bottom-1,0<w&&(e[f].top-=w,e[f].bottom-=w)),f++};this.repaint=function(c,e,f,y){for(var w=0,t=g.length;w<t;w++)g[w].repaint(c,e,f,y)};this.size=function(){return g.length};this.getSurface=function(c){return g[c]};this.addSurface=function(c){g.push(c)};this.hasSurface=function(c){for(var e=g.length,
f=0;f<e;f++)if(g[f].equals(c))return!0;return!1};this.getMonitorSurface=function(c,e,f,y){var w=g.length;if(1==w)return g[0];for(var t=0;t<w;t++)if(g[t].isMonitor(c,e,f,y))return g[t];return null};this.fromSyncedSurface=function(c){var e=g.length;Date.now();for(var f=0;f<e;f++)if(g[f].isClipSynced(c))return!0;return!1};this.setSize=function(c,e,f){for(var y=0,w=g.length;y<w;y++)g[y].setSize(c,e,f)};this.zOrders=[];this.drawLicense=function(c){for(var e=0,f=g.length;e<f;e++)g[e].drawLicense(c)};this.setReadOnly=
function(c,e){for(var f=0,y=g.length;f<y;f++)g[f].setReadOnly(c,e)};this.setVisible=function(c,e){svGlobal.logger.info("TODO: setVisible")};this.setCursor=function(c){for(var e=0,f=g.length;e<f;e++)g[e]&&g[e].setCursor(c)};this.hide=function(c){c=0;for(var e=g.length;c<e;c++)g[c]&&g[c].hide()};this.execute=function(c,e){for(var f=0,y=g.length;f<y;f++)g[f][c].apply(g[f],e)};this.addWin=function(c){var e=this.getFocused();e||(svGlobal.logger.warn("Focused surface not found!"),e=g[g.length-1]);e?(Za=
!0,e.railWin||(e.railWin=new d,e.onunload=function(){hi5.appcfg.closeRemoteApp&&e.railWin&&e.railWin.close();e.remoteApp&&e.remoteApp.close();e.railWin&&(e.railWin.clear(),e.railWin=null);g.removeElm(e)}),e.context&&b.setContext(e.context),e.railWin.addWin(c),e.railWin.mainWin==c&&(setTimeout(function(){var f=e.getFreeSpace();a.writeRawInput("8C661441\t"+f.width+"\t"+f.height);svGlobal.logger.info("-- main win dp change:"+f.height);3==a.windowState?c.resizable()&&setTimeout(function(){c.exeCommand(61488);
svGlobal.logger.info("-- max")},50):5==a.windowState&&3==c.showState&&setTimeout(function(){c.exeCommand(3856);svGlobal.logger.info("-- restor")},50)},111),Ta.sendKeyboardSyncFlags(Ta.localLockFlags,500)),hi5.browser.isIE&&e.focus()):svGlobal.logger.warn("No surface available!")};this.delWin=function(c){for(var e,f=g.length-1;0<=f;f--){var y=g[f];e=y.railWin;var w=e.getWinById(c),t=w&&w.appId&&-1!=w.appId.toLowerCase().indexOf("runonce");if(0<=e.delWin(c)){w==e.mainWin&&(e.mainWin=null);if(y.toolbar){c=
"win"+c;var K=y.toolbar.querySelector("#"+c);K&&y.toolbar.removeChild(K)}if(!e.isRunning()&&0==m.mode){if(w.isMainWin()&&y.onremoteappclose)y.onremoteappclose(w);w=a.appTimeout;if(t||e.isNew())w*=10;svGlobal.logger.debug("Prepare del:"+Date.now());setTimeout(function(B){return function(){svGlobal.logger.info("Start del:"+Date.now());B.railWin&&B.railWin.isRunning()||(B.remoteApp&&B.remoteApp.close(),ia&&ia.delSurface(B))}}(y),w)}}}};this.popWins=function(c){return g[0]&&g[0].railWin?g[0].railWin.popWins(c):
[]};this.getWinById=function(c){for(var e,f=0,y=g.length;f<y;f++)if(g[f]&&g[f].railWin&&(e=g[f].railWin.getWinById(c)))return e;return null};this.getMainWinByAppId=function(c){for(var e,f=0,y=g.length;f<y;f++)if(g[f].railWin&&(e=g[f].railWin.getMainWinByAppId(c)))return e;return null};this.onWinChange=function(c){for(var e,f=0,y=g.length;f<y;f++)if(g[f].railWin&&(e=g[f].railWin.getWinById(c.id)))g[f].railWin.onchange(c)};this.setTitle=function(c){for(var e,f=0,y=g.length;f<y;f++)if(g[f].railWin){e=
g[f].railWin.getWinById(c);var w=g[f].railWin.getFullTitle(c);if(w){a.changeTitle(w,g[f].getWindow(),e.appId);break}}};this.hasApp=function(c){for(var e=0,f=g.length;e<f;e++)if(g[e].railWin.hasApp(c))return!0;return!1};this.delSurface=function(c){!c||c.railWin&&c.railWin.isRunning()||(svGlobal.logger.info("delete surface..."),g.removeElm(c),c.close(),0==g.length&&a._unload())};this.getOwnerSurface=function(c){for(var e=0,f=g.length;e<f;e++)if(g[e].railWin&&g[e].railWin.hasWin(c))return g[e];return null};
this.getOwnerSurfaceById=function(c){for(var e,f=0,y=g.length;f<y;f++)if(g[f].railWin&&(e=g[f].railWin.getWinById(c)))return g[f];return null};this.getFocused=function(){for(var c=g.length,e=0;e<c;e++)if(g[e].focused)return g[e];return g[c-1]};this.close=function(){for(var c=0,e=g.length;c<e;c++)g[c]&&(g[c].remoteApp&&g[c].remoteApp.close(),g[c].close(),g[c]=null)};this.LocalWin=function(c){function e(){a.writeRawInput("8C0"+c)}this.id=c;this.appId="";var f=this;this.resizable=function(){return f.isVisible?
0!=(f.style&262144)||0!=(f.style&65536)||0!=(f.style&16777216)||3==f.showState:!1};this.setShowState=function(y){f.showState=y};this.parent=function(){return ia.getWinById(f.ownerWinid)};this.resize=function(y,w,t,K){svGlobal.logger.info("www resize, l "+y+" w "+t);hi5.appcfg.disableJoinedAppResize&&2==a.mode||a.writeRawInput("8C1"+f.id+"\t"+y+"\t"+w+"\t"+t+"\t"+K)};this.exeCommand=function(y){svGlobal.logger.info("www exeCommand, cmd "+y);a.writeRawInput("8C4"+c+"\t"+y)};this.activate=function(y){svGlobal.logger.info("www activate, enable "+
y+" id:"+c);2==f.showState?(f.exeCommand(61728),setTimeout(function(){a.writeRawInput("8C3"+c+"\t"+y)},50)):a.writeRawInput("8C3"+c+"\t"+y)};this.close=function(){svGlobal.logger.info("www close");f.exeCommand(61536)};this.getAppId=e;this.isVisible=function(){return f.winWidth&&f.winHeight&&f.showState&&45<f.winHeight&&45<f.winWidth};this.isMainWin=function(){if(!(f.isVisible()&&f.winWidth&&f.winHeight&&45<f.winHeight&&45<f.winWidth))return!1;var y=1>f.ownerWinid;if(!y)return y;var w=f.style;if(0!=
(w&4194304))return!0;if(0!=(w&2147483648)&&(0==(w&8388608)||0==(w&12582912)))return!1;var t=0!=(f.extStyle&128);(y=y&&!t)&&0!=(w&2147483648)&&0==(w&2156396544)&&(y=!1);return y};e()}}(m,va);this.getSurfaces=function(){return ia};this.hide=function(){ia&&ia.hide()};this.getFileUrl=function(a,b,d){var g=Aa(),c=cd,e=c.indexOf("://");g=(0<e&&11>e?c:g+c)+"s="+qc+"&f="+encodeURIComponent(a);b&&(g+="&src="+b);d&&(g+="&action="+d);return m.modifyURL(g)};this.listFiles=function(a,b){Pa&&$a&&Pa.list(a,b)};
this.writeRawInput=function(a){if($a){ya(a);if(m.onactivity)m.onactivity(a);return!0}return!1};this.authWithCode=function(a,b){var d=a.length,g=new Uint8Array(5+d);g[0]=146;g[1]=7;g[2]=b;g[3]=d&255;g[4]=d>>8&255;for(b=0;b<d;b++)g[5+b]=a.charCodeAt(b);ya(g.buffer)};var ed=0;if(ja.numLock||ja.numlock||U(J.numLock)||hi5.browser.isMacOS||hi5.browser.isiOS||hi5.browser.isCrOS)ed|=2;var Ta=new function(a,b){this.setJoinMode=a.setJoinMode;this.requestControl=a.requestControl;this.writeKeyComb=a.writeKeyComb;
this.writeText=a.writeText;this.localLockFlags=b||0;this.remoteLockFlags=0;this.checkLockFlags=!0;this.reqCopyTime=0;a.isRemoteApp();var d=void 0,g=a.getSurfaces();this.saveResize=function(c){d=a.reconnectOnResize;a.reconnectOnResize=c};this.restoreResize=function(){void 0!=d&&(a.reconnectOnResize=d)};this.getAppMode=function(){return a.mode};this.getAgentStatus=function(){return a.getAgentStatus()};this.send=a.writeRawInput;this.saveSession=function(c){a.saveSession(c)};this.sendInput=a.writeRawInput;
this.getAppInfo=function(){return a.sessionInfo.appInfo};this.resumePlay=function(){Va.supportWebAudio&&Va.iOSFix()};this.onresize=function(c){if((c=c.target.svSurface)&&!document.hidden){var e=c.getFreeSpace(),f=e.width;e=e.height;Ta.checkLockFlags=!0;ja.scale?c.scaleTo(f,e,!1):a.resetSize(f,e)}};this.onorientationchange=function(c){a.resetSize(c.innerWidth,c.innerHeight)};this.getClipData=function(c,e){this.reqCopyTime=Date.now();var f=a.getGatewayAddr(),y=dd,w=y.indexOf("://");f=(0<w&&11>w?y:f+
y)+"s="+a.sessionInfo.appInfo.session+"&t="+Date.now()+"&type="+c;c=hi5.httpGet(a.modifyURL(f),e);this.reqCopyTime=Date.now();Yc(c);return c};this.getShareFiles=a.listFiles;this.getFile=function(c,e,f){a.reconnectOnResize=!1;var y=a.getFileUrl(c,e,f);m.ondownload&&m.ondownload({fileName:c,url:y,source:e,action:f})||window.open(y)};this.getFileLink=a.getFileUrl;this.getGateway=function(){return p};this.reconnect=function(c,e,f){J.symlink?(c="user="+c+"&pwd="+e,f&&(c+="&domain="+f),p=hi5.tool.replaceQuery(p,
"parameters",c)):(p=hi5.tool.replaceQuery(p,"user",c),p=hi5.tool.replaceQuery(p,"pwd",e),p=hi5.tool.replaceQuery(p,"domain",f));a.run()};this.sendKeyboardSyncFlags=function(c,e){return $a?(this.remoteLockFlags=this.localLockFlags=c,setTimeout(function(){a.writeRawInput("8E5"+c)},e||333),!0):!1};this.sendKeyboardSynchronize=function(c,e,f){var y=0;f&&(y|=4);e&&(y|=2);c&&(y|=1);this.sendKeyboardSyncFlags(y)};this.fromSyncedSurface=function(c){return g.fromSyncedSurface(c)};this.setWorkDir=function(c){a.writeKeyComb("Windows+R",
20,function(){setTimeout(function(){a.writeText(c,10,function(){a.writeScancode(!0,28);a.writeScancode(!1,28)})},666)})};this.authWithCode=function(c,e){a.authWithCode(c,e)};this.getPrinters=function(c){a.getPrinters(c)};this.attachPrinter=function(c){a.attachPrinter(c)};this.attachDirectory=function(c){a.attachDirectory(c)}}(m,ed),ae=new function(a,b){this.draw=a.draw;this.refresh=function(d,g,c,e){return a.repaint(d,g,c-d+1,e-g+1)};this.onfocus=function(d){var g=b.getFocused();Za&&g&&g.railWin&&
(d=g.railWin.mainWin)&&_core.running()&&(g=g.context)&&g!=a.getContext()&&(a.setContext(null),d.activate(1),svGlobal.logger.info("Activate win:"+d.id))}}(va,ia);this.sendKeyboardSynchronize=function(a,b,d){Ta.sendKeyboardSynchronize(a,b,d)};this.VirtualChannel=function(){return new sb(143)};this.GatewayChannel=function(){return new sb(28)};this.DynamicChannel=function(){return new sb(64)};this.addChannel=function(a){ob[a.name]=a};this.addGatewayChannel=function(a){mb[a.name]=a};this.addDynamicChannel=
function(a){Ka.names.push(a.name);Ka[a.name]=a;Ka.count++};var Qa=null,Ka={count:0,names:[],usbChannel:null,close:function(){for(var a=Ka.names,b=0,d=a.length;b<d;b++){var g=Ka[a[b]];if(g&&g.onclose)g.onclose()}a.length=0;Ka.usbChannel=null},init:function(a,b,d,g,c,e){function f(){this.WAVE_FORMAT_PCM=1;this.WAVE_FORMAT_ADPCM=2;this.WAVE_FORMAT_ALAW=6;this.WAVE_FORMAT_MULAW=7;this.WAVE_FORMAT_GSM=49;this.WAVE_FORMAT_MPEGLAYER3=85;this.WAVE_FORMAT_AAC=41222;this.cbSize=this.bitsPerSample=this.nBlockAlign=
this.nAvgBytesPerSec=this.nSamplesPerSec=this.nChannels=this.formatTag=0;this.extenstion=null;var E=this;this.fromBuffer=function(x,O){E.formatTag=x.getLittleEndian16();E.nChannels=x.getLittleEndian16();E.nSamplesPerSec=x.getLittleEndian32();E.nAvgBytesPerSec=x.getLittleEndian32();E.nBlockAlign=x.getLittleEndian16();E.bitsPerSample=x.getLittleEndian16();var v=x.getLittleEndian16();E.cbSize=v;0<v&&!0!==O&&(E.extenstion=Array(v),x.copyToByteArray(E.extenstion,0,x.getPosition(),v),x.skipPosition(v))};
this.toBuffer=function(x){x.setLittleEndian16(E.formatTag);x.setLittleEndian16(E.nChannels);x.setLittleEndian32(E.nSamplesPerSec);x.setLittleEndian32(E.nAvgBytesPerSec);x.setLittleEndian16(E.nBlockAlign);x.setLittleEndian16(E.bitsPerSample);x.setLittleEndian16(E.cbSize);0<E.cbSize&&x.setBytes(E.extenstion)};this.getSize=function(){return 18+E.cbSize};this.toString=function(){return"Audio Format, tag="+E.formatTag+" nChannels="+E.nChannels+" nSamplesPerSec="+E.nSamplesPerSec+" nAvgBytesPerSec="+E.nAvgBytesPerSec+
" nBlockAlign="+E.nBlockAlign+" bitsPerSample="+E.bitsPerSample+" cbSize="+E.cbSize}}function y(){Qa=new m.DynamicChannel;Qa.name="Microsoft::Windows::RDS::DisplayControl";Qa.enabled=!1;Qa.process=function(E){var x=E.getLittleEndian32();E.getLittleEndian32();switch(x){case 5:x=E.getLittleEndian32(),Qa.maxMonitorAreaFactorA=E.getLittleEndian32(),Qa.maxMonitorAreaFactorB=E.getLittleEndian32(),Qa.enabled=!0,svGlobal.logger.warn("Display control maxNumMonitors:"+x+" factorA:"+Qa.maxMonitorAreaFactorA+
" factorB:"+Qa.maxMonitorAreaFactorB),E=new Uint8Array(2),E[0]=146,E[1]=4,ya(E.buffer),Sa&&setTimeout(function(){Sa&&Sa.check(5E3)},1900)}};Qa.applyResolution=function(E,x){if(Qa.enabled){var O=new Uint8Array(56),v=new RdpBuffer(O,0,56);E=E>Qa.maxMonitorAreaFactorA?Qa.maxMonitorAreaFactorA:E&-4;x=x>Qa.maxMonitorAreaFactorB?Qa.maxMonitorAreaFactorB:x&-4;v.setLittleEndian32(2);v.setLittleEndian32(56);v.setLittleEndian32(40);v.setLittleEndian32(1);v.setLittleEndian32(1);v.setLittleEndian32(0);v.setLittleEndian32(0);
v.setLittleEndian32(E);v.setLittleEndian32(x);v.setLittleEndian32(.26458*E|0);v.setLittleEndian32(.26458*x|0);v.setLittleEndian32(E>x?0:90);v.setLittleEndian32(100);v.setLittleEndian32(100);Qa.send(O);svGlobal.logger.warn("Display control: "+E+"x"+x)}else svGlobal.logger.warn("Display control disabled.")};return Qa}if(!ja.disableDVC){if(ja.enableEcho){var w=new m.DynamicChannel;w.name="ECHO";w.process=function(E){var x=E.getPosition(),O=E.getEnd(),v=new Uint8Array(O-x);v.set(E.getData().subarray(x,
O));w.send(v)};m.addDynamicChannel(w)}if(a){var t=new m.DynamicChannel;t.name="Microsoft::Windows::RDS::Input";t.process=function(E){var x=E.getLittleEndian16();E.getLittleEndian32();switch(x){case 1:E.skipPosition(4),E=new RdpBuffer(new Uint8Array(16),0,16),E.setLittleEndian16(2),E.setLittleEndian32(16),E.setLittleEndian32(3),E.setLittleEndian32(65536),E.setLittleEndian16(256),E.markEnd(),t.send(E);case 5:ia.execute("setTouchRemoting",[!0]);Ka.isTouchReady=!0;svGlobal.logger.info("Touch remoting start");
break;case 4:ia.execute("setTouchRemoting",[!1]),Ka.isTouchReady=!1,svGlobal.logger.info("Touch remoting suspend")}};m.addDynamicChannel(t)}if(d){svGlobal.logger.warn("Audio input on");var K=new m.DynamicChannel;(function(){function E(T){var z=new RdpBuffer(new Uint8Array(5),0,5);z.setByte(7);z.setLittleEndian32(T);z.markEnd();K.send(z)}function x(T){var z=T.getLittleEndian32(),Z=T.getLittleEndian32(),W=new f;W.fromBuffer(T,!0);var M=0,fa=0;0<W.cbSize&&(22==W.cbSize?(M=T.getLittleEndian16(),fa=T.getLittleEndian32(),
T.skipPosition(16)):(svGlobal.logger.warn("Wrong cbsize: "+W.cbSize),T.skipPosition(W.cbSize)));T=v[Z];svGlobal.logger.info("Selceted rec fmt, framesPerPacket: "+z+" initial: "+Z+", "+T.toString());svGlobal.logger.info("Open fmt: "+W.toString()+" validBits:"+M+" mask:"+fa);P=!0;L=m.reconnectOnResize;m.reconnectOnResize=!1;ta.onopen||(ta.onopen=function(X){if(La){O=X;m.reconnectOnResize=L;E(Z);var R=new RdpBuffer(new Uint8Array(5),0,5);R.setByte(4);R.setLittleEndian32(X?0:1);R.markEnd();K.send(R)}});
ta.ondata||(ta.ondata=function(X,R){O&&(N.length!=R+1&&(N=new Uint8Array(R+1),N[0]=6),K.send(ba),N.set(X,1),K.send(N))});ta.start(T,z)}K.name="AUDIO_INPUT";K.process=function(T){var z=T.getByte();switch(z){case 1:T=T.getLittleEndian32();z=new RdpBuffer(new Uint8Array(5),0,5);z.setByte(1);z.setLittleEndian32(T);z.markEnd();K.send(z);break;case 2:var Z=T.getLittleEndian32();T.getLittleEndian32();var W=hi5.audio.getAudioContext().sampleRate;for(z=v.length=0;z<Z;z++){var M=new f;M.fromBuffer(T);svGlobal.logger.info("Server rec fmt "+
z+":"+M.toString());0==g&&49==M.formatTag&&22050==M.nSamplesPerSec?v.push(M):1==M.formatTag&&M.nSamplesPerSec<=W&&v.push(M)}K.send(ba);Z=0;T=v.length;for(z=0;z<T;z++)Z+=v[z].getSize();W=new RdpBuffer(new Uint8Array(1024),0,1024);W.setByte(2);W.setLittleEndian32(T);W.setLittleEndian32(Z+9);for(z=0;z<T;z++)v[z].toBuffer(W),svGlobal.logger.info("Client rec fmt: "+v[z].toString());W.skipPosition(1024-Z-9);W.markEnd();K.send(W);break;case 3:x(T);break;case 7:z=T.getLittleEndian32();svGlobal.logger.info("Rec fmt change, "+
v[z].toString()+" by client:"+P);P||(E(z),P=!1);break;default:svGlobal.logger.warn("audioInput: invalid tag:"+z)}};var O=!1,v=[];K.onclose=function(){O=!1;ta&&ta.close()};var ba=new Uint8Array(1);ba[0]=5;var P=!1,L=m.reconnectOnResize,N=new Uint8Array(0),na=xa("audiorecorder",hi5.libMin?"audiorecorder_min.js?v=0":"audiorecorder.js?v=0"),ta=window.AudioWorkletNode?new hi5.audio.WorkletRecorder(hi5.audio.getAudioContext(),na):new hi5.audio.Recorder(hi5.audio.getAudioContext())})();m.addDynamicChannel(K)}m.addDynamicChannel(function(){var E=
new m.DynamicChannel;E.name="TSMF";var x={type:"image/jpeg"},O=Array(1);E.process=function(v){v.getPosition();var ba=v.getLittleEndian32()&1073741823;var P=v.getLittleEndian32();var L=v.getLittleEndian32();switch(ba){case 2:if(256==L){v.getLittleEndian32();L=new Uint8Array(16);var N=new RdpBuffer(L,0,16);N.setLittleEndian32(2);N.setLittleEndian32(P);N.setLittleEndian32(1);N.setLittleEndian32(0);E.send(L)}break;case 0:switch(L){case 257:v.getBytes(16);v.getLittleEndian32();break;case 256:ba=v.getPosition();
N=v.getLittleEndian32();for(L=0;L<N;L++){v.getLittleEndian32();var na=v.getLittleEndian32();v.getLittleEndian32();v.skipPosition(na-4)}L=v.getPosition()-ba;N=L+8+4;L=new Uint8Array(N);N=new RdpBuffer(L,0,N);N.setLittleEndian32(-2147483648);N.setLittleEndian32(P);L.set(v.getData().subarray(ba,v.getPosition()),8);E.send(L);break;case 261:v.getBytes(16);v.getLittleEndian32();break;case 264:ba=v.getLittleEndian32();v.skipPosition(4);v.getLittleEndian32();na=v.getBytes(16);var ta=v.getBytes(16);v.getLittleEndian32();
v.getLittleEndian32();v.getLittleEndian32();var T=v.getBytes(16);L=v.getLittleEndian32();v.skipPosition(L);L=new Uint8Array(20);N=new RdpBuffer(L,0,20);N.setLittleEndian32(-2147483648);N.setLittleEndian32(P);hi5.Arrays.equals([118,105,100,115,0,0,16,0,128,0,0,170,0,56,155,113],na)&&hi5.Arrays.equals([77,74,80,71,0,0,16,0,128,0,0,170,0,56,155,113],ta)&&hi5.Arrays.equals([128,159,88,5,86,195,206,17,191,1,0,170,0,85,89,90],T)?N.setLittleEndian32(1):(N.setLittleEndian32(0),svGlobal.logger.warn("Format is not supported:"),
svGlobal.logger.warn(na),svGlobal.logger.warn(ta),svGlobal.logger.warn(T));N.setLittleEndian32(ba);E.send(L);break;case 258:v.getBytes(16);v.getLittleEndian32();ba=v.getLittleEndian32();v.skipPosition(ba);break;case 263:v.getBytes(16),L=new Uint8Array(16),N=new RdpBuffer(L,0,16),N.setLittleEndian32(-2147483648),N.setLittleEndian32(P),N.setLittleEndian32(1),E.send(L);case 277:v.getBytes(16);v.getLittleEndian32();break;case 262:v.getBytes(16);va.flushImgs();va.setImgRect(0,0,0,0);L=new Uint8Array(12);
N=new RdpBuffer(L,0,12);N.setLittleEndian32(-2147483648);N.setLittleEndian32(P);E.send(L);break;case 278:v.getBytes(16);P=v.getLittleEndian32();L=v.getLittleEndian32();ba=v.getLittleEndian32();v=v.getLittleEndian32();va.setImgRect(P,L,ba-P,v-L);break;case 265:v.getBytes(16);v.getLittleEndian64();v.getLittleEndian32();break;case 266:v.getBytes(16);break;case 268:v.getBytes(16);break;case 267:v.getBytes(16);break;case 269:v.getBytes(16);v.getLittleEndian32();break;case 274:break;case 275:break;case 259:v.getBytes(16);
v.getLittleEndian32();v.getLittleEndian32();v.skipPosition(32);L=v.getLittleEndian32();P=new Image;ba=v.getPosition();O[0]=v.getData().subarray(ba,ba+L);v=new Blob(O,x);P.src=URL.createObjectURL(v);va.addImg(P);break;case 270:va.flushImgs();break;case 273:break;case 260:break;case 276:v.getBytes(16);L=v.getLittleEndian32();ba=v.getPosition()+L;v.skipPosition(8);P=v.getLittleEndian32();svGlobal.logger.info("window state:"+P);N=v.getLittleEndian32();na=v.getLittleEndian32();P=v.getLittleEndian32();
L=v.getLittleEndian32();v.skipPosition(8);ta=v.getLittleEndian32();T=v.getLittleEndian32();svGlobal.logger.info("Window rect, left:"+P+" top:"+L+" w:"+N+" h:"+na+" cl:"+ta+" ct:"+T);v.setPosition(ba);ba=v.getLittleEndian32();for(ba=v.getPosition()+ba;v.getPosition()<ba;){ta=v.getLittleEndian32();T=v.getLittleEndian32();var z=v.getLittleEndian32(),Z=v.getLittleEndian32();svGlobal.logger.info("visible region, l:"+T+" t:"+ta+" r:"+Z+" b:"+z)}va.setImgRect(P,L,N,na);break;case 1:case 2:break;default:svGlobal.logger.warn("unknown function:"+
L)}break;default:svGlobal.logger.warn("unkown interface:"+ba)}};return E}());nb||m.addDynamicChannel(y());ja.enableDVCAudio&&m.addDynamicChannel(function(E,x,O){var v=!1,ba=0,P=0,L=0,N=0,na=[],ta=new Uint8Array(4),T=new m.DynamicChannel;T.name="AUDIO_PLAYBACK_DVC";T.onclose=function(){};T.process=function(z){function Z(S,ra){if(22050>S.nSamplesPerSec||41222==S.formatTag&&0<O&&O!=S.nAvgBytesPerSec)return!1;switch(ra){case 0:return 49==S.formatTag&&22050==S.nSamplesPerSec;case 1:return 1==S.formatTag||
41222==S.formatTag;case 2:return 1==S.formatTag;case 3:return 49==S.formatTag&&22050==S.nSamplesPerSec;case 4:return 41222==S.formatTag;default:return!0}}function W(S){S.skipPosition(14);var ra=S.getLittleEndian16();S.getByte();var wa=S.getLittleEndian16();S.skipPosition(1);for(var za,qa=na.length=0;qa<ra;qa++){var aa=new f;aa.fromBuffer(S);svGlobal.logger.info("Server audio fmt "+qa+":"+aa.toString());(za=Z(aa,E))&&na.push(aa)}L=-1;if(x){aa=20;S=na.length;for(qa=0;qa<S;qa++)aa+=na[qa].getSize();
qa=aa+4;ra=new RdpBuffer(new Uint8Array(qa),0,qa);ra.setByte(7);ra.setByte(2);ra.setLittleEndian16(aa);ra.setLittleEndian32(3);ra.setLittleEndian32(4294967295);ra.setLittleEndian32(0);ra.setLittleEndian16(0);ra.setLittleEndian16(S);ra.skipPosition(1);ra.setLittleEndian16(wa);ra.setByte(124);for(qa=0;qa<S;qa++)aa=na[qa],aa.toBuffer(ra);ra.markEnd();T.send(ra);5<wa&&(svGlobal.logger.info("Audio output, version: "+wa),ra=new RdpBuffer(new Uint8Array(8),0,8),ra.setByte(12),ra.skipPosition(1),ra.setLittleEndian16(4),
ra.setLittleEndian16(1),ra.setLittleEndian16(0),ra.markEnd(),T.send(ra))}}function M(S){var ra=S.getLittleEndian16();S=S.getLittleEndian16();if(x){var wa=new RdpBuffer(new Uint8Array(8),0,8);wa.setByte(6);wa.setByte(35);wa.setLittleEndian16(4);wa.setLittleEndian16(ra);wa.setLittleEndian16(S);wa.markEnd();T.send(wa)}}function fa(){var S=na[L];if(S){if(S.formatTag!=Ea.tag||S.nAvgBytesPerSec!=Ea.nAvgBytesPerSec||S.nSamplesPerSec!=Ea.samplePerSec||Ea.channels!=S.nChannels)Ea.tag=S.formatTag,Ea.channels=
S.nChannels,Ea.samplePerSec=S.nSamplesPerSec,Ea.bitsPerSample=49==S.formatTag?8:S.bitsPerSample,Ea.nBlockAlign=S.nBlockAlign,Ea.nAvgBytesPerSec=S.nAvgBytesPerSec,svGlobal.logger.info("DVC Audio Format, tag, "+L+":"+S.toString()),41222==Ea.tag&&(Ea.sampleRate=Ea.samplePerSec,Va.initMediaPlayer(Va,Ea,!0))}else 41222!=Ea.tag&&(Ea.tag=41222,Ea.channels=2,Ea.bitsPerSample=16,Ea.sampleRate=44100,Ea.nBlockAlign=4,Ea.nAvgBytesPerSec=12E3,Va.initMediaPlayer(Va,Ea,!0))}function X(S){P=S.getLittleEndian16();
var ra=S.getLittleEndian16();N=S.getByte();S.skipPosition(3);ta.set(S.getSubarray(4));v=!0;ra!=L&&(L=ra,fa())}function R(S,ra){if(x){var wa=new RdpBuffer(new Uint8Array(8),0,8);wa.setByte(5);wa.skipPosition(1);wa.setLittleEndian16(4);wa.setLittleEndian16(S);wa.setByte(ra);wa.skipPosition(1);wa.markEnd();T.send(wa)}}function la(S){v=!1;var ra=ba-8;Date.now();S.copyFromByteArray(ta,0,S.getPosition(),4);pc(S,N,P,ra);R(P,N)}function ka(S){Date.now();P=S.getLittleEndian16();L=S.getLittleEndian16();N=S.getByte();
S.skipPosition(7);fa();pc(S,N,P,0);R(P,N)}if(v)la(z);else{var ca=z.getByte();z.skipPosition(1);ba=z.getLittleEndian16();switch(ca){case 7:W(z);break;case 6:M(z);break;case 2:X(z);break;case 3:z.getLittleEndian16();z.getLittleEndian16();break;case 13:ka(z)}}};return T}(g,0==m.mode,Zd));svGlobal.DCVC_EXTENSION||(svGlobal.DCVC_EXTENSION={});var B=svGlobal.DCVC_EXTENSION;B.WEBAUTHN=function(E){function x(){if(ba){var P=Error("Cancelling existing WebAuthn API call for new one");P.name="WebAuthnAbortError";
ba.abort(P)}ba=new AbortController;return ba.signal}function O(){if(ba){var P=Error("Manually cancelling existing WebAuthn API call");P.name="WebAuthnAbortError";ba.abort(P);ba=void 0}}var v=new E;v.name="WebAuthN_Channel";v.newInstance=function(){return B.WEBAUTHN(E)};v.onopen=function(){svGlobal.logger.info("webAuthn open")};v.onclose=function(){svGlobal.logger.info("webAuthn close")};var ba=null;v.process=function(P){var L=P.getEnd()-P.getPosition();P=P.getBytes(L);var N=Jb(P),na=N.command;L=N.flags;
P=N.timeout;var ta=N.webAuthNPara;if(na)switch(console.log("==== command: "+N.command),na){case 5:if(N.request)switch(na=N.request[0],console.log("==== webAuth cmdType = "+na),console.log("==== webAuth request bytes: "+Id(N.request.slice(1,N.request.length))),na){case 1:N=N.request.slice(1,N.request.length);var T=Jb(N);N=T[1];var z=T[2],Z=T[3],W=T[4],M=T[5];na=T[6];var fa=T[7];T={};var X=Ed(ta);X&&(X.attestation&&(T.attestation=X.attestation),X.attestationFormats&&(T.attestationFormats=X.attestationFormats));
if(L=Dd(L,ta,fa))T.authenticatorSelection=L;T.challenge=N;M&&(T.excludeCredentials=Jc(M));T.rpId=z.id;T.rp=z;T.extensions=na?na:{};T.extensions.remoteDesktopClientOverride={origin:"https://"+relyingPartyInfo.id,sameOriginWithAncestors:!1};W&&(T.pubKeyCredParams=W);P&&(T.timeout=P);T.user=Z;P={};P.signal=x();P.publicKey=T;navigator.credentials.create(P).then(function(R){Fd(R.response,z).then(function(la){var ka={},ca={maxMsgSize:1200,maxSerializedLargeBlobArray:0,providerType:"Hid",providerName:"MicrosoftCtapHidProvider",
devicePath:"\\\\?\\hid#vid_1050&pid_0407&mi_01#7&1dd131cc&0&0000#{4d1e55b2-f16f-11cf-88cb-001111000030}"},S=new Uint8Array([159,87,192,47,19,129,234,71,177,22,187,90,141,185,32,42]);ca.aaGuid=S.buffer;ca.residentKey=!0;ka.deviceInfo=ca;ka.status=0;ka.response=la;la=CBOR.encode(ka);ka=new hi5.DataBuffer(new Uint8Array(4+la.byteLength));ka.setLittleEndian32(0);ka.setBytes(la);ka.markEnd();v.send(ka)})}).catch(function(R){console.log("WebAuthN MakeCredential failed with error code ["+R.code+"], msg: "+
R.message);R=new hi5.DataBuffer(new Uint8Array(4));R.setLittleEndian32(1);R.markEnd();v.send(R)});break;case 2:N=N.request.slice(1,N.request.length);T=Jb(N);N=T[2];Z=T[3];na=T[4];fa=T[5];T={};Z&&(T.allowCredentials=Jc(Z));T.challenge=N;na&&(T.extensions=na);T.rp=window.location.hostname;P&&(T.timeout=P);if(P=Ic(L,ta,fa))T.userVerification=P;P={};P.signal=x();P.publicKey=T;navigator.credentials.get(P).then(function(R){R=new hi5.DataBuffer(new Uint8Array(void 0));R.markEnd();v.send(R)}).catch(function(R){console.log("WebAuthN GetAssertion failed with error code ["+
R.code+"], msg: "+R.message);R=new hi5.DataBuffer(new Uint8Array(4));R.setLittleEndian32(1);R.markEnd();v.send(R)});break;default:svGlobal.logger.error("Unknown WebAuthn command type: "+na)}else svGlobal.logger.error("Incorrect request content in WEB AUTH COMMAND");break;case 6:P=new hi5.DataBuffer(new Uint8Array(8));P.setLittleEndian32(0);L=Hc()?PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable():!1;L?P.setLittleEndian32(1):P.setLittleEndian32(0);P.markEnd();v.send(P);break;case 7:O();
P=new hi5.DataBuffer(new Uint8Array(4));P.setLittleEndian32(0);P.markEnd();v.send(P);break;case 8:P=new hi5.DataBuffer(new Uint8Array(8));P.setLittleEndian32(0);P.setLittleEndian32(4);P.markEnd();v.send(P);break;default:svGlobal.logger.warn("Unknown command received in WebAuthN Channel: "+na)}else svGlobal.logger.warn("WebAuthN Channel, command missed")};return v};m.enableWebAuthn()&&Hc()&&(a=B.WEBAUTHN(m.DynamicChannel),m.addDynamicChannel(a));c&&(c=B.WEBCAM(m.DynamicChannel),a=B.WEBCAM_ENUM(m.DynamicChannel,
c),m.addDynamicChannel(a),m.addDynamicChannel(c));e&&(svGlobal.logger.info("Mapping USB..."),m.addDynamicChannel(Ka.usbChannel));if(b&&B.GFX){var A=function(){db.drawable.resumePlay||(db.drawable.resumePlay=function(){Va&&Va.supportWebAudio&&Va.iOSFix();db.resumeVideo()})};db=B.GFX(m.DynamicChannel,U(J.remotefx)&&!U(J.gfx),0==m.mode,va,J.hardwareAcceleration,U(J.yuv444)&&hi5.browser.supportsI444);db.onmessage=function(E){m.showMessage(E)};A();db.onuserinteract=function(E){ia.execute("showPlay");A();
svGlobal.logger.info("resumePlay");return!0};db.onfatalerror=function(E,x){m.reconnect(E.width,E.height,!0)};db.onsps=function(E){E.fps&&m.setFPS(E.fps)};db.onresetgraphic=function(E){m.setResolution(E.width,E.height)};db.onmapsurface=function(E){db.onconfirm();var x=ia.getMonitorSurface(E.outputOriginX,E.outputOriginY,E.targetWidth+E.outputOriginX-1,E.targetHeight+E.outputOriginY-1);x?(x.setId(E.id),x.setSize(E.targetWidth,E.targetHeight)):svGlobal.logger.error("Failed to map surface, x:"+E.outputOriginX+
" y:"+E.outputOriginY)};db.onconfirm=function(){svGlobal.logger.info("GFXDrawableController in use");ia.execute("setDrawable",[db.drawable])};m.addDynamicChannel(db)}B.VOR&&(b=B.VOR(m.DynamicChannel),m.addDynamicChannel(b[0]),m.addDynamicChannel(b[1]),m.addDynamicChannel(B.GT(m.DynamicChannel)))}}},eb=null;svGlobal.DCVC_EXTENSION&&!nb&&(m.hasUSB()&&svGlobal.DCVC_EXTENSION.WEBUSB&&(Ka.usbChannel=svGlobal.DCVC_EXTENSION.WEBUSB(m.DynamicChannel)),svGlobal.DCVC_EXTENSION.DRIVE&&(eb=svGlobal.DCVC_EXTENSION.DRIVE(m.GatewayChannel),
m.addGatewayChannel(eb)));this.getPrinters=function(a){if(!m.onagentmessage||!eb)return null;var b=new hi5.DataBuffer(new Uint8Array(2));b.setByte(6);b.setByte(1);b.markEnd();m.onagentmessage(b.getData());eb.listCallback=a};this.attachPrinter=function(a){eb&&eb.attachPrinter(a,m)};this.attachDirectory=function(a){eb&&eb.attachDirectory(a,m)};this.showError=Ib;this.resetStatus=gc;this.exeAppCmd=function(a){var b=ia.getFocused();b&&b.exeCommand(a)};this.activateApp=function(a){var b;(b=hi5.tool.isNumber(a)?
ia.getWinById(a):ia.getMainWinByAppId(a))?b.activate(1):svGlobal.logger.warn("No window found in "+a)};this.reconnect=function(a,b,d){void 0==d&&(d=ja.forceReconnect||!1);if(!La&&!d)return!1;J.minWidth&&a<J.minWidth&&(a<J.minWidth&&svGlobal.logger.warn("Width "+a+" is samller than minWidth "+J.minWidth),a=J.minWidth);J.minHeight&&b<J.minHeight&&(b<J.minHeight&&svGlobal.logger.warn("Height "+b+" is samller than minHeight "+J.minHeight),b=J.minHeight);a&=-4;b&=-4;if(!d&&4>Math.abs(a-Ma)&&4>Math.abs(b-
Na))return!1;if(Qa&&Qa.enabled&&!1!==ja.displayVC)Qa.applyResolution(a,b);else if(sc&&tb||d||$a&&!sc)tb=!1,svGlobal.logger.info("reconnecting..."),ya("8E0"+a+"\t"+b),Ta&&(Ta.remoteLockFlags=0,Ta.checkLockFlags=!0);return!0};this.notify=function(a,b){a="8E6"+a;b&&(a+="\t"+b.join(";"));ya(a)};this.getUploadManager=function(){return Pa};this.setFPS=function(a){ia.execute("setFPS",[a])};this.addSurface=function(a){if(!ia.hasSurface(a)&&(Ob||va.setContext(a.context),!ia.hasSurface(a)||!a.railWin)){nb&&
a.setPlayerMode();J.mouseMoveEmu&&(a.mouseMoveEmu=U(J.mouseMoveEmu));a.setSize(50,50,"hidden");var b=a.getFreeSpace();0==Ma&&(Ma=b.width);0==Na&&(Na=b.height);a.setConfig(ja);ia.addSurface(a);Ra(Ma,Na,!0,J.monitorDef?!0:!1);a.setController(Ta);a.setDrawable(ae);a.setTouchpad(U(J.touchpad));var d=b=U(J.mapClipboard),g=b;void 0!=J.copyToLocal?d=U(J.copyToLocal):void 0!=ja.copyToLocal&&(d=ja.copyToLocal);void 0!=J.copyToRemote?g=U(J.copyToRemote):void 0!=ja.copyToRemote&&(g=ja.copyToRemote);a.setClipboard(b,
d,g);Nb&&hc(a);J.invitation&&!U(J.control)&&(ia.setReadOnly(!0),b=hi5.$("requestControl"))&&(b.disabled=!1);b=void 0!=J.ctrlToWin?U(J.ctrlToWin):void 0!=ja.ctrlToWin?ja.ctrlToWin:!0;d=void 0!=J.cmdToCtrl?U(J.cmdToCtrl):void 0!=ja.cmdToCtrl?ja.cmdToCtrl:!0;a.run(parseInt(J.keyboard||1033,10),b,!!ja.noKeyStuck,d)}};this.getRunninApps=this.getRunningApps=function(){for(var a=[],b=0,d=ia.size();b<d;b++)ia.getSurface(b).railWin.getMain(ia.zOrders)&&a.push(ia.getSurface(b).railWin.getMain(ia.zOrders).titleInfo);
return a};this.startApp=function(a,b,d){b=b||"";d=d||"";ya("8C2"+a+"\t"+b+"\t"+d);var g=ia.getSurface(ia.size()-1);g&&(g.remoteApp=new Gc(a,b,d))};this.startExitingApp=function(a){a=ia.popWins(a);for(var b=a.length-1;0<=b;b--)ia.addWin(a[b])};var yb=new m.DynamicChannel;yb.name="PNPDR";yb.onopen=function(){svGlobal.logger.info("PNPDR DVC onopen()")};yb.process=function(a){a.getLittleEndian32();var b=a.getLittleEndian32();switch(b){case 101:a.getLittleEndian32(),a.getLittleEndian32(),a.getLittleEndian32(),
a=new RdpBuffer(new Uint8Array(20),0,20),a.setLittleEndian32(20),a.setLittleEndian32(b),a.setLittleEndian32(1),a.setLittleEndian32(5),a.setLittleEndian32(1),yb.send(a)}};yb.onclose=function(){svGlobal.logger.info("PNPDR DVC onclose()")};m.addDynamicChannel(yb);var kb=null;U(J.scanner)&&(kb=new m.DynamicChannel,kb.name="SCANNERDVC",kb.onopen=function(){svGlobal.logger.info("scanner DVC onopen().")},kb.process=function(a){var b=a.getByte();switch(b){case 0:var d=a.getByte(),g=a.getByte();b=new Uint8Array(10);
b[0]=4;b[1]=7;b[2]=d;b[3]=g;b.set(a.getBytes(2),4);b.set(a.getBytes(2),6);b.set(a.getBytes(2),8);if(m.onagentmessage)m.onagentmessage(b);break;case 1:break;case 2:d=a.getEnd()-a.getPosition();b=new Uint8Array(d+2);b[0]=4;b[1]=3;b.set(a.getBytes(d),2);if(m.onagentmessage)m.onagentmessage(b);break;case 3:d=a.getEnd()-a.getPosition();b=new Uint8Array(d+3);b[0]=4;b[1]=9;b[2]=0;b.set(a.getBytes(d),3);if(m.onagentmessage)m.onagentmessage(b);break;default:svGlobal.logger.info('Warning: Unknown type "'+b+
'" received from DVC, ignored.')}},kb.onclose=function(){var a=new Uint8Array(2);a[0]=4;a[1]=4;if(m.onagentmessage)m.onagentmessage(a)},m.addDynamicChannel(kb));var fb=null;m.hasSmartCard()&&(fb=new m.GatewayChannel,fb.name="SCARDSTB",fb.onopen=function(){var a=new Uint8Array(2);a[0]=3;a[1]=1;if(m.onagentmessage)m.onagentmessage(a);U(J.passwordIsPin)&&m.onagentmessage&&!hi5.browser.isMacOS&&hi5.notifications.notify({msg:__svi18n.info.scardAuth||"Smart card authentication in progress. Please wait...",
type:0,timeout:1E4})},fb.process=function(a){var b=a.getEnd()-a.getPosition(),d=a.getByte(),g=a.getByte();switch(d){case 1:switch(g){case 1:d=new Uint8Array(2);d[0]=3;d[1]=7;if(m.onagentmessage)m.onagentmessage(d);break;case 3:a=a.getBytes(b-2);b=b+4+4+4;zb&&(b+=zb.length);ib&&(b+=ib.length);b=new hi5.DataBuffer(new Uint8Array(b));b.setByte(3);b.setByte(9);zb?(b.setLittleEndian32(zb.length),b.setBytes(zb)):b.setLittleEndian32(0);ib?(b.setLittleEndian32(ib.length),b.setBytes(ib)):b.setLittleEndian32(0);
b.setLittleEndian32(a.length);b.setBytes(a);b.markEnd();if(m.onagentmessage)m.onagentmessage(b.getData());break;case 5:a=a.getBytes(b);d=new Uint8Array(b);d[0]=3;d[1]=11;d.set(a,2);if(m.onagentmessage)m.onagentmessage(d);break;case 2:case 4:break;default:svGlobal.logger.warn("Invalid smart card channel auth data received: unknown sub-type ["+a[1]+"].")}break;case 2:if(fb)if(1==g){if(d=new Uint8Array(b),d[0]=3,d[1]=3,d.set(a.getBytes(b),2),m.onagentmessage)m.onagentmessage(d)}else svGlobal.logger.warn("Invalid smart card channel pcsc data received: unknown sub-type ["+
a[1]+"].");break;default:svGlobal.logger.warn("Invalid smart card channel data received: unknown type ["+a[0]+"].")}},fb.onclose=function(){var a=new Uint8Array(2);a[0]=3;a[1]=4;if(m.onagentmessage)m.onagentmessage(a)},m.addGatewayChannel(fb));p+="&connectType=7";(function(){var a=0,b=0,d=new m.GatewayChannel;d.name="MESSGSTB";d.onopen=function(){svGlobal.logger.info("Message Channel open")};d.process=function(g){if(0==g.getByte())g.getByte(),g.getByte(),g.getByte();else{var c=g.getByte(),e=g.getLittleEndian16(),
f=g.getLittleEndian16();if(0!=c)svGlobal.logger.warn("Invalid AUTODETECT_REQUEST");else switch(f){case 1:case 4097:f=new RdpBuffer(new Uint8Array(6),0,6);f.setByte(6);f.setByte(1);f.setLittleEndian16(e);f.setLittleEndian16(0);f.markEnd();d.send(f);break;case 20:case 276:case 4116:a=6;b=Date.now();break;case 2:e=g.getLittleEndian16();a+=e;break;case 43:case 1065:case 1577:43==f&&(c=g.getLittleEndian16(),a=a+c+8,g.skipPosition(c));g=g.has(4)?g.getLittleEndian32():0;a+=g;g=Date.now()-b;c=new RdpBuffer(new Uint8Array(14),
0,14);c.setByte(14);c.setByte(1);c.setLittleEndian16(e);c.setLittleEndian16(43==f?3:11);c.setLittleEndian32(g);c.setLittleEndian32(a);c.markEnd();d.send(c);break;case 2112:case 2176:case 2240:e=g.getLittleEndian32();f=g.getLittleEndian32();g=g.getLittleEndian32();vc={baseRTT:e,bandwidth:f,averageRTT:g};if(m.onnetworkresult)m.onnetworkresult(vc);break;default:svGlobal.logger.warn("Invalid network detect PDU",g)}}};d.onclose=function(){svGlobal.logger.info("MSG channel close")};m.addGatewayChannel(d)})();
this.getNetworkResult=function(){return vc};this.getAgentLink=function(){var a=navigator.userAgentData?navigator.userAgentData.platform:navigator.platform||navigator.appVersion;return-1!=a.indexOf("Win")?"agent_setup.exe":-1!=a.indexOf("macOS")||-1!=a.indexOf("Mac")?"agent_setup.pkg":""};var ic=new Map,jc=new Map;this.writeAgent=function(a){a.byteLength&&(a=new Uint8Array(a));switch(a[0]){case 3:if(fb){var b=a.slice?new hi5.DataBuffer(a.slice(2,a.length)):new hi5.DataBuffer(a.subarray(2,a.length));
switch(a[1]){case 1:case 4:case 5:case 6:case 7:case 9:case 11:break;case 2:break;case 3:a[0]=2;a[1]=1;fb.send(a);break;case 8:ic.clear();jc.clear();a=b.getLittleEndian32();if(0!=a)a=b.getLittleEndian32(),b=b.getAscllString(a,!1),hi5.notifications.notify({msg:b});else{var d=b.getLittleEndian32(),g=document.getElementById("scardSelection");g||(g=document.createElement("div"),g.id="scardSelection",g.className="appdlg",document.body.appendChild(g));if(g)if(0==d)g&&(g.innerHTML="<p>Error: Could not find any connected smart card. Please make check the connectivity and then refresh the page",
b=new hi5.ui.Lightbox(g),b.onclose=function(){location.reload()},b.show());else{g.innerHTML=1<d?'<p><b>PLEASE SELECT A SMART CARD, ENTER YOUR CREDENTIAL AND CLICK "Continue".</b></p>':'<p><b>PLEASE ENTER YOUR CREDENTIAL AND CLICK "Continue".</b></p>';for(a=0;a<d;a++){var c=b.getLittleEndian32();c=b.getBytes(c);var e=b.getLittleEndian32();e=b.getAscllString(e,!1);var f=b.getLittleEndian32();f=b.getAscllString(f,!1);var y=b.getLittleEndian32();b.getAscllString(y,!1);y=b.getLittleEndian64();y=(new Date(1E3*
y)).toDateString();c=Jd(a,c,f,e,y);g.appendChild(c)}g.innerHTML+="<br>";b=document.createElement("div");b.innerHTML+="Smart card credential: ";a=document.createElement("input");a.type="text";a.id="userPin";a.placeholder="PIN";a.value="";a.required=!0;b.appendChild(a);g.appendChild(b);g.innerHTML+="<br>";b=new hi5.ui.Lightbox(g,{btnYes:{}});b.onclose=function(){var w,t=document.querySelector('input[name="scard_name"]:checked');t&&(w=parseInt(t.value));zb=ic.get(w);ub=jc.get(w);w=document.getElementById("userPin").value;
ib=(new TextEncoder("utf-8")).encode(w);w=2;w=ib?w+4+ib.length:w+4;w=ub?w+4+ub.length:w+4;w=new Uint8Array(w);w=new hi5.DataBuffer(w);w.setByte(1);w.setByte(2);ib?(w.setLittleEndian32(ib.length),w.setBytes(ib)):w.setLittleEndian32(0);ub?(w.setLittleEndian32(ub.length),w.setAsciiString(ub,ub.length)):w.setLittleEndian32(0);fb&&fb.send(w)};document.getElementById("userPin").addEventListener("keypress",function(w){"Enter"===w.key&&(w.preventDefault(),document.getElementById("continue_button").click())});
b.show()}}break;case 10:a=b.getLittleEndian32();0!=a?(a=b.getLittleEndian32(),b=b.getAscllString(a,!1),hi5.notifications.notify({msg:b})):(a=b.getLittleEndian32(),a=b.getBytes(a),b=new Uint8Array(6+a.length),b=new hi5.DataBuffer(b),b.setByte(1),b.setByte(4),b.setLittleEndian32(a.length),b.setBytes(a),fb.send(b));break;case 12:a[0]=1;a[1]=6;fb.send(a);break;default:svGlobal.logger.warn("Warning: Unknown smart card response header: [3 / "+a[1]+"], ignored.")}}break;case 4:if(kb)switch(a[1]){case 2:b=
a.slice?new hi5.DataBuffer(a.slice(2,a.length)):new hi5.DataBuffer(a.subarray(2,a.length));g=document.getElementById("dsSelection");g||(g=document.createElement("div"),g.id="dsSelection",g.className="appdlg",document.body.appendChild(g));if(0!=b.getLittleEndian16())g&&(g.innerHTML="<p>Error on local: failed to get the list of connected scanners. Close to continue without scanning.</p>",b=new hi5.ui.Lightbox(g),b.onclose=function(){m.run()},b.show());else if(d=(a.byteLength-4)/41,0==d)g&&(g.innerHTML=
"<p>Error: Could not find any connected scanner. Please:<ul><li>Power on or connect the scanner and then refresh the page; or</li><li>Close this dialog to connect to the machine without using scanner.</li></ul></p>",b=new hi5.ui.Lightbox(g),b.onclose=function(){m.run()},b.show());else if(1==d){if(b=new Uint8Array(3),b[0]=4,b[1]=5,b[2]=0,m.onagentmessage)m.onagentmessage(b)}else if(g){g.innerHTML='<p> Please choose a scanner &lt;DriverType: DeviceName&gt; and click "Continue".</a></p>';for(a=0;a<d;a++)c=
b.getAscllString(41,!0),c=Kd(a,c),g.appendChild(c);g.innerHTML+="<br>";b=new hi5.ui.Lightbox(g,{btnYes:{}});b.onclose=function(){var w=0,t=document.querySelector('input[name="ds_name"]:checked');t&&(w=t.value);t=new Uint8Array(3);t[0]=4;t[1]=5;t[2]=w;if(m.onagentmessage)m.onagentmessage(t)};b.show()}break;case 3:case 8:case 10:b=a.slice?new hi5.DataBuffer(a.slice(2,a.length)):new hi5.DataBuffer(a.subarray(2,a.length));kb.send(b);break;case 4:b=a.slice?new hi5.DataBuffer(a.slice(2,a.length)):new hi5.DataBuffer(a.subarray(2,
a.length));kb.send(b);hi5.notifications.notify({msg:__svi18n.info.TwainNotSupported,type:2});break;case 6:b=a.slice?new hi5.DataBuffer(a.slice(2,a.length)):new hi5.DataBuffer(a.subarray(2,a.length));b.getLittleEndian16();m.run();break;default:svGlobal.logger.warn("Warning: Unknown response header: [4 / "+a[1]+"], ignored.")}break;case 5:switch(a[1]){case 1:b=a[2]|a[3]<<8,a=a[4]|a[5]<<8,svGlobal.logger.info("Agent version, major: "+b+" minor: "+a),(g=hi5.appcfg.agent&&hi5.appcfg.agent.version)&&(g.major>
b||g.major==b&&g.minor>a)&&(b=__svi18n.info.newVersion||"New versoin available",a=__svi18n.info.updateAgent||"Please download and install the new gateway agent",g=m.getAgentLink(),hi5.notifications.notify({title:b,html:!0,msg:a+(': <a href="'+g+'">'+g+"</a>")}))}break;case 6:switch(a[1]){case 1:b=new hi5.DataBuffer(a);b.skipPosition(2);g=b.getLittleEndian32();d=[];for(a=0;a<g;a++)e=b.getLittleEndian32(),c=b.getUnicodeString(e),e=b.getLittleEndian32(),e=b.getUnicodeString(e),d.push({name:c,driver:e});
eb&&eb.listCallback&&(eb.listCallback(d),eb.listCallback=null)}break;case 7:eb.send(a.subarray(1));break;default:svGlobal.logger.warn("Invalid channel data received: unknown type ["+a[0]+"].")}};var zb,ib,ub,lc={type:6,data:null};this.setAgentStatus=function(a){ad=a};this.getAgentStatus=function(){return ad};this.run=function(){var a;if(a=null==m.onagentmessage)a=1==m.mode?!1:m.hasSmartCard()||m.hasScanner()||U(J.localPrinter);a&&window.startGatewayAgent?startGatewayAgent(m):(m.hasUSB()?ia.getFocused().requestUsbDevices(m.getUSB(),
function(b){Ka.usbChannel.openDevices(b);Kb()}):Kb(),Va.supportWebAudio&&Va.iOSFix())};this.getDesktop=function(){return va};this.mouseDown=function(a,b,d){$a&&ya("80"+a+"\t"+b+"\t"+d)};this.mouseMove=function(a,b){$a&&ya("82"+a+"\t"+b)};this.mouseUp=function(a,b,d){$a&&ya("81"+a+"\t"+b+"\t"+d)};this.writeKeyCode=function(a,b){$a&&ya("8B"+(a?0:49152)+"\t"+b)};this.writeScancode=function(a,b){$a&&("number"==typeof a?(ya("840\t"+a),ya("8449152\t"+a)):ya("84"+(a?0:49152)+"\t"+b))};this.resetSize=function(a,
b){m.reconnectOnResize&&(Za?(qb&&(clearTimeout(qb),qb=0),a&=-4,b&=-4,qb=setTimeout(function(){document.hidden||(Qa&&Qa.enabled&&Qa.applyResolution(a,b),setTimeout(function(){m.writeRawInput("8C661441\t"+a+"\t"+b);3==m.windowState&&$c()},150),svGlobal.logger.info("-- displayChange, h:"+b))},777)):m.running()&&(qb&&(clearTimeout(qb),qb=0),qb=setTimeout(function(){document.hidden||m.reconnect(a,b)},555)))};var Ya=new RdpBuffer([],0,0);this.suppressOutput=function(a){if(!m.sessionInfo.suppressOutput)return!1;
void 0==a&&(a=!0);var b=new Uint8Array(a?3:11);b[0]=146;b[1]=3;b[2]=a?1:0;a||(b[3]=cc,b[4]=cc>>8,b[5]=bc,b[6]=bc>>8,b[7]=dc,b[8]=dc>>8,b[9]=ec,b[10]=ec>>8);ya(b.buffer);return!0};this.refreshOutput=function(a,b,d,g){var c=new Uint8Array(d?11:3);c[0]=146;c[1]=3;c[2]=2;d&&(c[3]=a,c[4]=a>>8,c[5]=b,c[6]=b>>8,c[7]=d,c[8]=d>>8,c[9]=g,c[10]=g>>8);ya(c.buffer)};this.sendPing=function(a){var b=new Uint8Array(a?2+a.length:2);b[0]=146;b[1]=0;a&&b.set(a,2);ya(b.buffer)};this.startPing=function(a,b){b=b||0;Sa||
(Sa=new hi5.tool.ResponseMonitor(function(){$a&&m.sendPing()},function(){if($a&&m.onnoresponse)return m.onnoresponse()}));Sa.setInterval(a,b);var d=new Uint8Array(4);d[0]=146;d[1]=2;d[2]=a;d[3]=b;ya(d.buffer);setTimeout(function(){Sa&&Sa.check()},1E3*(a+b));Oa?Oa.postMessage({type:0,cmd:6,start:1}):(Ga.onSlowPath=Ga.onFastPath=Qc,Ga.onReqHistory=function(){Qc(15555)})};this.stopPing=function(){Sa&&Sa.stop();Oa?Oa.postMessage({type:0,cmd:6,start:0}):Ga.onSlowPath=Ga.onFastPath=Ga.onReqHistory=null};
var cb=null,Wc=0;this.play=function(){ya("F3")};this.pause=function(){ya("F2")};this.scan=function(a){ya("F4"+(a?"1":"0"))};this.seek=function(a){var b=ia.getFocused();b&&La&&(ya("F4"+(a?"1":"0")+"\t"+(a/b.getScale().x|0)),va&&va.pause(!0,void 0))};var Ea={tag:0,channels:0,bitsPerSample:0,samplePerSec:22050,sampleRate:22050,nBlockAlign:0,nAvgBytesPerSec:0,toStream:function(a){a.setLittleEndian16(this.tag);a.setLittleEndian16(this.channels);a.setLittleEndian16(this.bitsPerSample);a.setLittleEndian32(this.samplePerSec)},
fromStream:function(a){this.tag=a.getLittleEndian16();this.channels=a.getLittleEndian16();this.bitsPerSample=a.getLittleEndian16();this.samplePerSec=a.getLittleEndian32()}},Vc=!1;this.showMessage=function(a,b,d){m&&m.displayMsg&&a&&((b=b||ia.getFocused())?b.showMessage(a,d):("string"==typeof a&&(a={msg:a,timeout:d||0}),hi5.notifications.notify(a)))};this._unload=Bb;this.close=function(a){svGlobal.logger.info("closing...");a&&(hi5.appcfg.returnUrl=a);La&&Za&&ia&&ja.closeRemoteApp&&ia.tryCloseRemoteApps();
va&&va.isSendingHistory()?(svGlobal.logger.warn("In the middle of sending history, close delayed"),setTimeout(Zc,2222)):Zc()};hi5.browser.isChromeApp?chrome.runtime.onSuspend.addListener(m.close):window.addEventListener("beforeunload",m.close,!1);Pb.searchStartCode=function(a,b){for(var d=b[0]+2,g=a.length,c;d<g;)if(c=a[d],1==c){if(0==a[d-1]&&0==a[d-2]){b[1]=0==a[d-3]?4:3;b[0]=d-b[1]+1;return}d+=3}else 0==c?d++:d+=3;b[0]=-1};tc.SAMPLING_FREQUENCY=[96E3,88200,64E3,48E3,44100,32E3,24E3,22050,16E3,12E3,
11025,8E3,7350];var Qb=new function(){this.SPS=new function(){function a(e,f){var y=8,w=8,t,K=[];for(t=0;t<e;t++)0!==w&&(w=f.readEG(),K.push(w),w=(y+w+256)%256),y=0===w?y:w;return K}function b(){var e=this.readBool();if(!e)return{hrd_parameters_present_flag:e};for(var f=this.readUEG(),y=this.readBits(4),w=this.readBits(4),t=[],K=0;K<=f;K++){var B=this.readUEG(),A=this.readUEG(),E=this.readBool();t.push({bit_rate_value_minus1:B,cpb_size_value_minus1:A,cbr_flag:E})}K=this.readBits(5);B=this.readBits(5);
A=this.readBits(5);E=this.readBits(5);return{hrd_parameters_present_flag:e,cpb_cnt_minus1:f,bit_rate_scale:y,cpb_size_scale:w,cpb_specs:t,initial_cpb_removal_delay_length_minus1:K,cpb_removal_delay_length_minus1:B,dpb_output_delay_length_minus1:A,time_offset_length:E}}function d(){var e=this.readUEG();if(0===e){var f=this.readUEG();return{pic_order_cnt_type:e,log2_max_pic_order_cnt_lsb_minus4:f}}if(1===e){f=this.readBool();var y=this.readEG(),w=this.readEG(),t=this.readUEG(),K=[];for(i=0;i<t;i++)K.push(this.readEG());
return{pic_order_cnt_type:e,delta_pic_order_always_zero_flag:f,offset_for_non_ref_pic:y,offset_for_top_to_bottom_field:w,numRefFramesInPicOrderCntCycle:t,refFramesInPicOrderCntCycles:K}}return{pic_order_cnt_type:e}}function g(){if(7>this.availabeBytes())return console.log("no enough SPS data"),null;var e=this.readU8();if(7!=(e&31))return console.error("Invalid SPS type: "+e,data),null;var f=this.readU8(),y=this.readBits(6);this.skipBits(2);var w=this.readU8(),t=this.readUEG();if(100===f||110===f||
122===f||244===f||44===f||83===f||86===f||118===f||128===f||138===f||139===f||134===f||135===f){var K=[],B=this.readUEG();var A=3===B?this.readBool():!1;var E=this.readUEG(),x=this.readUEG(),O=this.readBool(),v=this.readBool();if(v){var ba=3!==B?8:12;for(i=0;i<ba;i++){var P=null,L=this.readBool();L&&(P=6>i?a(16,this):a(64,this));K.push({seq_scaling_list_present_flag:L,seq_scalling_list:P})}}A={chroma_format_idc:B,separate_colour_plane_flag:A,bit_depth_luma_minus8:E,bit_depth_chroma_minus8:x,qpprime_y_zero_transform_bypass_flag:O,
seq_scaling_matrix_present_flag:v,seq_scaling_lists:K}}else A=null;K=this.readUEG();B=d.call(this);E=this.readUEG();x=this.readBool();O=this.readUEG();v=this.readUEG();ba=this.readBits(1);P=0===ba?this.readBool():!1;L=this.readBool();var N,na=N=0,ta=0,T=0,z=this.readBool();z&&(N=this.readUEG(),na=this.readUEG(),ta=this.readUEG(),T=this.readUEG());N={frame_cropping_flag:z,frameCropLeftOffset:N,frameCropRightOffset:na,frameCropTopOffset:ta,frameCropBottomOffset:T};if(na=this.readBool()){var Z=this.readBool();
var W=0,M=[0,0],fa=1;if(Z){W=this.readU8();switch(W){case 1:M=[1,1];break;case 2:M=[12,11];break;case 3:M=[10,11];break;case 4:M=[16,11];break;case 5:M=[40,33];break;case 6:M=[24,11];break;case 7:M=[20,11];break;case 8:M=[32,11];break;case 9:M=[80,33];break;case 10:M=[18,11];break;case 11:M=[15,11];break;case 12:M=[64,33];break;case 13:M=[160,99];break;case 14:M=[4,3];break;case 15:M=[3,2];break;case 16:M=[2,1];break;case 255:M=[this.readU8()<<8|this.readU8(),this.readU8()<<8|this.readU8()]}M&&(fa=
M[0]/M[1])}Z={aspect_ratio_info_present_flag:Z,aspect_ratio_idc:W,aspectRatio:M,aspectScale:fa};M=(W=this.readBool())?this.readBool():!1;W={overscan_info_present_flag:W,overscan_appropriate_flag:M};if(M=this.readBool()){fa=this.readBits(3);var X=this.readBool(),R=null;if(this.readBool()){R=this.readU8();var la=this.readU8(),ka=this.readU8();R={colour_primaries:R,transfer_characteristics:la,matrix_coefficients:ka}}M={video_signal_type_present_flag:M,video_format:fa,video_full_range_flag:X,colour_description:R}}else M=
{video_signal_type_present_flag:M};(fa=this.readBool())?(X=this.readUEG(),R=this.readUEG(),fa={chroma_loc_info_present_flag:fa,chroma_sample_loc_type_top_field:X,chroma_sample_loc_type_bottom_field:R}):fa={chroma_loc_info_present_flag:fa};(X=this.readBool())?(R=this.readU32(),la=this.readU32(),ka=this.readBool(),X={timing_info_present_flag:X,num_units_in_tick:R,time_scale:la,fixed_frame_rate_flag:ka,frameDuration:la/(2*R)}):X={timing_info_present_flag:X,frameDuration:0};R=b.call(this);la=b.call(this);
ka=!1;if(la.hrd_parameters_present_flag||R.hrd_parameters_present_flag)ka=this.readBool();var ca=this.readBool(),S;if(S=this.readBool()){ta=this.readBool();T=this.readUEG();z=this.readUEG();var ra=this.readUEG(),wa=this.readUEG(),za=this.readUEG(),qa=this.readUEG();S={bitstream_restriction_flag:S,motion_vectors_over_pic_boundaries_flag:ta,max_bytes_per_pic_denom:T,max_bits_per_mb_denom:z,log2_max_mv_length_horizontal:ra,log2_max_mv_length_vertical:wa,max_num_reorder_frames:za,max_dec_frame_buffering:qa}}else S=
{bitstream_restriction_flag:S}}Z={vui_parameters_present_flag:na,aspect_ratio:Z,overscan:W,video_signal:M,chroma_loc:fa,timing:X,nalHrdParameters:R,vclHrdParameters:la,low_delay_hrd_flag:ka,picStructPresentFlag:ca,bitstream_restriction:S};W=Math.ceil((16*(O+1)-2*N.frameCropLeftOffset-2*N.frameCropRightOffset)*Z.aspect_ratio.aspectScale);M=(2-ba)*(v+1)*16-(ba?2:4)*(N.frameCropTopOffset+N.frameCropBottomOffset);na=Z.timing.frameDuration;fa=this.data;X="avc1."+(0==fa[1]?"00":fa[1].toString(16));X+=0==
fa[2]?"00":fa[2].toString(16);X+=0==fa[3]?"00":fa[3].toString(16);return{nalType:e,profile_idc:f,constraint_set:y,level_idc:w,seq_parameter_set_id:t,chroma:A,log2_max_frame_num_minus4:K,picOrderCnt:B,max_num_ref_frames:E,gaps_in_frame_num_value_allowed_flag:x,pic_width_in_mbs_minus1:O,pic_height_in_map_units_minus1:v,frame_mbs_flags:ba,mb_adaptive_frame_field_flag:P,direct_8x8_inference_flag:L,frame_cropping:N,vui:Z,width:W,height:M,fps:na,codec:X}}function c(e,f){f.writeUEG(e.cpb_cnt_minus1);f.writeBits(e.bit_rate_scale,
4);f.writeBits(e.cpb_size_scale,4);for(var y=e.cpb_specs,w=0;w<=e.cpb_cnt_minus1;w++){var t=y[w];f.writeUEG(t.bit_rate_value_minus1);f.writeUEG(t.cpb_size_value_minus1);f.writeBool(t.cbr_flag)}f.writeBits(e.initial_cpb_removal_delay_length_minus1,5);f.writeBits(e.cpb_removal_delay_length_minus1,5);f.writeBits(e.dpb_output_delay_length_minus1,5);f.writeBits(e.time_offset_length,5)}this.read=function(e){return g.call(e)};this.write=function(e,f){f.writeU8(e.nalType);f.writeU8(e.profile_idc);f.writeBits(e.constraint_set,
6);f.writeBits(0,2);f.writeU8(e.level_idc);f.writeUEG(e.seq_parameter_set_id);if(e.chroma&&(f.writeUEG(e.chroma.chroma_format_idc),3===e.chroma.chroma_format_idc&&f.writeBool(e.chroma.separate_colour_plane_flag),f.writeUEG(e.chroma.bit_depth_luma_minus8),f.writeUEG(e.chroma.bit_depth_chroma_minus8),f.writeBool(e.chroma.qpprime_y_zero_transform_bypass_flag),f.writeBool(e.chroma.seq_scaling_matrix_present_flag),e.chroma.seq_scaling_matrix_present_flag))for(var y=3!==e.chroma.chroma_format_idc?8:12,
w=e.chroma.seq_scaling_lists,t=0;t<y;t++){var K=w[t],B=K.seq_scaling_list_present_flag;f.writeBool(B);if(B){B=K.seq_scalling_list;K=B.length;for(var A=0;A<K;A++)f.writeUEG(B[A])}}f.writeUEG(e.log2_max_frame_num_minus4);t=e.picOrderCnt;f.writeUEG(t.pic_order_cnt_type);if(0===t.pic_order_cnt_type)f.writeUEG(t.log2_max_pic_order_cnt_lsb_minus4);else if(1===t.pic_order_cnt_type)for(f.writeBool(t.delta_pic_order_always_zero_flag),f.writeEG(t.offset_for_non_ref_pic),f.writeEG(t.offset_for_top_to_bottom_field),
y=t.refFramesInPicOrderCntCycles,K=t.numRefFramesInPicOrderCntCycle||y.length,f.writeUEG(K),t=0;t<K;t++)f.writeEG(y[t]);f.writeUEG(e.max_num_ref_frames);f.writeBool(e.gaps_in_frame_num_value_allowed_flag);f.writeUEG(e.pic_width_in_mbs_minus1);f.writeUEG(e.pic_height_in_map_units_minus1);f.writeBool(e.frame_mbs_flags);e.frame_mbs_flags||f.writeBool(e.mb_adaptive_frame_field_flag);f.writeBool(e.direct_8x8_inference_flag);t=e.frame_cropping;f.writeBool(t.frame_cropping_flag);t.frame_cropping_flag&&(f.writeUEG(t.frameCropLeftOffset),
f.writeUEG(t.frameCropRightOffset),f.writeUEG(t.frameCropTopOffset),f.writeUEG(t.frameCropBottomOffset));e=e.vui;f.writeBool(e.vui_parameters_present_flag);e.vui_parameters_present_flag&&(t=e.aspect_ratio,f.writeBool(t.aspect_ratio_info_present_flag),t.aspect_ratio_info_present_flag&&(f.writeU8(t.aspect_ratio_idc),255===t.aspect_ratio_idc&&(f.writeU8(t.aspectRatio[0]>>>8&255),f.writeU8(t.aspectRatio[0]&255),f.writeU8(t.aspectRatio[1]>>>8&255),f.writeU8(t.aspectRatio[1]&255))),t=e.overscan,f.writeBool(t.overscan_info_present_flag),
t.overscan_info_present_flag&&f.writeBool(t.overscan_appropriate_flag),t=e.video_signal,f.writeBool(t.video_signal_type_present_flag),t.video_signal_type_present_flag&&(f.writeBits(t.video_format,3),f.writeBool(t.video_full_range_flag),f.writeBool(t.colour_description_present_flag),t.colour_description_present_flag&&(t=t.colour_description,f.writeU8(t.colour_primaries),f.writeU8(t.transfer_characteristics),f.writeU8(t.matrix_coefficients))),t=e.chroma_loc,f.writeBool(t.chroma_loc_info_present_flag),
t.chroma_loc_info_present_flag&&(f.writeUEG(t.chroma_sample_loc_type_top_field),f.writeUEG(t.chroma_sample_loc_type_bottom_field)),t=e.timing,f.writeBool(t.timing_info_present_flag),t.timing_info_present_flag&&(f.writeU32(t.num_units_in_tick),f.writeU32(t.time_scale),f.writeBool(t.fixed_frame_rate_flag)),t=e.nalHrdParameters,y=e.vclHrdParameters,f.writeBool(t.hrd_parameters_present_flag),t.hrd_parameters_present_flag&&c(t),f.writeBool(y.hrd_parameters_present_flag),y.hrd_parameters_present_flag&&
c(y),(y.hrd_parameters_present_flag||t.hrd_parameters_present_flag)&&f.writeBool(e.low_delay_hrd_flag),f.writeBool(e.picStructPresentFlag),e=e.bitstream_restriction,f.writeBool(e.bitstream_restriction_flag),e.bitstream_restriction_flag&&(f.writeBool(e.motion_vectors_over_pic_boundaries_flag),f.writeUEG(e.max_bytes_per_pic_denom),f.writeUEG(e.max_bits_per_mb_denom),f.writeUEG(e.log2_max_mv_length_horizontal),f.writeUEG(e.log2_max_mv_length_vertical),f.writeUEG(e.max_num_reorder_frames),f.writeUEG(e.max_dec_frame_buffering)))}}};
Rb.isVideoSupported="MediaSource"in window&&MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E, mp4a.40.2"');Rb.isAudioSupported="MediaSource"in window&&MediaSource.isTypeSupported('audio/mp4; codecs="mp4a.40.2"');svGlobal.DCVC_EXTENSION||(svGlobal.DCVC_EXTENSION={});svGlobal.DCVC_EXTENSION.GFX=function(a,b,d,g,c,e){function f(z,Z,W,M){this.pixels=z;this.width=Z;this.height=W;this.key=M}function y(){this.bottom=this.right=this.top=this.left=0;this.read=function(z){this.left=z.getLittleEndian16();
this.top=z.getLittleEndian16();this.right=z.getLittleEndian16();this.bottom=z.getLittleEndian16()};this.toString=function(){return"left: "+this.left+" top: "+this.top+" right: "+this.right+" bottom: "+this.bottom}}function w(){this.qualityVal=this.p=this.qb=0;this.read=function(z){var Z=z.getByte();this.qp=Z&63;this.p=Z>>7&1;this.qualityVal=z.getByte()}}function t(z,Z,W){this.bitstream=z;this.regionRects=Z;this.isChroma=W;this.timestamp=0}function K(z,Z,W){this.width=z;this.height=Z;this.monitors=
W}function B(){this.flags=this.bottom=this.right=this.top=this.left=0;this.read=function(z){this.left=z.getLittleEndian32();this.top=z.getLittleEndian32();this.right=z.getLittleEndian32();this.bottom=z.getLittleEndian32();this.flags=z.getLittleEndian32()};this.toString=function(){return"left: "+this.left+" top: "+this.top+" right: "+this.right+" bottom: "+this.bottom+" flags: "+this.flags}}function A(z,Z,W,M,fa){function X(){S=!1;ka._player=R?new Xd(ka,!1,M,fa):new Rb(ra.drawable,ka,!1);ka._player.onsps=
function(qa){console.log("*** SPS: "+qa.width+"x"+qa.height+" paused:"+za);R&&(ka._video.width=qa.width,ka._video.height=qa.height);ka.onsps&&ka.onsps(qa);setTimeout(function(){ra={drawable:ka._video}},555)};ka._player.onerror=function(qa){ka.onfatalerror&&ka.onfatalerror(ka,qa)};ka._player.onplayerror=function(qa){function aa(){ra={drawable:ka._video};ka.player.play(!0)}ra=null;if((!ka.onuserinteract||!ka.onuserinteract(aa,"video"))&&ka.onmessage)ka.onmessage({msg:"Please click Yes to continue.<br>"+
qa,cbYes:function(){ka.player.play(!0);this.destroy()}})};ka._player.onframedecoded=function(qa,aa){if(!za)if(aa)for(var h=aa.length,l=0;l<h;l++){var n=aa[l],r=n.right-n.left,u=n.bottom-n.top;la.drawImage(qa,n.left,n.top,r,u,n.left,n.top,r,u)}else la.drawImage(qa,0,0)}}this.id=z;this.width=Z;this.height=W;this.pixelFomrat=33;this.outputOriginY=this.outputOriginX=0;this.targetWidth=Z;this.targetHeight=W;this._player=null;var R="no-decoder"==M?!1:!!window.VideoDecoder;this._video=R?new OffscreenCanvas(Z,
W):document.createElement("video");var la=R?this._video.getContext("2d",{alpha:!1,desynchronized:!0,antialias:!1,powerPreference:"high-performance"}):null,ka=this,ca=null,S=!0,ra=null,wa=10,za=!1;R&&(svGlobal.logger.info("...MediaDecoder in use: "+M),la.imageSmoothingEnabled=!1);this.pause=function(qa,aa){za=qa;aa&&la&&la.clearRect(0,0,Z,W)};this.resumeVideo=function(){ka._player&&ka._player.play(!0)};this.setDisplayBuffer=function(qa){ca=qa};this.draw=function(qa,aa,h,l){return S?ca.draw(qa,aa,h,
l):ra};this.processAvc=function(qa){S&&X();if(R)qa.timestamp=wa,wa+=10;else if(qa.isChroma)return;ka.onvideoframe(qa)};this.reset=function(qa,aa){ka&&ka._player&&ka._player.reset()};this.close=function(){ka&&ka._player&&(ka._player.close(),ka._player=null);ka=null};this.setRGBs=function(qa,aa,h,l,n,r,u){ca.setRGBs(qa,aa,h,l,n,r,u)};this.getRGBs=function(qa,aa,h,l){return ca.getRGBs(qa,aa,h,l)};this.moveArea=function(qa,aa,h,l,n,r){ca.moveArea(qa,aa,h,l,n,r)};this.fillRect=function(qa,aa,h,l,n){ca.fillRect(qa,
aa,h,l,n)};this.postPaint=function(qa,aa,h,l){S&&ca.postPaint(qa,aa,h,l)}}function E(z,Z,W,M){var fa=new A(z,Z,W,c,e);fa.pixelFormat=M||33;fa.setDisplayBuffer(g);T.push(fa);ta.oncreatesurface&&ta.oncreatesurface(fa);svGlobal.logger.info("create surface id:"+z+" w:"+Z+" h:"+W+" pixelFmt:"+fa.pixelFormat);return fa}function x(z,Z,W){for(var M=z.getPosition(),fa=z.getLittleEndian32(),X=Array(fa),R=0;R<fa;R++){var la=new y;la.read(z);X[R]=la}la=Array(fa);for(R=0;R<fa;R++){var ka=new w;ka.read(z);la[R]=
ka}z=z.getBytes(Z-(z.getPosition()-M));return new t(z,X,W)}function O(z,Z,W,M){W=z.getLittleEndian32();var fa=W>>>30;W&=1073741823;switch(fa){case 0:var X=x(z,W,!1);var R=x(z,Z-W-4,!0);break;case 1:X=x(z,W,!1);break;case 2:Z=z.getEnd()-z.getPosition();R=x(z,Z,!0);break;default:console.error("Invalid LC: "+fa)}X&&M.processAvc(X);R&&M.processAvc(R)}var v=new function(){function z(aa,h,l,n,r){this.len=aa;this.code=h;this.valueBits=l;this.type=n;this.vbase=r}function Z(aa){var h=25E5-X,l=aa.length;if(h>=
l)fa.set(aa,X),X=h>l?X+l:0;else if(25E5>=l)fa.set(aa.subarray(0,h),X),fa.set(aa.subarray(h),0),X=l-h;else{h=(l-h)%25E5;var n=l-h,r=aa.subarray(n);aa=aa.subarray(l-25E5,n);fa.set(aa,25E5-aa.length);fa.set(r,0);X=h}}function W(aa){for(;S<aa;)ca<<=8,ra<za?ca+=wa[ra++]:console.log("--- end"),S+=8;ka-=aa;S-=aa;aa=ca>>S;ca&=(1<<S)-1;return aa}var M=[new z(1,0,8,0,0),new z(5,17,5,1,0),new z(5,18,7,1,32),new z(5,19,9,1,160),new z(5,20,10,1,672),new z(5,21,12,1,1696),new z(5,24,0,0,0),new z(5,25,0,0,1),new z(6,
44,14,1,5792),new z(6,45,15,1,22176),new z(6,52,0,0,2),new z(6,53,0,0,3),new z(6,54,0,0,255),new z(7,92,18,1,54944),new z(7,93,20,1,317088),new z(7,110,0,0,4),new z(7,111,0,0,5),new z(7,112,0,0,6),new z(7,113,0,0,7),new z(7,114,0,0,8),new z(7,115,0,0,9),new z(7,116,0,0,10),new z(7,117,0,0,11),new z(7,118,0,0,58),new z(7,119,0,0,59),new z(7,120,0,0,60),new z(7,121,0,0,61),new z(7,122,0,0,62),new z(7,123,0,0,63),new z(7,124,0,0,64),new z(7,125,0,0,128),new z(8,188,20,1,1365664),new z(8,189,21,1,2414240),
new z(8,252,0,0,12),new z(8,253,0,0,56),new z(8,254,0,0,57),new z(8,255,0,0,102),new z(9,380,22,1,4511392),new z(9,381,23,1,8705696),new z(9,382,24,1,17094304)],fa=new Uint8Array(25E5),X=0,R=new Uint8Array(65536),la=0,ka=0,ca=0,S=0,ra=0,wa=null,za=0,qa=!0;this.toPDU=function(aa){if(qa)return null;30==aa&&m.reconnect(m.widthRdp,m.heightRdp,!0);var h=new Uint8Array(2500008);h[0]=aa;h[2]=1;h[3]=10;h[4]=X;h[5]=X>>8;h[6]=X>>16;h[7]=X>>24;h.set(fa,8);return h};this.fromStream=function(aa){X=aa.getLittleEndian32();
fa.set(aa.getSubarray(25E5))};this.decompress=function(aa,h){if(h){wa=aa;qa&&(qa=!1);za=wa.length-1;ka=8*za-wa[za];for(la=ra=S=ca=0;0<ka;)for(var l=h=0,n=0;n<M.length;n++){for(aa=M[n];h<aa.len;)l=(l<<1)+W(1),h++;0>l&&console.log("xxx inPrefix");if(l==aa.code){if(0==aa.type)aa=aa.vbase+W(aa.valueBits),(0>aa||255<aa)&&console.log("xxx do c"),aa&=255,fa[X]=aa,25E5==++X&&(X=0),R[la++]=aa;else if(h=W(aa.valueBits),h=aa.vbase+h,0>h&&console.log("xxx distance"),0!=h){if(0==W(1))aa=3;else{aa=4;for(l=2;1==
W(1);)aa*=2,l++;aa+=W(l)}h=25E5-h+X;h%=25E5;l=h+aa;if(Math.abs(X-h)>=aa&&25E5>l&&25E5>X+aa)h=fa.subarray(h,l),fa.set(h,X),X+=aa,R.set(h,la),la+=aa;else for(;0<aa;)l=fa[h],25E5==++h&&(h=0),fa[X]=l,25E5==++X&&(X=0),R[la++]=l,aa--}else aa=W(15),ka-=S,ca=S=0,h=wa.subarray(ra,ra+aa),Z(h),R.set(h,la),ra+=aa,la+=aa,ka-=8*aa;break}}65536<la&&console.error("xx outputIndex:"+la);return R.subarray(0,la)}Z(aa);return aa}},ba=new function(){this.process=function(z){var Z=z.getByte();if(224==Z){var W=0!=(z.getByte()&
32);var M=z.getPosition(),fa=z.getEnd();Z=v.decompress(z.getData().subarray(M,fa),W);z.setPosition(fa)}else{225!=Z&&console.log("Invalid descriptor:"+Z);fa=z.getLittleEndian16();var X=z.getLittleEndian32();Z=new Uint8Array(X);for(var R=0,la,ka=0;ka<fa;ka++)la=z.getLittleEndian32(),W=0!=(z.getByte()&32),la--,M=z.getPosition(),W=v.decompress(z.getData().subarray(M,M+la),W),Z.set(W,R),R+=W.length,z.skipPosition(la);R!=X&&console.error("wrong size, actual:"+R+" expected:"+X)}return new RdpBuffer(Z,0,
Z.length)}},P=null,L=new rdpcodecs.RemoteFX(!1),N=0,na=[],ta=new a;ta.name="Microsoft::Windows::RDS::Graphics";var T=new function(z,Z){var W=[];this.push=function(M){M.onsps=z.onsps;M.onfatalerror=z.onfatalerror;M.onplayerror=z.onplayerror;M.onuserinteract=z.onuserinteract;M.onmessage=z.onmessage;W[M.id]=M};this.get=function(M){return W[M]};this.getAll=function(){return W};this.delete=function(M){var fa=W[M];fa&&(fa.onsps=null,fa.onfatalerror=null,fa.onplayerror=null,W[M]=null)};this.reset=function(M){M=
0;for(var fa=W.length;M<fa;M++)W[M]&&W[M].reset()};this.close=function(){for(var M=0,fa=W.length;M<fa;M++)W[M]&&W[M].close()};this.resumeVideo=function(){for(var M=0,fa=W.length;M<fa;M++)W[M]&&W[M].resumeVideo()};Z.pause=function(M,fa){for(var X=0,R=W.length;X<R;X++)W[X]&&W[X].pause(M,fa)}}(ta,g);ta.drawable=new function(){this.draw=function(z,Z,W,M,fa){return(fa=T.get(fa))?fa.draw(z,Z,W,M):null};this.getSurfaces=function(){return T};this.onfocus=function(z){};this.resumePlay=null};ta.resumeVideo=
function(){T.resumeVideo()};ta.process=function(z){for(var Z=ba.process(z);Z.has(8);){var W=Z.getLittleEndian16();Z.getLittleEndian16();var M=Z.getLittleEndian32(),fa=Z.getPosition()+M-8;switch(W){case 1:var X=Z,R=X.getLittleEndian16(),la=X.getLittleEndian16(),ka=X.getByte(),ca=X.getLittleEndian16(),S=X.getLittleEndian16(),ra=X.getLittleEndian16(),wa=X.getLittleEndian16(),za=ra-ca,qa=wa-S,aa=X.getLittleEndian32(),h=X.getPosition()+aa,l=T.get(R);l||(ta.onconfirm&&ta.onconfirm(),l=E(R,g.width,g.height,
ka));switch(la){case 0:var n=rdpcodecs.bitmap.byte2int(X.getData(),aa,X.getPosition());l.setRGBs(ca,S,za,qa,n,0,za);break;case 3:for(var r=L.decode(X,aa),u=r.getRects(),C=r.getTiles(),H=r.getTileSize(),G=r.getRectSize(),D=0;D<H;D++){var k=C[D];if(G)for(var q=k.x+64,F=k.y+64,Q=0;Q<G;Q++){var V=u[Q],da=V.x+V.width,pa=V.y+V.height;q<=da?F<=pa?l.setRGBs(k.x+ca,k.y+S,64,64,k.data,0,64):l.setRGBs(k.x+ca,k.y+S,64,pa-k.y,k.data,0,64):F<=pa?l.setRGBs(k.x+ca,k.y+S,da-k.x,64,k.data,0,64):l.setRGBs(k.x+ca,k.y+
S,da-k.x,pa-k.y,k.data,0,64)}else l.setRGBs(k.x,k.y,64,64,k.data,0,4)}break;case 8:P||(P=new ClearDecoder);P.decode(X,za,qa,l.getData(),ca,S,l.width);break;case 10:svGlobal.logger.info("...PLANAR");break;case 11:var ua=l,Ia=x(X,aa,!1);ua.processAvc(Ia);break;case 12:svGlobal.logger.info("...ALPHA");break;case 14:O(X,aa,!1,l);break;case 15:O(X,aa,!0,l);break;default:svGlobal.logger.warn("Invalid codec:"+la)}X.setPosition(h);l.postPaint(ca,S,za,qa);break;case 2:svGlobal.logger.info("RDPGFX_WIRE_TO_SURFACE_PDU_2");
break;case 3:svGlobal.logger.info("RDPGFX_CMDID_DELETEENCODINGCONTEXT");break;case 4:var Ba=Z;svGlobal.logger.info("...soliFill");for(var Ha=Ba.getLittleEndian16(),Wa=-16777216|Ba.getByte()<<16|Ba.getByte()<<8|Ba.getByte()|Ba.getByte()<<24,Ja=Ba.getLittleEndian16(),Ua=T.get(Ha),Ca=0;Ca<Ja;Ca++){var Da=Ba.getLittleEndian16(),bb=Ba.getLittleEndian16(),pb=Ba.getLittleEndian16()-Da,ab=Ba.getLittleEndian16()-bb;Ua.fillRect(Da,bb,pb,ab,Wa);Ua.postPaint(Da,bb,pb,ab)}break;case 5:var Xa=Z;svGlobal.logger.info("...surfaceToSurface");
for(var fd=Xa.getLittleEndian16(),gd=Xa.getLittleEndian16(),Tb=Xa.getLittleEndian16(),Ub=Xa.getLittleEndian16(),Vb=Xa.getLittleEndian16()-Tb,zc=Xa.getLittleEndian16()-Ub,be=Xa.getLittleEndian16(),hd=T.get(fd),ce=T.get(gd),id=fd==gd?null:hd.getRGBs(Tb,Ub,Vb,zc),jd=0;jd<be;jd++){var kd=Xa.getLittleEndian16(),ld=Xa.getLittleEndian16();id?ce.setRGBs(kd,ld,Vb,zc,id,0,Vb):hd.moveArea(Tb,Ub,Vb,zc,kd-Tb,ld-Ub)}break;case 6:var rb=Z;svGlobal.logger.info("...surfaceToCache");var de=rb.getLittleEndian16(),Ac=
rb.getLittleEndian32().toString(16),md=rb.getLittleEndian32();0<md&&(Ac=md.toString(16)+Ac);var ee=rb.getLittleEndian16(),nd=rb.getLittleEndian16(),od=rb.getLittleEndian16(),pd=rb.getLittleEndian16()-nd,qd=rb.getLittleEndian16()-od,fe=T.get(de).getRGBs(nd,od,pd,qd);na[ee]=new f(fe,pd,qd,Ac);break;case 7:var Fb=Z;svGlobal.logger.info("...cacheToSurface");for(var ge=Fb.getLittleEndian16(),he=Fb.getLittleEndian16(),ie=Fb.getLittleEndian16(),Wb=na[ge],je=T.get(he),rd=0;rd<ie;rd++){var ke=Fb.getLittleEndian16(),
le=Fb.getLittleEndian16();je.setRGBs(ke,le,Wb.width,Wb.height,Wb.pixels,0,Wb.width)}break;case 8:var me=Z.getLittleEndian16();na[me]=null;break;case 9:var Xb=Z,ne=Xb.getLittleEndian16(),oe=Xb.getLittleEndian16(),pe=Xb.getLittleEndian16(),qe=Xb.getByte();E(ne,oe,pe,qe);break;case 10:var sd=Z.getLittleEndian16();T.delete(sd);svGlobal.logger.info("delete surface id:"+sd);break;case 11:var td=Z;td.getLittleEndian32();td.getLittleEndian32();break;case 12:var re=Z.getLittleEndian32();if(0==N){var ud=new Uint8Array(20),
vb=new RdpBuffer(ud);vb.setLittleEndian16(13);vb.setLittleEndian16(0);vb.setLittleEndian32(20);vb.setLittleEndian32(4294967295);vb.setLittleEndian32(re);N++;vb.setLittleEndian32(N);vb.markEnd();d&&ta.send(ud)}break;case 14:var Yb=Z,vd=Yb.getLittleEndian32(),wd=Yb.getLittleEndian32(),Bc=Yb.getLittleEndian32();svGlobal.logger.info("reset graphic, w:"+vd+" h:"+wd+" monitors:"+Bc);for(var xd=Array(Bc),Zb=0;Zb<Bc;Zb++){var Cc=new B;Cc.read(Yb);xd[Zb]=Cc;svGlobal.logger.info("MonitorDef "+Zb+": "+Cc.toString())}var yd=
new K(vd,wd,xd);T.reset(yd);ta.onresetgraphic&&ta.onresetgraphic(yd);break;case 15:var $b=Z,zd=$b.getLittleEndian16();$b.skipPosition(2);var Gb=T.get(zd);Gb.outputOriginX=$b.getLittleEndian32();Gb.outputOriginY=$b.getLittleEndian32();ta.onmapsurface&&ta.onmapsurface(Gb);svGlobal.logger.info("mapSurfaceToScaledOutput, outputSurfaceId:"+zd+" outX:"+Gb.outputOriginX+" outY:"+Gb.outputOriginY);break;case 17:svGlobal.logger.info("TODO: DPGFX_CACHE_IMPORT_REPLY_PDU");break;case 19:var Dc=Z,Ad=Dc.getLittleEndian32(),
se=Dc.getLittleEndian32(),Hb=Dc.getLittleEndian32(),ac=!1;switch(Ad){case 524292:ac=!1;0==(Hb&1)&&(P=new ClearDecoder);break;case 524549:(ac=0!=(Hb&16))||0!=(Hb&1)||(P=new ClearDecoder);break;default:ac=0==(Hb&32)}svGlobal.logger.info("Gfx Cap, Ver:"+Ad.toString(16)+" len:"+se+" flags:"+Hb+" h264:"+ac);ta.onconfirm&&ta.onconfirm();break;case 21:svGlobal.logger.info("mapSurfaceToWin");break;case 22:break;case 23:var Ab=Z,Bd=Ab.getLittleEndian16();Ab.skipPosition(2);var lb=T.get(Bd);lb.outputOriginX=
Ab.getLittleEndian32();lb.outputOriginY=Ab.getLittleEndian32();lb.targetWidth=Ab.getLittleEndian32();lb.targetHeight=Ab.getLittleEndian32();svGlobal.logger.info("mapSurfaceToScaledOutput, outputSurfaceId:"+Bd+" outX:"+lb.outputOriginX+" outY:"+lb.outputOriginY+" targetW:"+lb.targetWidth+" targetH:"+lb.targetHeight);ta.onmapsurface&&ta.onmapsurface(lb);break;case 24:svGlobal.logger.info("TODO: mapSurfaceToScaledWin");break;default:svGlobal.logger.warn("xxx gfx:"+W);return}Z.setPosition(fa)}};ta.onopen=
function(){svGlobal.logger.info("GFX Open, remotefx:"+b);var z=b?2:8,Z=10+12*z,W=new Uint8Array(Z),M=new RdpBuffer(W);M.setLittleEndian16(18);M.setLittleEndian16(0);M.setLittleEndian32(Z);M.setLittleEndian16(z);M.setLittleEndian32(524292);M.setLittleEndian32(4);M.setLittleEndian32(b?1:0);M.setLittleEndian32(524549);M.setLittleEndian32(4);M.setLittleEndian32(b?19:0);b||(M.setLittleEndian32(655362),M.setLittleEndian32(4),M.setLittleEndian32(0),M.setLittleEndian32(655872),M.setLittleEndian32(4),M.setLittleEndian32(0),
M.setLittleEndian32(656129),M.setLittleEndian32(4),M.setLittleEndian32(0),M.setLittleEndian32(656384),M.setLittleEndian32(4),M.setLittleEndian32(0),M.setLittleEndian32(656642),M.setLittleEndian32(4),M.setLittleEndian32(0),M.setLittleEndian32(656896),M.setLittleEndian32(4),M.setLittleEndian32(0));M.markEnd();d&&ta.send(W)};ta.onclose=function(){T.close()};g.onGetGfxHistory=function(z,Z,W){var M=v.toPDU(z);M&&Z(M);W(z);svGlobal.logger.info("Got GFX Histroy")};g.onSetGfxHistory=function(z,Z){svGlobal.logger.info("Set GFX Histroy");
10==z?v.fromStream(Z):svGlobal.logger.error("Invalid GFX histroy type: "+z)};return ta}}
Rdp.languageToKeyboard={af:0,sq:0,ar:1025,"ar-SA":1025,"ar-IQ":0,"ar-EG":0,"ar-LY":0,"ar-DZ":0,"ar-MA":0,"ar-TN":0,"ar-OM":0,"ar-YE":0,"ar-SY":0,"ar-JO":0,"ar-LB":0,"ar-KW":0,"ar-AE":0,"ar-BH":0,"ar-QA":0,eu:0,bg:0,be:0,ca:0,zh:2052,"zh-TW":1028,"zh-CN":2052,"zh-HK":1028,"zh-SG":2052,hr:0,cs:0,da:0,nl:1043,"nl-BE":2067,en:1033,"en-US":1033,"en-GB":2057,"en-AU":0,"en-CA":4105,"en-NA":0,"en-IE":0,"en-ZA":0,"en-JM":0,"en-BZ":0,et:0,fo:0,fa:0,fi:0,fr:1036,"fr-BE":2060,"fr-CA":3084,"fr-CH":4108,"fr-LU":0,
gd:0,"gd-IE":0,de:1031,"de-CH":2055,"de-AT":0,"de-LU":0,"de-LI":0,el:0,he:1037,hi:0,hu:0,is:1039,id:0,it:1040,"it-CH":66576,ja:3758162961,ko:3758162962,lv:0,lt:0,mk:0,mt:0,nb:1044,nn:1083,no:1044,pl:1045,pt:2070,"pt-BR":1046,rm:0,ro:0,"ro-MO":0,ru:1049,"ru-MO":0,sr:0,sk:0,sl:0,sb:0,es:1034,"es-AR":0,"es-GT":0,"es-CR":0,"es-PA":0,"es-DO":0,"es-MX":2058,"es-VE":0,"es-CO":0,"es-PE":0,"es-EC":0,"es-CL":0,"es-UY":0,"es-PY":0,"es-BO":0,"es-SV":0,"es-HN":0,"es-NI":0,"es-PR":0,sx:0,sv:1053,"sv-FI":0,th:0,
ts:0,tn:0,tr:1055,uk:0,ur:0,ve:0,vi:0,xh:0,ji:0,zu:0,detect:function(){var p=navigator&&(navigator.language||navigator.userLanguage||""),I=Rdp.languageToKeyboard[p];if(!I){var Y=p.indexOf("-");Y&&(I=Rdp.languageToKeyboard[p.substring(0,Y)])}I||(svGlobal.logger.info("No valid layout for "+p),I=1033);return I}};svGlobal.Rdp||(svGlobal.Rdp=Rdp);var RdpBuffer=hi5.DataBuffer;
